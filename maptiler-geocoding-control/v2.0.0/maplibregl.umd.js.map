{"version":3,"file":"maplibregl.umd.js","sources":["../node_modules/svelte/src/runtime/internal/utils.js","../node_modules/svelte/src/runtime/internal/dom.js","../node_modules/svelte/src/runtime/internal/lifecycle.js","../node_modules/svelte/src/runtime/internal/scheduler.js","../node_modules/svelte/src/runtime/internal/transitions.js","../node_modules/svelte/src/runtime/internal/each.js","../node_modules/svelte/src/runtime/internal/Component.js","../node_modules/svelte/src/shared/version.js","../node_modules/svelte/src/runtime/internal/disclose-version/index.js","../src/ClearIcon.svelte","../src/FailIcon.svelte","../src/FeatureItem.svelte","../src/LoadingIcon.svelte","../src/MarkerIcon.svelte","../src/ReverseGeocodingIcon.svelte","../src/SearchIcon.svelte","../src/geoUtils.ts","../src/proximity.ts","../node_modules/geo-coordinates-parser/dist/mjs/regex.js","../node_modules/geo-coordinates-parser/dist/mjs/toCoordinateFormat.js","../node_modules/geo-coordinates-parser/dist/mjs/converter.js","../node_modules/geo-coordinates-parser/dist/mjs/tests/testformats.js","../node_modules/geo-coordinates-parser/dist/mjs/merge.js","../src/GeocodingControl.svelte","../node_modules/@turf/helpers/dist/esm/index.js","../node_modules/splaytree/dist/splay.esm.js","../node_modules/robust-predicates/esm/util.js","../node_modules/robust-predicates/esm/orient2d.js","../node_modules/polygon-clipping/dist/polygon-clipping.esm.js","../node_modules/@turf/meta/dist/esm/index.js","../node_modules/@turf/union/dist/esm/index.js","../node_modules/@turf/bbox/dist/esm/index.js","../node_modules/@turf/difference/dist/esm/index.js","../node_modules/@turf/flatten/dist/esm/index.js","../src/mask.ts","../src/maplibregl-controller.ts","../src/MapLibreBasedGeocodingControl.ts","../src/maplibregl.ts"],"sourcesContent":["/** @returns {void} */\nexport function noop() {}\n\nexport const identity = (x) => x;\n\n/**\n * @template T\n * @template S\n * @param {T} tar\n * @param {S} src\n * @returns {T & S}\n */\nexport function assign(tar, src) {\n\t// @ts-ignore\n\tfor (const k in src) tar[k] = src[k];\n\treturn /** @type {T & S} */ (tar);\n}\n\n// Adapted from https://github.com/then/is-promise/blob/master/index.js\n// Distributed under MIT License https://github.com/then/is-promise/blob/master/LICENSE\n/**\n * @param {any} value\n * @returns {value is PromiseLike<any>}\n */\nexport function is_promise(value) {\n\treturn (\n\t\t!!value &&\n\t\t(typeof value === 'object' || typeof value === 'function') &&\n\t\ttypeof (/** @type {any} */ (value).then) === 'function'\n\t);\n}\n\n/** @returns {void} */\nexport function add_location(element, file, line, column, char) {\n\telement.__svelte_meta = {\n\t\tloc: { file, line, column, char }\n\t};\n}\n\nexport function run(fn) {\n\treturn fn();\n}\n\nexport function blank_object() {\n\treturn Object.create(null);\n}\n\n/**\n * @param {Function[]} fns\n * @returns {void}\n */\nexport function run_all(fns) {\n\tfns.forEach(run);\n}\n\n/**\n * @param {any} thing\n * @returns {thing is Function}\n */\nexport function is_function(thing) {\n\treturn typeof thing === 'function';\n}\n\n/** @returns {boolean} */\nexport function safe_not_equal(a, b) {\n\treturn a != a ? b == b : a !== b || (a && typeof a === 'object') || typeof a === 'function';\n}\n\nlet src_url_equal_anchor;\n\n/**\n * @param {string} element_src\n * @param {string} url\n * @returns {boolean}\n */\nexport function src_url_equal(element_src, url) {\n\tif (element_src === url) return true;\n\tif (!src_url_equal_anchor) {\n\t\tsrc_url_equal_anchor = document.createElement('a');\n\t}\n\t// This is actually faster than doing URL(..).href\n\tsrc_url_equal_anchor.href = url;\n\treturn element_src === src_url_equal_anchor.href;\n}\n\n/** @param {string} srcset */\nfunction split_srcset(srcset) {\n\treturn srcset.split(',').map((src) => src.trim().split(' ').filter(Boolean));\n}\n\n/**\n * @param {HTMLSourceElement | HTMLImageElement} element_srcset\n * @param {string | undefined | null} srcset\n * @returns {boolean}\n */\nexport function srcset_url_equal(element_srcset, srcset) {\n\tconst element_urls = split_srcset(element_srcset.srcset);\n\tconst urls = split_srcset(srcset || '');\n\n\treturn (\n\t\turls.length === element_urls.length &&\n\t\turls.every(\n\t\t\t([url, width], i) =>\n\t\t\t\twidth === element_urls[i][1] &&\n\t\t\t\t// We need to test both ways because Vite will create an a full URL with\n\t\t\t\t// `new URL(asset, import.meta.url).href` for the client when `base: './'`, and the\n\t\t\t\t// relative URLs inside srcset are not automatically resolved to absolute URLs by\n\t\t\t\t// browsers (in contrast to img.src). This means both SSR and DOM code could\n\t\t\t\t// contain relative or absolute URLs.\n\t\t\t\t(src_url_equal(element_urls[i][0], url) || src_url_equal(url, element_urls[i][0]))\n\t\t)\n\t);\n}\n\n/** @returns {boolean} */\nexport function not_equal(a, b) {\n\treturn a != a ? b == b : a !== b;\n}\n\n/** @returns {boolean} */\nexport function is_empty(obj) {\n\treturn Object.keys(obj).length === 0;\n}\n\n/** @returns {void} */\nexport function validate_store(store, name) {\n\tif (store != null && typeof store.subscribe !== 'function') {\n\t\tthrow new Error(`'${name}' is not a store with a 'subscribe' method`);\n\t}\n}\n\nexport function subscribe(store, ...callbacks) {\n\tif (store == null) {\n\t\tfor (const callback of callbacks) {\n\t\t\tcallback(undefined);\n\t\t}\n\t\treturn noop;\n\t}\n\tconst unsub = store.subscribe(...callbacks);\n\treturn unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\n\n/**\n * Get the current value from a store by subscribing and immediately unsubscribing.\n *\n * https://svelte.dev/docs/svelte-store#get\n * @template T\n * @param {import('../store/public.js').Readable<T>} store\n * @returns {T}\n */\nexport function get_store_value(store) {\n\tlet value;\n\tsubscribe(store, (_) => (value = _))();\n\treturn value;\n}\n\n/** @returns {void} */\nexport function component_subscribe(component, store, callback) {\n\tcomponent.$$.on_destroy.push(subscribe(store, callback));\n}\n\nexport function create_slot(definition, ctx, $$scope, fn) {\n\tif (definition) {\n\t\tconst slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n\t\treturn definition[0](slot_ctx);\n\t}\n}\n\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n\treturn definition[1] && fn ? assign($$scope.ctx.slice(), definition[1](fn(ctx))) : $$scope.ctx;\n}\n\nexport function get_slot_changes(definition, $$scope, dirty, fn) {\n\tif (definition[2] && fn) {\n\t\tconst lets = definition[2](fn(dirty));\n\t\tif ($$scope.dirty === undefined) {\n\t\t\treturn lets;\n\t\t}\n\t\tif (typeof lets === 'object') {\n\t\t\tconst merged = [];\n\t\t\tconst len = Math.max($$scope.dirty.length, lets.length);\n\t\t\tfor (let i = 0; i < len; i += 1) {\n\t\t\t\tmerged[i] = $$scope.dirty[i] | lets[i];\n\t\t\t}\n\t\t\treturn merged;\n\t\t}\n\t\treturn $$scope.dirty | lets;\n\t}\n\treturn $$scope.dirty;\n}\n\n/** @returns {void} */\nexport function update_slot_base(\n\tslot,\n\tslot_definition,\n\tctx,\n\t$$scope,\n\tslot_changes,\n\tget_slot_context_fn\n) {\n\tif (slot_changes) {\n\t\tconst slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n\t\tslot.p(slot_context, slot_changes);\n\t}\n}\n\n/** @returns {void} */\nexport function update_slot(\n\tslot,\n\tslot_definition,\n\tctx,\n\t$$scope,\n\tdirty,\n\tget_slot_changes_fn,\n\tget_slot_context_fn\n) {\n\tconst slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n\tupdate_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\n\n/** @returns {any[] | -1} */\nexport function get_all_dirty_from_scope($$scope) {\n\tif ($$scope.ctx.length > 32) {\n\t\tconst dirty = [];\n\t\tconst length = $$scope.ctx.length / 32;\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tdirty[i] = -1;\n\t\t}\n\t\treturn dirty;\n\t}\n\treturn -1;\n}\n\n/** @returns {{}} */\nexport function exclude_internal_props(props) {\n\tconst result = {};\n\tfor (const k in props) if (k[0] !== '$') result[k] = props[k];\n\treturn result;\n}\n\n/** @returns {{}} */\nexport function compute_rest_props(props, keys) {\n\tconst rest = {};\n\tkeys = new Set(keys);\n\tfor (const k in props) if (!keys.has(k) && k[0] !== '$') rest[k] = props[k];\n\treturn rest;\n}\n\n/** @returns {{}} */\nexport function compute_slots(slots) {\n\tconst result = {};\n\tfor (const key in slots) {\n\t\tresult[key] = true;\n\t}\n\treturn result;\n}\n\n/** @returns {(this: any, ...args: any[]) => void} */\nexport function once(fn) {\n\tlet ran = false;\n\treturn function (...args) {\n\t\tif (ran) return;\n\t\tran = true;\n\t\tfn.call(this, ...args);\n\t};\n}\n\nexport function null_to_empty(value) {\n\treturn value == null ? '' : value;\n}\n\nexport function set_store_value(store, ret, value) {\n\tstore.set(value);\n\treturn ret;\n}\n\nexport const has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\n\nexport function action_destroyer(action_result) {\n\treturn action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\n/** @param {number | string} value\n * @returns {[number, string]}\n */\nexport function split_css_unit(value) {\n\tconst split = typeof value === 'string' && value.match(/^\\s*(-?[\\d.]+)([^\\s]*)\\s*$/);\n\treturn split ? [parseFloat(split[1]), split[2] || 'px'] : [/** @type {number} */ (value), 'px'];\n}\n\nexport const contenteditable_truthy_values = ['', true, 1, 'true', 'contenteditable'];\n","import { contenteditable_truthy_values, has_prop } from './utils.js';\n\nimport { ResizeObserverSingleton } from './ResizeObserverSingleton.js';\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\n\n/**\n * @returns {void}\n */\nexport function start_hydrating() {\n\tis_hydrating = true;\n}\n\n/**\n * @returns {void}\n */\nexport function end_hydrating() {\n\tis_hydrating = false;\n}\n\n/**\n * @param {number} low\n * @param {number} high\n * @param {(index: number) => number} key\n * @param {number} value\n * @returns {number}\n */\nfunction upper_bound(low, high, key, value) {\n\t// Return first index of value larger than input value in the range [low, high)\n\twhile (low < high) {\n\t\tconst mid = low + ((high - low) >> 1);\n\t\tif (key(mid) <= value) {\n\t\t\tlow = mid + 1;\n\t\t} else {\n\t\t\thigh = mid;\n\t\t}\n\t}\n\treturn low;\n}\n\n/**\n * @param {NodeEx} target\n * @returns {void}\n */\nfunction init_hydrate(target) {\n\tif (target.hydrate_init) return;\n\ttarget.hydrate_init = true;\n\t// We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n\n\tlet children = /** @type {ArrayLike<NodeEx2>} */ (target.childNodes);\n\t// If target is <head>, there may be children without claim_order\n\tif (target.nodeName === 'HEAD') {\n\t\tconst my_children = [];\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tconst node = children[i];\n\t\t\tif (node.claim_order !== undefined) {\n\t\t\t\tmy_children.push(node);\n\t\t\t}\n\t\t}\n\t\tchildren = my_children;\n\t}\n\t/*\n\t * Reorder claimed children optimally.\n\t * We can reorder claimed children optimally by finding the longest subsequence of\n\t * nodes that are already claimed in order and only moving the rest. The longest\n\t * subsequence of nodes that are claimed in order can be found by\n\t * computing the longest increasing subsequence of .claim_order values.\n\t *\n\t * This algorithm is optimal in generating the least amount of reorder operations\n\t * possible.\n\t *\n\t * Proof:\n\t * We know that, given a set of reordering operations, the nodes that do not move\n\t * always form an increasing subsequence, since they do not move among each other\n\t * meaning that they must be already ordered among each other. Thus, the maximal\n\t * set of nodes that do not move form a longest increasing subsequence.\n\t */\n\t// Compute longest increasing subsequence\n\t// m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n\tconst m = new Int32Array(children.length + 1);\n\t// Predecessor indices + 1\n\tconst p = new Int32Array(children.length);\n\tm[0] = -1;\n\tlet longest = 0;\n\tfor (let i = 0; i < children.length; i++) {\n\t\tconst current = children[i].claim_order;\n\t\t// Find the largest subsequence length such that it ends in a value less than our current value\n\t\t// upper_bound returns first greater value, so we subtract one\n\t\t// with fast path for when we are on the current longest subsequence\n\t\tconst seq_len =\n\t\t\t(longest > 0 && children[m[longest]].claim_order <= current\n\t\t\t\t? longest + 1\n\t\t\t\t: upper_bound(1, longest, (idx) => children[m[idx]].claim_order, current)) - 1;\n\t\tp[i] = m[seq_len] + 1;\n\t\tconst new_len = seq_len + 1;\n\t\t// We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n\t\tm[new_len] = i;\n\t\tlongest = Math.max(new_len, longest);\n\t}\n\t// The longest increasing subsequence of nodes (initially reversed)\n\n\t/**\n\t * @type {NodeEx2[]}\n\t */\n\tconst lis = [];\n\t// The rest of the nodes, nodes that will be moved\n\n\t/**\n\t * @type {NodeEx2[]}\n\t */\n\tconst to_move = [];\n\tlet last = children.length - 1;\n\tfor (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n\t\tlis.push(children[cur - 1]);\n\t\tfor (; last >= cur; last--) {\n\t\t\tto_move.push(children[last]);\n\t\t}\n\t\tlast--;\n\t}\n\tfor (; last >= 0; last--) {\n\t\tto_move.push(children[last]);\n\t}\n\tlis.reverse();\n\t// We sort the nodes being moved to guarantee that their insertion order matches the claim order\n\tto_move.sort((a, b) => a.claim_order - b.claim_order);\n\t// Finally, we move the nodes\n\tfor (let i = 0, j = 0; i < to_move.length; i++) {\n\t\twhile (j < lis.length && to_move[i].claim_order >= lis[j].claim_order) {\n\t\t\tj++;\n\t\t}\n\t\tconst anchor = j < lis.length ? lis[j] : null;\n\t\ttarget.insertBefore(to_move[i], anchor);\n\t}\n}\n\n/**\n * @param {Node} target\n * @param {Node} node\n * @returns {void}\n */\nexport function append(target, node) {\n\ttarget.appendChild(node);\n}\n\n/**\n * @param {Node} target\n * @param {string} style_sheet_id\n * @param {string} styles\n * @returns {void}\n */\nexport function append_styles(target, style_sheet_id, styles) {\n\tconst append_styles_to = get_root_for_style(target);\n\tif (!append_styles_to.getElementById(style_sheet_id)) {\n\t\tconst style = element('style');\n\t\tstyle.id = style_sheet_id;\n\t\tstyle.textContent = styles;\n\t\tappend_stylesheet(append_styles_to, style);\n\t}\n}\n\n/**\n * @param {Node} node\n * @returns {ShadowRoot | Document}\n */\nexport function get_root_for_style(node) {\n\tif (!node) return document;\n\tconst root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n\tif (root && /** @type {ShadowRoot} */ (root).host) {\n\t\treturn /** @type {ShadowRoot} */ (root);\n\t}\n\treturn node.ownerDocument;\n}\n\n/**\n * @param {Node} node\n * @returns {CSSStyleSheet}\n */\nexport function append_empty_stylesheet(node) {\n\tconst style_element = element('style');\n\t// For transitions to work without 'style-src: unsafe-inline' Content Security Policy,\n\t// these empty tags need to be allowed with a hash as a workaround until we move to the Web Animations API.\n\t// Using the hash for the empty string (for an empty tag) works in all browsers except Safari.\n\t// So as a workaround for the workaround, when we append empty style tags we set their content to /* empty */.\n\t// The hash 'sha256-9OlNO0DNEeaVzHL4RZwCLsBHA8WBQ8toBp/4F5XV2nc=' will then work even in Safari.\n\tstyle_element.textContent = '/* empty */';\n\tappend_stylesheet(get_root_for_style(node), style_element);\n\treturn style_element.sheet;\n}\n\n/**\n * @param {ShadowRoot | Document} node\n * @param {HTMLStyleElement} style\n * @returns {CSSStyleSheet}\n */\nfunction append_stylesheet(node, style) {\n\tappend(/** @type {Document} */ (node).head || node, style);\n\treturn style.sheet;\n}\n\n/**\n * @param {NodeEx} target\n * @param {NodeEx} node\n * @returns {void}\n */\nexport function append_hydration(target, node) {\n\tif (is_hydrating) {\n\t\tinit_hydrate(target);\n\t\tif (\n\t\t\ttarget.actual_end_child === undefined ||\n\t\t\t(target.actual_end_child !== null && target.actual_end_child.parentNode !== target)\n\t\t) {\n\t\t\ttarget.actual_end_child = target.firstChild;\n\t\t}\n\t\t// Skip nodes of undefined ordering\n\t\twhile (target.actual_end_child !== null && target.actual_end_child.claim_order === undefined) {\n\t\t\ttarget.actual_end_child = target.actual_end_child.nextSibling;\n\t\t}\n\t\tif (node !== target.actual_end_child) {\n\t\t\t// We only insert if the ordering of this node should be modified or the parent node is not target\n\t\t\tif (node.claim_order !== undefined || node.parentNode !== target) {\n\t\t\t\ttarget.insertBefore(node, target.actual_end_child);\n\t\t\t}\n\t\t} else {\n\t\t\ttarget.actual_end_child = node.nextSibling;\n\t\t}\n\t} else if (node.parentNode !== target || node.nextSibling !== null) {\n\t\ttarget.appendChild(node);\n\t}\n}\n\n/**\n * @param {Node} target\n * @param {Node} node\n * @param {Node} [anchor]\n * @returns {void}\n */\nexport function insert(target, node, anchor) {\n\ttarget.insertBefore(node, anchor || null);\n}\n\n/**\n * @param {NodeEx} target\n * @param {NodeEx} node\n * @param {NodeEx} [anchor]\n * @returns {void}\n */\nexport function insert_hydration(target, node, anchor) {\n\tif (is_hydrating && !anchor) {\n\t\tappend_hydration(target, node);\n\t} else if (node.parentNode !== target || node.nextSibling != anchor) {\n\t\ttarget.insertBefore(node, anchor || null);\n\t}\n}\n\n/**\n * @param {Node} node\n * @returns {void}\n */\nexport function detach(node) {\n\tif (node.parentNode) {\n\t\tnode.parentNode.removeChild(node);\n\t}\n}\n\n/**\n * @returns {void} */\nexport function destroy_each(iterations, detaching) {\n\tfor (let i = 0; i < iterations.length; i += 1) {\n\t\tif (iterations[i]) iterations[i].d(detaching);\n\t}\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K} name\n * @returns {HTMLElementTagNameMap[K]}\n */\nexport function element(name) {\n\treturn document.createElement(name);\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K} name\n * @param {string} is\n * @returns {HTMLElementTagNameMap[K]}\n */\nexport function element_is(name, is) {\n\treturn document.createElement(name, { is });\n}\n\n/**\n * @template T\n * @template {keyof T} K\n * @param {T} obj\n * @param {K[]} exclude\n * @returns {Pick<T, Exclude<keyof T, K>>}\n */\nexport function object_without_properties(obj, exclude) {\n\tconst target = /** @type {Pick<T, Exclude<keyof T, K>>} */ ({});\n\tfor (const k in obj) {\n\t\tif (\n\t\t\thas_prop(obj, k) &&\n\t\t\t// @ts-ignore\n\t\t\texclude.indexOf(k) === -1\n\t\t) {\n\t\t\t// @ts-ignore\n\t\t\ttarget[k] = obj[k];\n\t\t}\n\t}\n\treturn target;\n}\n\n/**\n * @template {keyof SVGElementTagNameMap} K\n * @param {K} name\n * @returns {SVGElement}\n */\nexport function svg_element(name) {\n\treturn document.createElementNS('http://www.w3.org/2000/svg', name);\n}\n\n/**\n * @param {string} data\n * @returns {Text}\n */\nexport function text(data) {\n\treturn document.createTextNode(data);\n}\n\n/**\n * @returns {Text} */\nexport function space() {\n\treturn text(' ');\n}\n\n/**\n * @returns {Text} */\nexport function empty() {\n\treturn text('');\n}\n\n/**\n * @param {string} content\n * @returns {Comment}\n */\nexport function comment(content) {\n\treturn document.createComment(content);\n}\n\n/**\n * @param {EventTarget} node\n * @param {string} event\n * @param {EventListenerOrEventListenerObject} handler\n * @param {boolean | AddEventListenerOptions | EventListenerOptions} [options]\n * @returns {() => void}\n */\nexport function listen(node, event, handler, options) {\n\tnode.addEventListener(event, handler, options);\n\treturn () => node.removeEventListener(event, handler, options);\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function prevent_default(fn) {\n\treturn function (event) {\n\t\tevent.preventDefault();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function stop_propagation(fn) {\n\treturn function (event) {\n\t\tevent.stopPropagation();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function stop_immediate_propagation(fn) {\n\treturn function (event) {\n\t\tevent.stopImmediatePropagation();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => void} */\nexport function self(fn) {\n\treturn function (event) {\n\t\t// @ts-ignore\n\t\tif (event.target === this) fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => void} */\nexport function trusted(fn) {\n\treturn function (event) {\n\t\t// @ts-ignore\n\t\tif (event.isTrusted) fn.call(this, event);\n\t};\n}\n\n/**\n * @param {Element} node\n * @param {string} attribute\n * @param {string} [value]\n * @returns {void}\n */\nexport function attr(node, attribute, value) {\n\tif (value == null) node.removeAttribute(attribute);\n\telse if (node.getAttribute(attribute) !== value) node.setAttribute(attribute, value);\n}\n/**\n * List of attributes that should always be set through the attr method,\n * because updating them through the property setter doesn't work reliably.\n * In the example of `width`/`height`, the problem is that the setter only\n * accepts numeric values, but the attribute can also be set to a string like `50%`.\n * If this list becomes too big, rethink this approach.\n */\nconst always_set_through_set_attribute = ['width', 'height'];\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {{ [x: string]: string }} attributes\n * @returns {void}\n */\nexport function set_attributes(node, attributes) {\n\t// @ts-ignore\n\tconst descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n\tfor (const key in attributes) {\n\t\tif (attributes[key] == null) {\n\t\t\tnode.removeAttribute(key);\n\t\t} else if (key === 'style') {\n\t\t\tnode.style.cssText = attributes[key];\n\t\t} else if (key === '__value') {\n\t\t\t/** @type {any} */ (node).value = node[key] = attributes[key];\n\t\t} else if (\n\t\t\tdescriptors[key] &&\n\t\t\tdescriptors[key].set &&\n\t\t\talways_set_through_set_attribute.indexOf(key) === -1\n\t\t) {\n\t\t\tnode[key] = attributes[key];\n\t\t} else {\n\t\t\tattr(node, key, attributes[key]);\n\t\t}\n\t}\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {{ [x: string]: string }} attributes\n * @returns {void}\n */\nexport function set_svg_attributes(node, attributes) {\n\tfor (const key in attributes) {\n\t\tattr(node, key, attributes[key]);\n\t}\n}\n\n/**\n * @param {Record<string, unknown>} data_map\n * @returns {void}\n */\nexport function set_custom_element_data_map(node, data_map) {\n\tObject.keys(data_map).forEach((key) => {\n\t\tset_custom_element_data(node, key, data_map[key]);\n\t});\n}\n\n/**\n * @returns {void} */\nexport function set_custom_element_data(node, prop, value) {\n\tconst lower = prop.toLowerCase(); // for backwards compatibility with existing behavior we do lowercase first\n\tif (lower in node) {\n\t\tnode[lower] = typeof node[lower] === 'boolean' && value === '' ? true : value;\n\t} else if (prop in node) {\n\t\tnode[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n\t} else {\n\t\tattr(node, prop, value);\n\t}\n}\n\n/**\n * @param {string} tag\n */\nexport function set_dynamic_element_data(tag) {\n\treturn /-/.test(tag) ? set_custom_element_data_map : set_attributes;\n}\n\n/**\n * @returns {void}\n */\nexport function xlink_attr(node, attribute, value) {\n\tnode.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\n\n/**\n * @param {HTMLElement} node\n * @returns {string}\n */\nexport function get_svelte_dataset(node) {\n\treturn node.dataset.svelteH;\n}\n\n/**\n * @returns {unknown[]} */\nexport function get_binding_group_value(group, __value, checked) {\n\tconst value = new Set();\n\tfor (let i = 0; i < group.length; i += 1) {\n\t\tif (group[i].checked) value.add(group[i].__value);\n\t}\n\tif (!checked) {\n\t\tvalue.delete(__value);\n\t}\n\treturn Array.from(value);\n}\n\n/**\n * @param {HTMLInputElement[]} group\n * @returns {{ p(...inputs: HTMLInputElement[]): void; r(): void; }}\n */\nexport function init_binding_group(group) {\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _inputs;\n\treturn {\n\t\t/* push */ p(...inputs) {\n\t\t\t_inputs = inputs;\n\t\t\t_inputs.forEach((input) => group.push(input));\n\t\t},\n\t\t/* remove */ r() {\n\t\t\t_inputs.forEach((input) => group.splice(group.indexOf(input), 1));\n\t\t}\n\t};\n}\n\n/**\n * @param {number[]} indexes\n * @returns {{ u(new_indexes: number[]): void; p(...inputs: HTMLInputElement[]): void; r: () => void; }}\n */\nexport function init_binding_group_dynamic(group, indexes) {\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _group = get_binding_group(group);\n\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _inputs;\n\n\tfunction get_binding_group(group) {\n\t\tfor (let i = 0; i < indexes.length; i++) {\n\t\t\tgroup = group[indexes[i]] = group[indexes[i]] || [];\n\t\t}\n\t\treturn group;\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction push() {\n\t\t_inputs.forEach((input) => _group.push(input));\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction remove() {\n\t\t_inputs.forEach((input) => _group.splice(_group.indexOf(input), 1));\n\t}\n\treturn {\n\t\t/* update */ u(new_indexes) {\n\t\t\tindexes = new_indexes;\n\t\t\tconst new_group = get_binding_group(group);\n\t\t\tif (new_group !== _group) {\n\t\t\t\tremove();\n\t\t\t\t_group = new_group;\n\t\t\t\tpush();\n\t\t\t}\n\t\t},\n\t\t/* push */ p(...inputs) {\n\t\t\t_inputs = inputs;\n\t\t\tpush();\n\t\t},\n\t\t/* remove */ r: remove\n\t};\n}\n\n/** @returns {number} */\nexport function to_number(value) {\n\treturn value === '' ? null : +value;\n}\n\n/** @returns {any[]} */\nexport function time_ranges_to_array(ranges) {\n\tconst array = [];\n\tfor (let i = 0; i < ranges.length; i += 1) {\n\t\tarray.push({ start: ranges.start(i), end: ranges.end(i) });\n\t}\n\treturn array;\n}\n\n/**\n * @param {Element} element\n * @returns {ChildNode[]}\n */\nexport function children(element) {\n\treturn Array.from(element.childNodes);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {void}\n */\nfunction init_claim_info(nodes) {\n\tif (nodes.claim_info === undefined) {\n\t\tnodes.claim_info = { last_index: 0, total_claimed: 0 };\n\t}\n}\n\n/**\n * @template {ChildNodeEx} R\n * @param {ChildNodeArray} nodes\n * @param {(node: ChildNodeEx) => node is R} predicate\n * @param {(node: ChildNodeEx) => ChildNodeEx | undefined} process_node\n * @param {() => R} create_node\n * @param {boolean} dont_update_last_index\n * @returns {R}\n */\nfunction claim_node(nodes, predicate, process_node, create_node, dont_update_last_index = false) {\n\t// Try to find nodes in an order such that we lengthen the longest increasing subsequence\n\tinit_claim_info(nodes);\n\tconst result_node = (() => {\n\t\t// We first try to find an element after the previous one\n\t\tfor (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (predicate(node)) {\n\t\t\t\tconst replacement = process_node(node);\n\t\t\t\tif (replacement === undefined) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\tnodes[i] = replacement;\n\t\t\t\t}\n\t\t\t\tif (!dont_update_last_index) {\n\t\t\t\t\tnodes.claim_info.last_index = i;\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\t// Otherwise, we try to find one before\n\t\t// We iterate in reverse so that we don't go too far back\n\t\tfor (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (predicate(node)) {\n\t\t\t\tconst replacement = process_node(node);\n\t\t\t\tif (replacement === undefined) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\tnodes[i] = replacement;\n\t\t\t\t}\n\t\t\t\tif (!dont_update_last_index) {\n\t\t\t\t\tnodes.claim_info.last_index = i;\n\t\t\t\t} else if (replacement === undefined) {\n\t\t\t\t\t// Since we spliced before the last_index, we decrease it\n\t\t\t\t\tnodes.claim_info.last_index--;\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\t// If we can't find any matching node, we create a new one\n\t\treturn create_node();\n\t})();\n\tresult_node.claim_order = nodes.claim_info.total_claimed;\n\tnodes.claim_info.total_claimed += 1;\n\treturn result_node;\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @param {(name: string) => Element | SVGElement} create_element\n * @returns {Element | SVGElement}\n */\nfunction claim_element_base(nodes, name, attributes, create_element) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Element | SVGElement} */\n\t\t(node) => node.nodeName === name,\n\t\t/** @param {Element} node */\n\t\t(node) => {\n\t\t\tconst remove = [];\n\t\t\tfor (let j = 0; j < node.attributes.length; j++) {\n\t\t\t\tconst attribute = node.attributes[j];\n\t\t\t\tif (!attributes[attribute.name]) {\n\t\t\t\t\tremove.push(attribute.name);\n\t\t\t\t}\n\t\t\t}\n\t\t\tremove.forEach((v) => node.removeAttribute(v));\n\t\t\treturn undefined;\n\t\t},\n\t\t() => create_element(name)\n\t);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @returns {Element | SVGElement}\n */\nexport function claim_element(nodes, name, attributes) {\n\treturn claim_element_base(nodes, name, attributes, element);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @returns {Element | SVGElement}\n */\nexport function claim_svg_element(nodes, name, attributes) {\n\treturn claim_element_base(nodes, name, attributes, svg_element);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {Text}\n */\nexport function claim_text(nodes, data) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Text} */\n\t\t(node) => node.nodeType === 3,\n\t\t/** @param {Text} node */\n\t\t(node) => {\n\t\t\tconst data_str = '' + data;\n\t\t\tif (node.data.startsWith(data_str)) {\n\t\t\t\tif (node.data.length !== data_str.length) {\n\t\t\t\t\treturn node.splitText(data_str.length);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnode.data = data_str;\n\t\t\t}\n\t\t},\n\t\t() => text(data),\n\t\ttrue // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n\t);\n}\n\n/**\n * @returns {Text} */\nexport function claim_space(nodes) {\n\treturn claim_text(nodes, ' ');\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {Comment}\n */\nexport function claim_comment(nodes, data) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Comment} */\n\t\t(node) => node.nodeType === 8,\n\t\t/** @param {Comment} node */\n\t\t(node) => {\n\t\t\tnode.data = '' + data;\n\t\t\treturn undefined;\n\t\t},\n\t\t() => comment(data),\n\t\ttrue\n\t);\n}\n\nfunction get_comment_idx(nodes, text, start) {\n\tfor (let i = start; i < nodes.length; i += 1) {\n\t\tconst node = nodes[i];\n\t\tif (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\n/**\n * @param {boolean} is_svg\n * @returns {HtmlTagHydration}\n */\nexport function claim_html_tag(nodes, is_svg) {\n\t// find html opening tag\n\tconst start_index = get_comment_idx(nodes, 'HTML_TAG_START', 0);\n\tconst end_index = get_comment_idx(nodes, 'HTML_TAG_END', start_index + 1);\n\tif (start_index === -1 || end_index === -1) {\n\t\treturn new HtmlTagHydration(is_svg);\n\t}\n\n\tinit_claim_info(nodes);\n\tconst html_tag_nodes = nodes.splice(start_index, end_index - start_index + 1);\n\tdetach(html_tag_nodes[0]);\n\tdetach(html_tag_nodes[html_tag_nodes.length - 1]);\n\tconst claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n\tif (claimed_nodes.length === 0) {\n\t\treturn new HtmlTagHydration(is_svg);\n\t}\n\tfor (const n of claimed_nodes) {\n\t\tn.claim_order = nodes.claim_info.total_claimed;\n\t\tnodes.claim_info.total_claimed += 1;\n\t}\n\treturn new HtmlTagHydration(is_svg, claimed_nodes);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @returns {void}\n */\nexport function set_data(text, data) {\n\tdata = '' + data;\n\tif (text.data === data) return;\n\ttext.data = /** @type {string} */ (data);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @returns {void}\n */\nexport function set_data_contenteditable(text, data) {\n\tdata = '' + data;\n\tif (text.wholeText === data) return;\n\ttext.data = /** @type {string} */ (data);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @param {string} attr_value\n * @returns {void}\n */\nexport function set_data_maybe_contenteditable(text, data, attr_value) {\n\tif (~contenteditable_truthy_values.indexOf(attr_value)) {\n\t\tset_data_contenteditable(text, data);\n\t} else {\n\t\tset_data(text, data);\n\t}\n}\n\n/**\n * @returns {void} */\nexport function set_input_value(input, value) {\n\tinput.value = value == null ? '' : value;\n}\n\n/**\n * @returns {void} */\nexport function set_input_type(input, type) {\n\ttry {\n\t\tinput.type = type;\n\t} catch (e) {\n\t\t// do nothing\n\t}\n}\n\n/**\n * @returns {void} */\nexport function set_style(node, key, value, important) {\n\tif (value == null) {\n\t\tnode.style.removeProperty(key);\n\t} else {\n\t\tnode.style.setProperty(key, value, important ? 'important' : '');\n\t}\n}\n\n/**\n * @returns {void} */\nexport function select_option(select, value, mounting) {\n\tfor (let i = 0; i < select.options.length; i += 1) {\n\t\tconst option = select.options[i];\n\t\tif (option.__value === value) {\n\t\t\toption.selected = true;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!mounting || value !== undefined) {\n\t\tselect.selectedIndex = -1; // no option should be selected\n\t}\n}\n\n/**\n * @returns {void} */\nexport function select_options(select, value) {\n\tfor (let i = 0; i < select.options.length; i += 1) {\n\t\tconst option = select.options[i];\n\t\toption.selected = ~value.indexOf(option.__value);\n\t}\n}\n\nexport function select_value(select) {\n\tconst selected_option = select.querySelector(':checked');\n\treturn selected_option && selected_option.__value;\n}\n\nexport function select_multiple_value(select) {\n\treturn [].map.call(select.querySelectorAll(':checked'), (option) => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\n\n/**\n * @type {boolean} */\nlet crossorigin;\n\n/**\n * @returns {boolean} */\nexport function is_crossorigin() {\n\tif (crossorigin === undefined) {\n\t\tcrossorigin = false;\n\t\ttry {\n\t\t\tif (typeof window !== 'undefined' && window.parent) {\n\t\t\t\tvoid window.parent.document;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tcrossorigin = true;\n\t\t}\n\t}\n\treturn crossorigin;\n}\n\n/**\n * @param {HTMLElement} node\n * @param {() => void} fn\n * @returns {() => void}\n */\nexport function add_iframe_resize_listener(node, fn) {\n\tconst computed_style = getComputedStyle(node);\n\tif (computed_style.position === 'static') {\n\t\tnode.style.position = 'relative';\n\t}\n\tconst iframe = element('iframe');\n\tiframe.setAttribute(\n\t\t'style',\n\t\t'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n\t\t\t'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;'\n\t);\n\tiframe.setAttribute('aria-hidden', 'true');\n\tiframe.tabIndex = -1;\n\tconst crossorigin = is_crossorigin();\n\n\t/**\n\t * @type {() => void}\n\t */\n\tlet unsubscribe;\n\tif (crossorigin) {\n\t\tiframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n\t\tunsubscribe = listen(\n\t\t\twindow,\n\t\t\t'message',\n\t\t\t/** @param {MessageEvent} event */ (event) => {\n\t\t\t\tif (event.source === iframe.contentWindow) fn();\n\t\t\t}\n\t\t);\n\t} else {\n\t\tiframe.src = 'about:blank';\n\t\tiframe.onload = () => {\n\t\t\tunsubscribe = listen(iframe.contentWindow, 'resize', fn);\n\t\t\t// make sure an initial resize event is fired _after_ the iframe is loaded (which is asynchronous)\n\t\t\t// see https://github.com/sveltejs/svelte/issues/4233\n\t\t\tfn();\n\t\t};\n\t}\n\tappend(node, iframe);\n\treturn () => {\n\t\tif (crossorigin) {\n\t\t\tunsubscribe();\n\t\t} else if (unsubscribe && iframe.contentWindow) {\n\t\t\tunsubscribe();\n\t\t}\n\t\tdetach(iframe);\n\t};\n}\nexport const resize_observer_content_box = /* @__PURE__ */ new ResizeObserverSingleton({\n\tbox: 'content-box'\n});\nexport const resize_observer_border_box = /* @__PURE__ */ new ResizeObserverSingleton({\n\tbox: 'border-box'\n});\nexport const resize_observer_device_pixel_content_box = /* @__PURE__ */ new ResizeObserverSingleton(\n\t{ box: 'device-pixel-content-box' }\n);\nexport { ResizeObserverSingleton };\n\n/**\n * @returns {void} */\nexport function toggle_class(element, name, toggle) {\n\t// The `!!` is required because an `undefined` flag means flipping the current state.\n\telement.classList.toggle(name, !!toggle);\n}\n\n/**\n * @template T\n * @param {string} type\n * @param {T} [detail]\n * @param {{ bubbles?: boolean, cancelable?: boolean }} [options]\n * @returns {CustomEvent<T>}\n */\nexport function custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n\treturn new CustomEvent(type, { detail, bubbles, cancelable });\n}\n\n/**\n * @param {string} selector\n * @param {HTMLElement} parent\n * @returns {ChildNodeArray}\n */\nexport function query_selector_all(selector, parent = document.body) {\n\treturn Array.from(parent.querySelectorAll(selector));\n}\n\n/**\n * @param {string} nodeId\n * @param {HTMLElement} head\n * @returns {any[]}\n */\nexport function head_selector(nodeId, head) {\n\tconst result = [];\n\tlet started = 0;\n\tfor (const node of head.childNodes) {\n\t\tif (node.nodeType === 8 /* comment node */) {\n\t\t\tconst comment = node.textContent.trim();\n\t\t\tif (comment === `HEAD_${nodeId}_END`) {\n\t\t\t\tstarted -= 1;\n\t\t\t\tresult.push(node);\n\t\t\t} else if (comment === `HEAD_${nodeId}_START`) {\n\t\t\t\tstarted += 1;\n\t\t\t\tresult.push(node);\n\t\t\t}\n\t\t} else if (started > 0) {\n\t\t\tresult.push(node);\n\t\t}\n\t}\n\treturn result;\n}\n/** */\nexport class HtmlTag {\n\t/**\n\t * @private\n\t * @default false\n\t */\n\tis_svg = false;\n\t/** parent for creating node */\n\te = undefined;\n\t/** html tag nodes */\n\tn = undefined;\n\t/** target */\n\tt = undefined;\n\t/** anchor */\n\ta = undefined;\n\tconstructor(is_svg = false) {\n\t\tthis.is_svg = is_svg;\n\t\tthis.e = this.n = null;\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tc(html) {\n\t\tthis.h(html);\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @param {HTMLElement | SVGElement} target\n\t * @param {HTMLElement | SVGElement} anchor\n\t * @returns {void}\n\t */\n\tm(html, target, anchor = null) {\n\t\tif (!this.e) {\n\t\t\tif (this.is_svg)\n\t\t\t\tthis.e = svg_element(/** @type {keyof SVGElementTagNameMap} */ (target.nodeName));\n\t\t\t/** #7364  target for <template> may be provided as #document-fragment(11) */ else\n\t\t\t\tthis.e = element(\n\t\t\t\t\t/** @type {keyof HTMLElementTagNameMap} */ (\n\t\t\t\t\t\ttarget.nodeType === 11 ? 'TEMPLATE' : target.nodeName\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\tthis.t =\n\t\t\t\ttarget.tagName !== 'TEMPLATE'\n\t\t\t\t\t? target\n\t\t\t\t\t: /** @type {HTMLTemplateElement} */ (target).content;\n\t\t\tthis.c(html);\n\t\t}\n\t\tthis.i(anchor);\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\th(html) {\n\t\tthis.e.innerHTML = html;\n\t\tthis.n = Array.from(\n\t\t\tthis.e.nodeName === 'TEMPLATE' ? this.e.content.childNodes : this.e.childNodes\n\t\t);\n\t}\n\n\t/**\n\t * @returns {void} */\n\ti(anchor) {\n\t\tfor (let i = 0; i < this.n.length; i += 1) {\n\t\t\tinsert(this.t, this.n[i], anchor);\n\t\t}\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tp(html) {\n\t\tthis.d();\n\t\tthis.h(html);\n\t\tthis.i(this.a);\n\t}\n\n\t/**\n\t * @returns {void} */\n\td() {\n\t\tthis.n.forEach(detach);\n\t}\n}\n\nexport class HtmlTagHydration extends HtmlTag {\n\t/** @type {Element[]} hydration claimed nodes */\n\tl = undefined;\n\n\tconstructor(is_svg = false, claimed_nodes) {\n\t\tsuper(is_svg);\n\t\tthis.e = this.n = null;\n\t\tthis.l = claimed_nodes;\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tc(html) {\n\t\tif (this.l) {\n\t\t\tthis.n = this.l;\n\t\t} else {\n\t\t\tsuper.c(html);\n\t\t}\n\t}\n\n\t/**\n\t * @returns {void} */\n\ti(anchor) {\n\t\tfor (let i = 0; i < this.n.length; i += 1) {\n\t\t\tinsert_hydration(this.t, this.n[i], anchor);\n\t\t}\n\t}\n}\n\n/**\n * @param {NamedNodeMap} attributes\n * @returns {{}}\n */\nexport function attribute_to_object(attributes) {\n\tconst result = {};\n\tfor (const attribute of attributes) {\n\t\tresult[attribute.name] = attribute.value;\n\t}\n\treturn result;\n}\n\nconst escaped = {\n\t'\"': '&quot;',\n\t'&': '&amp;',\n\t'<': '&lt;'\n};\n\nconst regex_attribute_characters_to_escape = /[\"&<]/g;\n\n/**\n * Note that the attribute itself should be surrounded in double quotes\n * @param {any} attribute\n */\nfunction escape_attribute(attribute) {\n\treturn String(attribute).replace(regex_attribute_characters_to_escape, (match) => escaped[match]);\n}\n\n/**\n * @param {Record<string, string>} attributes\n */\nexport function stringify_spread(attributes) {\n\tlet str = ' ';\n\tfor (const key in attributes) {\n\t\tif (attributes[key] != null) {\n\t\t\tstr += `${key}=\"${escape_attribute(attributes[key])}\" `;\n\t\t}\n\t}\n\n\treturn str;\n}\n\n/**\n * @param {HTMLElement} element\n * @returns {{}}\n */\nexport function get_custom_elements_slots(element) {\n\tconst result = {};\n\telement.childNodes.forEach(\n\t\t/** @param {Element} node */ (node) => {\n\t\t\tresult[node.slot || 'default'] = true;\n\t\t}\n\t);\n\treturn result;\n}\n\nexport function construct_svelte_component(component, props) {\n\treturn new component(props);\n}\n\n/**\n * @typedef {Node & {\n * \tclaim_order?: number;\n * \thydrate_init?: true;\n * \tactual_end_child?: NodeEx;\n * \tchildNodes: NodeListOf<NodeEx>;\n * }} NodeEx\n */\n\n/** @typedef {ChildNode & NodeEx} ChildNodeEx */\n\n/** @typedef {NodeEx & { claim_order: number }} NodeEx2 */\n\n/**\n * @typedef {ChildNodeEx[] & {\n * \tclaim_info?: {\n * \t\tlast_index: number;\n * \t\ttotal_claimed: number;\n * \t};\n * }} ChildNodeArray\n */\n","import { custom_event } from './dom.js';\n\nexport let current_component;\n\n/** @returns {void} */\nexport function set_current_component(component) {\n\tcurrent_component = component;\n}\n\nexport function get_current_component() {\n\tif (!current_component) throw new Error('Function called outside component initialization');\n\treturn current_component;\n}\n\n/**\n * Schedules a callback to run immediately before the component is updated after any state change.\n *\n * The first time the callback runs will be before the initial `onMount`\n *\n * https://svelte.dev/docs/svelte#beforeupdate\n * @param {() => any} fn\n * @returns {void}\n */\nexport function beforeUpdate(fn) {\n\tget_current_component().$$.before_update.push(fn);\n}\n\n/**\n * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.\n * It must be called during the component's initialisation (but doesn't need to live *inside* the component;\n * it can be called from an external module).\n *\n * If a function is returned _synchronously_ from `onMount`, it will be called when the component is unmounted.\n *\n * `onMount` does not run inside a [server-side component](https://svelte.dev/docs#run-time-server-side-component-api).\n *\n * https://svelte.dev/docs/svelte#onmount\n * @template T\n * @param {() => import('./private.js').NotFunction<T> | Promise<import('./private.js').NotFunction<T>> | (() => any)} fn\n * @returns {void}\n */\nexport function onMount(fn) {\n\tget_current_component().$$.on_mount.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately after the component has been updated.\n *\n * The first time the callback runs will be after the initial `onMount`\n *\n * https://svelte.dev/docs/svelte#afterupdate\n * @param {() => any} fn\n * @returns {void}\n */\nexport function afterUpdate(fn) {\n\tget_current_component().$$.after_update.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately before the component is unmounted.\n *\n * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the\n * only one that runs inside a server-side component.\n *\n * https://svelte.dev/docs/svelte#ondestroy\n * @param {() => any} fn\n * @returns {void}\n */\nexport function onDestroy(fn) {\n\tget_current_component().$$.on_destroy.push(fn);\n}\n\n/**\n * Creates an event dispatcher that can be used to dispatch [component events](https://svelte.dev/docs#template-syntax-component-directives-on-eventname).\n * Event dispatchers are functions that can take two arguments: `name` and `detail`.\n *\n * Component events created with `createEventDispatcher` create a\n * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).\n * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).\n * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)\n * property and can contain any type of data.\n *\n * The event dispatcher can be typed to narrow the allowed event names and the type of the `detail` argument:\n * ```ts\n * const dispatch = createEventDispatcher<{\n *  loaded: never; // does not take a detail argument\n *  change: string; // takes a detail argument of type string, which is required\n *  optional: number | null; // takes an optional detail argument of type number\n * }>();\n * ```\n *\n * https://svelte.dev/docs/svelte#createeventdispatcher\n * @template {Record<string, any>} [EventMap=any]\n * @returns {import('./public.js').EventDispatcher<EventMap>}\n */\nexport function createEventDispatcher() {\n\tconst component = get_current_component();\n\treturn (type, detail, { cancelable = false } = {}) => {\n\t\tconst callbacks = component.$$.callbacks[type];\n\t\tif (callbacks) {\n\t\t\t// TODO are there situations where events could be dispatched\n\t\t\t// in a server (non-DOM) environment?\n\t\t\tconst event = custom_event(/** @type {string} */ (type), detail, { cancelable });\n\t\t\tcallbacks.slice().forEach((fn) => {\n\t\t\t\tfn.call(component, event);\n\t\t\t});\n\t\t\treturn !event.defaultPrevented;\n\t\t}\n\t\treturn true;\n\t};\n}\n\n/**\n * Associates an arbitrary `context` object with the current component and the specified `key`\n * and returns that object. The context is then available to children of the component\n * (including slotted content) with `getContext`.\n *\n * Like lifecycle functions, this must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#setcontext\n * @template T\n * @param {any} key\n * @param {T} context\n * @returns {T}\n */\nexport function setContext(key, context) {\n\tget_current_component().$$.context.set(key, context);\n\treturn context;\n}\n\n/**\n * Retrieves the context that belongs to the closest parent component with the specified `key`.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#getcontext\n * @template T\n * @param {any} key\n * @returns {T}\n */\nexport function getContext(key) {\n\treturn get_current_component().$$.context.get(key);\n}\n\n/**\n * Retrieves the whole context map that belongs to the closest parent component.\n * Must be called during component initialisation. Useful, for example, if you\n * programmatically create a component and want to pass the existing context to it.\n *\n * https://svelte.dev/docs/svelte#getallcontexts\n * @template {Map<any, any>} [T=Map<any, any>]\n * @returns {T}\n */\nexport function getAllContexts() {\n\treturn get_current_component().$$.context;\n}\n\n/**\n * Checks whether a given `key` has been set in the context of a parent component.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#hascontext\n * @param {any} key\n * @returns {boolean}\n */\nexport function hasContext(key) {\n\treturn get_current_component().$$.context.has(key);\n}\n\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\n/**\n * @param component\n * @param event\n * @returns {void}\n */\nexport function bubble(component, event) {\n\tconst callbacks = component.$$.callbacks[event.type];\n\tif (callbacks) {\n\t\t// @ts-ignore\n\t\tcallbacks.slice().forEach((fn) => fn.call(this, event));\n\t}\n}\n","import { run_all } from './utils.js';\nimport { current_component, set_current_component } from './lifecycle.js';\n\nexport const dirty_components = [];\nexport const intros = { enabled: false };\nexport const binding_callbacks = [];\n\nlet render_callbacks = [];\n\nconst flush_callbacks = [];\n\nconst resolved_promise = /* @__PURE__ */ Promise.resolve();\n\nlet update_scheduled = false;\n\n/** @returns {void} */\nexport function schedule_update() {\n\tif (!update_scheduled) {\n\t\tupdate_scheduled = true;\n\t\tresolved_promise.then(flush);\n\t}\n}\n\n/** @returns {Promise<void>} */\nexport function tick() {\n\tschedule_update();\n\treturn resolved_promise;\n}\n\n/** @returns {void} */\nexport function add_render_callback(fn) {\n\trender_callbacks.push(fn);\n}\n\n/** @returns {void} */\nexport function add_flush_callback(fn) {\n\tflush_callbacks.push(fn);\n}\n\n// flush() calls callbacks in this order:\n// 1. All beforeUpdate callbacks, in order: parents before children\n// 2. All bind:this callbacks, in reverse order: children before parents.\n// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT\n//    for afterUpdates called during the initial onMount, which are called in\n//    reverse order: children before parents.\n// Since callbacks might update component values, which could trigger another\n// call to flush(), the following steps guard against this:\n// 1. During beforeUpdate, any updated components will be added to the\n//    dirty_components array and will cause a reentrant call to flush(). Because\n//    the flush index is kept outside the function, the reentrant call will pick\n//    up where the earlier call left off and go through all dirty components. The\n//    current_component value is saved and restored so that the reentrant call will\n//    not interfere with the \"parent\" flush() call.\n// 2. bind:this callbacks cannot trigger new flush() calls.\n// 3. During afterUpdate, any updated components will NOT have their afterUpdate\n//    callback called a second time; the seen_callbacks set, outside the flush()\n//    function, guarantees this behavior.\nconst seen_callbacks = new Set();\n\nlet flushidx = 0; // Do *not* move this inside the flush() function\n\n/** @returns {void} */\nexport function flush() {\n\t// Do not reenter flush while dirty components are updated, as this can\n\t// result in an infinite loop. Instead, let the inner flush handle it.\n\t// Reentrancy is ok afterwards for bindings etc.\n\tif (flushidx !== 0) {\n\t\treturn;\n\t}\n\tconst saved_component = current_component;\n\tdo {\n\t\t// first, call beforeUpdate functions\n\t\t// and update components\n\t\ttry {\n\t\t\twhile (flushidx < dirty_components.length) {\n\t\t\t\tconst component = dirty_components[flushidx];\n\t\t\t\tflushidx++;\n\t\t\t\tset_current_component(component);\n\t\t\t\tupdate(component.$$);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// reset dirty state to not end up in a deadlocked state and then rethrow\n\t\t\tdirty_components.length = 0;\n\t\t\tflushidx = 0;\n\t\t\tthrow e;\n\t\t}\n\t\tset_current_component(null);\n\t\tdirty_components.length = 0;\n\t\tflushidx = 0;\n\t\twhile (binding_callbacks.length) binding_callbacks.pop()();\n\t\t// then, once components are updated, call\n\t\t// afterUpdate functions. This may cause\n\t\t// subsequent updates...\n\t\tfor (let i = 0; i < render_callbacks.length; i += 1) {\n\t\t\tconst callback = render_callbacks[i];\n\t\t\tif (!seen_callbacks.has(callback)) {\n\t\t\t\t// ...so guard against infinite loops\n\t\t\t\tseen_callbacks.add(callback);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t\trender_callbacks.length = 0;\n\t} while (dirty_components.length);\n\twhile (flush_callbacks.length) {\n\t\tflush_callbacks.pop()();\n\t}\n\tupdate_scheduled = false;\n\tseen_callbacks.clear();\n\tset_current_component(saved_component);\n}\n\n/** @returns {void} */\nfunction update($$) {\n\tif ($$.fragment !== null) {\n\t\t$$.update();\n\t\trun_all($$.before_update);\n\t\tconst dirty = $$.dirty;\n\t\t$$.dirty = [-1];\n\t\t$$.fragment && $$.fragment.p($$.ctx, dirty);\n\t\t$$.after_update.forEach(add_render_callback);\n\t}\n}\n\n/**\n * Useful for example to execute remaining `afterUpdate` callbacks before executing `destroy`.\n * @param {Function[]} fns\n * @returns {void}\n */\nexport function flush_render_callbacks(fns) {\n\tconst filtered = [];\n\tconst targets = [];\n\trender_callbacks.forEach((c) => (fns.indexOf(c) === -1 ? filtered.push(c) : targets.push(c)));\n\ttargets.forEach((c) => c());\n\trender_callbacks = filtered;\n}\n","import { identity as linear, is_function, noop, run_all } from './utils.js';\nimport { now } from './environment.js';\nimport { loop } from './loop.js';\nimport { create_rule, delete_rule } from './style_manager.js';\nimport { custom_event } from './dom.js';\nimport { add_render_callback } from './scheduler.js';\n\n/**\n * @type {Promise<void> | null}\n */\nlet promise;\n\n/**\n * @returns {Promise<void>}\n */\nfunction wait() {\n\tif (!promise) {\n\t\tpromise = Promise.resolve();\n\t\tpromise.then(() => {\n\t\t\tpromise = null;\n\t\t});\n\t}\n\treturn promise;\n}\n\n/**\n * @param {Element} node\n * @param {INTRO | OUTRO | boolean} direction\n * @param {'start' | 'end'} kind\n * @returns {void}\n */\nfunction dispatch(node, direction, kind) {\n\tnode.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\n\nconst outroing = new Set();\n\n/**\n * @type {Outro}\n */\nlet outros;\n\n/**\n * @returns {void} */\nexport function group_outros() {\n\toutros = {\n\t\tr: 0,\n\t\tc: [],\n\t\tp: outros // parent group\n\t};\n}\n\n/**\n * @returns {void} */\nexport function check_outros() {\n\tif (!outros.r) {\n\t\trun_all(outros.c);\n\t}\n\toutros = outros.p;\n}\n\n/**\n * @param {import('./private.js').Fragment} block\n * @param {0 | 1} [local]\n * @returns {void}\n */\nexport function transition_in(block, local) {\n\tif (block && block.i) {\n\t\toutroing.delete(block);\n\t\tblock.i(local);\n\t}\n}\n\n/**\n * @param {import('./private.js').Fragment} block\n * @param {0 | 1} local\n * @param {0 | 1} [detach]\n * @param {() => void} [callback]\n * @returns {void}\n */\nexport function transition_out(block, local, detach, callback) {\n\tif (block && block.o) {\n\t\tif (outroing.has(block)) return;\n\t\toutroing.add(block);\n\t\toutros.c.push(() => {\n\t\t\toutroing.delete(block);\n\t\t\tif (callback) {\n\t\t\t\tif (detach) block.d(1);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t});\n\t\tblock.o(local);\n\t} else if (callback) {\n\t\tcallback();\n\t}\n}\n\n/**\n * @type {import('../transition/public.js').TransitionConfig}\n */\nconst null_transition = { duration: 0 };\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @returns {{ start(): void; invalidate(): void; end(): void; }}\n */\nexport function create_in_transition(node, fn, params) {\n\t/**\n\t * @type {TransitionOptions} */\n\tconst options = { direction: 'in' };\n\tlet config = fn(node, params, options);\n\tlet running = false;\n\tlet animation_name;\n\tlet task;\n\tlet uid = 0;\n\n\t/**\n\t * @returns {void} */\n\tfunction cleanup() {\n\t\tif (animation_name) delete_rule(node, animation_name);\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction go() {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\t\tif (css) animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n\t\ttick(0, 1);\n\t\tconst start_time = now() + delay;\n\t\tconst end_time = start_time + duration;\n\t\tif (task) task.abort();\n\t\trunning = true;\n\t\tadd_render_callback(() => dispatch(node, true, 'start'));\n\t\ttask = loop((now) => {\n\t\t\tif (running) {\n\t\t\t\tif (now >= end_time) {\n\t\t\t\t\ttick(1, 0);\n\t\t\t\t\tdispatch(node, true, 'end');\n\t\t\t\t\tcleanup();\n\t\t\t\t\treturn (running = false);\n\t\t\t\t}\n\t\t\t\tif (now >= start_time) {\n\t\t\t\t\tconst t = easing((now - start_time) / duration);\n\t\t\t\t\ttick(t, 1 - t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn running;\n\t\t});\n\t}\n\tlet started = false;\n\treturn {\n\t\tstart() {\n\t\t\tif (started) return;\n\t\t\tstarted = true;\n\t\t\tdelete_rule(node);\n\t\t\tif (is_function(config)) {\n\t\t\t\tconfig = config(options);\n\t\t\t\twait().then(go);\n\t\t\t} else {\n\t\t\t\tgo();\n\t\t\t}\n\t\t},\n\t\tinvalidate() {\n\t\t\tstarted = false;\n\t\t},\n\t\tend() {\n\t\t\tif (running) {\n\t\t\t\tcleanup();\n\t\t\t\trunning = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @returns {{ end(reset: any): void; }}\n */\nexport function create_out_transition(node, fn, params) {\n\t/** @type {TransitionOptions} */\n\tconst options = { direction: 'out' };\n\tlet config = fn(node, params, options);\n\tlet running = true;\n\tlet animation_name;\n\tconst group = outros;\n\tgroup.r += 1;\n\t/** @type {boolean} */\n\tlet original_inert_value;\n\n\t/**\n\t * @returns {void} */\n\tfunction go() {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\n\t\tif (css) animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n\n\t\tconst start_time = now() + delay;\n\t\tconst end_time = start_time + duration;\n\t\tadd_render_callback(() => dispatch(node, false, 'start'));\n\n\t\tif ('inert' in node) {\n\t\t\toriginal_inert_value = /** @type {HTMLElement} */ (node).inert;\n\t\t\tnode.inert = true;\n\t\t}\n\n\t\tloop((now) => {\n\t\t\tif (running) {\n\t\t\t\tif (now >= end_time) {\n\t\t\t\t\ttick(0, 1);\n\t\t\t\t\tdispatch(node, false, 'end');\n\t\t\t\t\tif (!--group.r) {\n\t\t\t\t\t\t// this will result in `end()` being called,\n\t\t\t\t\t\t// so we don't need to clean up here\n\t\t\t\t\t\trun_all(group.c);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (now >= start_time) {\n\t\t\t\t\tconst t = easing((now - start_time) / duration);\n\t\t\t\t\ttick(1 - t, t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn running;\n\t\t});\n\t}\n\n\tif (is_function(config)) {\n\t\twait().then(() => {\n\t\t\t// @ts-ignore\n\t\t\tconfig = config(options);\n\t\t\tgo();\n\t\t});\n\t} else {\n\t\tgo();\n\t}\n\n\treturn {\n\t\tend(reset) {\n\t\t\tif (reset && 'inert' in node) {\n\t\t\t\tnode.inert = original_inert_value;\n\t\t\t}\n\t\t\tif (reset && config.tick) {\n\t\t\t\tconfig.tick(1, 0);\n\t\t\t}\n\t\t\tif (running) {\n\t\t\t\tif (animation_name) delete_rule(node, animation_name);\n\t\t\t\trunning = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @param {boolean} intro\n * @returns {{ run(b: 0 | 1): void; end(): void; }}\n */\nexport function create_bidirectional_transition(node, fn, params, intro) {\n\t/**\n\t * @type {TransitionOptions} */\n\tconst options = { direction: 'both' };\n\tlet config = fn(node, params, options);\n\tlet t = intro ? 0 : 1;\n\n\t/**\n\t * @type {Program | null} */\n\tlet running_program = null;\n\n\t/**\n\t * @type {PendingProgram | null} */\n\tlet pending_program = null;\n\tlet animation_name = null;\n\n\t/** @type {boolean} */\n\tlet original_inert_value;\n\n\t/**\n\t * @returns {void} */\n\tfunction clear_animation() {\n\t\tif (animation_name) delete_rule(node, animation_name);\n\t}\n\n\t/**\n\t * @param {PendingProgram} program\n\t * @param {number} duration\n\t * @returns {Program}\n\t */\n\tfunction init(program, duration) {\n\t\tconst d = /** @type {Program['d']} */ (program.b - t);\n\t\tduration *= Math.abs(d);\n\t\treturn {\n\t\t\ta: t,\n\t\t\tb: program.b,\n\t\t\td,\n\t\t\tduration,\n\t\t\tstart: program.start,\n\t\t\tend: program.start + duration,\n\t\t\tgroup: program.group\n\t\t};\n\t}\n\n\t/**\n\t * @param {INTRO | OUTRO} b\n\t * @returns {void}\n\t */\n\tfunction go(b) {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\n\t\t/**\n\t\t * @type {PendingProgram} */\n\t\tconst program = {\n\t\t\tstart: now() + delay,\n\t\t\tb\n\t\t};\n\n\t\tif (!b) {\n\t\t\t// @ts-ignore todo: improve typings\n\t\t\tprogram.group = outros;\n\t\t\toutros.r += 1;\n\t\t}\n\n\t\tif ('inert' in node) {\n\t\t\tif (b) {\n\t\t\t\tif (original_inert_value !== undefined) {\n\t\t\t\t\t// aborted/reversed outro  restore previous inert value\n\t\t\t\t\tnode.inert = original_inert_value;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toriginal_inert_value = /** @type {HTMLElement} */ (node).inert;\n\t\t\t\tnode.inert = true;\n\t\t\t}\n\t\t}\n\n\t\tif (running_program || pending_program) {\n\t\t\tpending_program = program;\n\t\t} else {\n\t\t\t// if this is an intro, and there's a delay, we need to do\n\t\t\t// an initial tick and/or apply CSS animation immediately\n\t\t\tif (css) {\n\t\t\t\tclear_animation();\n\t\t\t\tanimation_name = create_rule(node, t, b, duration, delay, easing, css);\n\t\t\t}\n\t\t\tif (b) tick(0, 1);\n\t\t\trunning_program = init(program, duration);\n\t\t\tadd_render_callback(() => dispatch(node, b, 'start'));\n\t\t\tloop((now) => {\n\t\t\t\tif (pending_program && now > pending_program.start) {\n\t\t\t\t\trunning_program = init(pending_program, duration);\n\t\t\t\t\tpending_program = null;\n\t\t\t\t\tdispatch(node, running_program.b, 'start');\n\t\t\t\t\tif (css) {\n\t\t\t\t\t\tclear_animation();\n\t\t\t\t\t\tanimation_name = create_rule(\n\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\tt,\n\t\t\t\t\t\t\trunning_program.b,\n\t\t\t\t\t\t\trunning_program.duration,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\teasing,\n\t\t\t\t\t\t\tconfig.css\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (running_program) {\n\t\t\t\t\tif (now >= running_program.end) {\n\t\t\t\t\t\ttick((t = running_program.b), 1 - t);\n\t\t\t\t\t\tdispatch(node, running_program.b, 'end');\n\t\t\t\t\t\tif (!pending_program) {\n\t\t\t\t\t\t\t// we're done\n\t\t\t\t\t\t\tif (running_program.b) {\n\t\t\t\t\t\t\t\t// intro  we can tidy up immediately\n\t\t\t\t\t\t\t\tclear_animation();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// outro  needs to be coordinated\n\t\t\t\t\t\t\t\tif (!--running_program.group.r) run_all(running_program.group.c);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trunning_program = null;\n\t\t\t\t\t} else if (now >= running_program.start) {\n\t\t\t\t\t\tconst p = now - running_program.start;\n\t\t\t\t\t\tt = running_program.a + running_program.d * easing(p / running_program.duration);\n\t\t\t\t\t\ttick(t, 1 - t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn !!(running_program || pending_program);\n\t\t\t});\n\t\t}\n\t}\n\treturn {\n\t\trun(b) {\n\t\t\tif (is_function(config)) {\n\t\t\t\twait().then(() => {\n\t\t\t\t\tconst opts = { direction: b ? 'in' : 'out' };\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tconfig = config(opts);\n\t\t\t\t\tgo(b);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tgo(b);\n\t\t\t}\n\t\t},\n\t\tend() {\n\t\t\tclear_animation();\n\t\t\trunning_program = pending_program = null;\n\t\t}\n\t};\n}\n\n/** @typedef {1} INTRO */\n/** @typedef {0} OUTRO */\n/** @typedef {{ direction: 'in' | 'out' | 'both' }} TransitionOptions */\n/** @typedef {(node: Element, params: any, options: TransitionOptions) => import('../transition/public.js').TransitionConfig} TransitionFn */\n\n/**\n * @typedef {Object} Outro\n * @property {number} r\n * @property {Function[]} c\n * @property {Object} p\n */\n\n/**\n * @typedef {Object} PendingProgram\n * @property {number} start\n * @property {INTRO|OUTRO} b\n * @property {Outro} [group]\n */\n\n/**\n * @typedef {Object} Program\n * @property {number} a\n * @property {INTRO|OUTRO} b\n * @property {1|-1} d\n * @property {number} duration\n * @property {number} start\n * @property {number} end\n * @property {Outro} [group]\n */\n","import { transition_in, transition_out } from './transitions.js';\nimport { run_all } from './utils.js';\n\n// general each functions:\n\nexport function ensure_array_like(array_like_or_iterator) {\n\treturn array_like_or_iterator?.length !== undefined\n\t\t? array_like_or_iterator\n\t\t: Array.from(array_like_or_iterator);\n}\n\n// keyed each functions:\n\n/** @returns {void} */\nexport function destroy_block(block, lookup) {\n\tblock.d(1);\n\tlookup.delete(block.key);\n}\n\n/** @returns {void} */\nexport function outro_and_destroy_block(block, lookup) {\n\ttransition_out(block, 1, 1, () => {\n\t\tlookup.delete(block.key);\n\t});\n}\n\n/** @returns {void} */\nexport function fix_and_destroy_block(block, lookup) {\n\tblock.f();\n\tdestroy_block(block, lookup);\n}\n\n/** @returns {void} */\nexport function fix_and_outro_and_destroy_block(block, lookup) {\n\tblock.f();\n\toutro_and_destroy_block(block, lookup);\n}\n\n/** @returns {any[]} */\nexport function update_keyed_each(\n\told_blocks,\n\tdirty,\n\tget_key,\n\tdynamic,\n\tctx,\n\tlist,\n\tlookup,\n\tnode,\n\tdestroy,\n\tcreate_each_block,\n\tnext,\n\tget_context\n) {\n\tlet o = old_blocks.length;\n\tlet n = list.length;\n\tlet i = o;\n\tconst old_indexes = {};\n\twhile (i--) old_indexes[old_blocks[i].key] = i;\n\tconst new_blocks = [];\n\tconst new_lookup = new Map();\n\tconst deltas = new Map();\n\tconst updates = [];\n\ti = n;\n\twhile (i--) {\n\t\tconst child_ctx = get_context(ctx, list, i);\n\t\tconst key = get_key(child_ctx);\n\t\tlet block = lookup.get(key);\n\t\tif (!block) {\n\t\t\tblock = create_each_block(key, child_ctx);\n\t\t\tblock.c();\n\t\t} else if (dynamic) {\n\t\t\t// defer updates until all the DOM shuffling is done\n\t\t\tupdates.push(() => block.p(child_ctx, dirty));\n\t\t}\n\t\tnew_lookup.set(key, (new_blocks[i] = block));\n\t\tif (key in old_indexes) deltas.set(key, Math.abs(i - old_indexes[key]));\n\t}\n\tconst will_move = new Set();\n\tconst did_move = new Set();\n\t/** @returns {void} */\n\tfunction insert(block) {\n\t\ttransition_in(block, 1);\n\t\tblock.m(node, next);\n\t\tlookup.set(block.key, block);\n\t\tnext = block.first;\n\t\tn--;\n\t}\n\twhile (o && n) {\n\t\tconst new_block = new_blocks[n - 1];\n\t\tconst old_block = old_blocks[o - 1];\n\t\tconst new_key = new_block.key;\n\t\tconst old_key = old_block.key;\n\t\tif (new_block === old_block) {\n\t\t\t// do nothing\n\t\t\tnext = new_block.first;\n\t\t\to--;\n\t\t\tn--;\n\t\t} else if (!new_lookup.has(old_key)) {\n\t\t\t// remove old block\n\t\t\tdestroy(old_block, lookup);\n\t\t\to--;\n\t\t} else if (!lookup.has(new_key) || will_move.has(new_key)) {\n\t\t\tinsert(new_block);\n\t\t} else if (did_move.has(old_key)) {\n\t\t\to--;\n\t\t} else if (deltas.get(new_key) > deltas.get(old_key)) {\n\t\t\tdid_move.add(new_key);\n\t\t\tinsert(new_block);\n\t\t} else {\n\t\t\twill_move.add(old_key);\n\t\t\to--;\n\t\t}\n\t}\n\twhile (o--) {\n\t\tconst old_block = old_blocks[o];\n\t\tif (!new_lookup.has(old_block.key)) destroy(old_block, lookup);\n\t}\n\twhile (n) insert(new_blocks[n - 1]);\n\trun_all(updates);\n\treturn new_blocks;\n}\n\n/** @returns {void} */\nexport function validate_each_keys(ctx, list, get_context, get_key) {\n\tconst keys = new Map();\n\tfor (let i = 0; i < list.length; i++) {\n\t\tconst key = get_key(get_context(ctx, list, i));\n\t\tif (keys.has(key)) {\n\t\t\tlet value = '';\n\t\t\ttry {\n\t\t\t\tvalue = `with value '${String(key)}' `;\n\t\t\t} catch (e) {\n\t\t\t\t// can't stringify\n\t\t\t}\n\t\t\tthrow new Error(\n\t\t\t\t`Cannot have duplicate keys in a keyed each: Keys at index ${keys.get(\n\t\t\t\t\tkey\n\t\t\t\t)} and ${i} ${value}are duplicates`\n\t\t\t);\n\t\t}\n\t\tkeys.set(key, i);\n\t}\n}\n","import {\n\tadd_render_callback,\n\tflush,\n\tflush_render_callbacks,\n\tschedule_update,\n\tdirty_components\n} from './scheduler.js';\nimport { current_component, set_current_component } from './lifecycle.js';\nimport { blank_object, is_empty, is_function, run, run_all, noop } from './utils.js';\nimport {\n\tchildren,\n\tdetach,\n\tstart_hydrating,\n\tend_hydrating,\n\tget_custom_elements_slots,\n\tinsert,\n\telement,\n\tattr\n} from './dom.js';\nimport { transition_in } from './transitions.js';\n\n/** @returns {void} */\nexport function bind(component, name, callback) {\n\tconst index = component.$$.props[name];\n\tif (index !== undefined) {\n\t\tcomponent.$$.bound[index] = callback;\n\t\tcallback(component.$$.ctx[index]);\n\t}\n}\n\n/** @returns {void} */\nexport function create_component(block) {\n\tblock && block.c();\n}\n\n/** @returns {void} */\nexport function claim_component(block, parent_nodes) {\n\tblock && block.l(parent_nodes);\n}\n\n/** @returns {void} */\nexport function mount_component(component, target, anchor) {\n\tconst { fragment, after_update } = component.$$;\n\tfragment && fragment.m(target, anchor);\n\t// onMount happens before the initial afterUpdate\n\tadd_render_callback(() => {\n\t\tconst new_on_destroy = component.$$.on_mount.map(run).filter(is_function);\n\t\t// if the component was destroyed immediately\n\t\t// it will update the `$$.on_destroy` reference to `null`.\n\t\t// the destructured on_destroy may still reference to the old array\n\t\tif (component.$$.on_destroy) {\n\t\t\tcomponent.$$.on_destroy.push(...new_on_destroy);\n\t\t} else {\n\t\t\t// Edge case - component was destroyed immediately,\n\t\t\t// most likely as a result of a binding initialising\n\t\t\trun_all(new_on_destroy);\n\t\t}\n\t\tcomponent.$$.on_mount = [];\n\t});\n\tafter_update.forEach(add_render_callback);\n}\n\n/** @returns {void} */\nexport function destroy_component(component, detaching) {\n\tconst $$ = component.$$;\n\tif ($$.fragment !== null) {\n\t\tflush_render_callbacks($$.after_update);\n\t\trun_all($$.on_destroy);\n\t\t$$.fragment && $$.fragment.d(detaching);\n\t\t// TODO null out other refs, including component.$$ (but need to\n\t\t// preserve final state?)\n\t\t$$.on_destroy = $$.fragment = null;\n\t\t$$.ctx = [];\n\t}\n}\n\n/** @returns {void} */\nfunction make_dirty(component, i) {\n\tif (component.$$.dirty[0] === -1) {\n\t\tdirty_components.push(component);\n\t\tschedule_update();\n\t\tcomponent.$$.dirty.fill(0);\n\t}\n\tcomponent.$$.dirty[(i / 31) | 0] |= 1 << i % 31;\n}\n\n// TODO: Document the other params\n/**\n * @param {SvelteComponent} component\n * @param {import('./public.js').ComponentConstructorOptions} options\n *\n * @param {import('./utils.js')['not_equal']} not_equal Used to compare props and state values.\n * @param {(target: Element | ShadowRoot) => void} [append_styles] Function that appends styles to the DOM when the component is first initialised.\n * This will be the `add_css` function from the compiled component.\n *\n * @returns {void}\n */\nexport function init(\n\tcomponent,\n\toptions,\n\tinstance,\n\tcreate_fragment,\n\tnot_equal,\n\tprops,\n\tappend_styles = null,\n\tdirty = [-1]\n) {\n\tconst parent_component = current_component;\n\tset_current_component(component);\n\t/** @type {import('./private.js').T$$} */\n\tconst $$ = (component.$$ = {\n\t\tfragment: null,\n\t\tctx: [],\n\t\t// state\n\t\tprops,\n\t\tupdate: noop,\n\t\tnot_equal,\n\t\tbound: blank_object(),\n\t\t// lifecycle\n\t\ton_mount: [],\n\t\ton_destroy: [],\n\t\ton_disconnect: [],\n\t\tbefore_update: [],\n\t\tafter_update: [],\n\t\tcontext: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n\t\t// everything else\n\t\tcallbacks: blank_object(),\n\t\tdirty,\n\t\tskip_bound: false,\n\t\troot: options.target || parent_component.$$.root\n\t});\n\tappend_styles && append_styles($$.root);\n\tlet ready = false;\n\t$$.ctx = instance\n\t\t? instance(component, options.props || {}, (i, ret, ...rest) => {\n\t\t\t\tconst value = rest.length ? rest[0] : ret;\n\t\t\t\tif ($$.ctx && not_equal($$.ctx[i], ($$.ctx[i] = value))) {\n\t\t\t\t\tif (!$$.skip_bound && $$.bound[i]) $$.bound[i](value);\n\t\t\t\t\tif (ready) make_dirty(component, i);\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t  })\n\t\t: [];\n\t$$.update();\n\tready = true;\n\trun_all($$.before_update);\n\t// `false` as a special case of no DOM component\n\t$$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n\tif (options.target) {\n\t\tif (options.hydrate) {\n\t\t\tstart_hydrating();\n\t\t\t// TODO: what is the correct type here?\n\t\t\t// @ts-expect-error\n\t\t\tconst nodes = children(options.target);\n\t\t\t$$.fragment && $$.fragment.l(nodes);\n\t\t\tnodes.forEach(detach);\n\t\t} else {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\t\t\t$$.fragment && $$.fragment.c();\n\t\t}\n\t\tif (options.intro) transition_in(component.$$.fragment);\n\t\tmount_component(component, options.target, options.anchor);\n\t\tend_hydrating();\n\t\tflush();\n\t}\n\tset_current_component(parent_component);\n}\n\nexport let SvelteElement;\n\nif (typeof HTMLElement === 'function') {\n\tSvelteElement = class extends HTMLElement {\n\t\t/** The Svelte component constructor */\n\t\t$$ctor;\n\t\t/** Slots */\n\t\t$$s;\n\t\t/** The Svelte component instance */\n\t\t$$c;\n\t\t/** Whether or not the custom element is connected */\n\t\t$$cn = false;\n\t\t/** Component props data */\n\t\t$$d = {};\n\t\t/** `true` if currently in the process of reflecting component props back to attributes */\n\t\t$$r = false;\n\t\t/** @type {Record<string, CustomElementPropDefinition>} Props definition (name, reflected, type etc) */\n\t\t$$p_d = {};\n\t\t/** @type {Record<string, Function[]>} Event listeners */\n\t\t$$l = {};\n\t\t/** @type {Map<Function, Function>} Event listener unsubscribe functions */\n\t\t$$l_u = new Map();\n\n\t\tconstructor($$componentCtor, $$slots, use_shadow_dom) {\n\t\t\tsuper();\n\t\t\tthis.$$ctor = $$componentCtor;\n\t\t\tthis.$$s = $$slots;\n\t\t\tif (use_shadow_dom) {\n\t\t\t\tthis.attachShadow({ mode: 'open' });\n\t\t\t}\n\t\t}\n\n\t\taddEventListener(type, listener, options) {\n\t\t\t// We can't determine upfront if the event is a custom event or not, so we have to\n\t\t\t// listen to both. If someone uses a custom event with the same name as a regular\n\t\t\t// browser event, this fires twice - we can't avoid that.\n\t\t\tthis.$$l[type] = this.$$l[type] || [];\n\t\t\tthis.$$l[type].push(listener);\n\t\t\tif (this.$$c) {\n\t\t\t\tconst unsub = this.$$c.$on(type, listener);\n\t\t\t\tthis.$$l_u.set(listener, unsub);\n\t\t\t}\n\t\t\tsuper.addEventListener(type, listener, options);\n\t\t}\n\n\t\tremoveEventListener(type, listener, options) {\n\t\t\tsuper.removeEventListener(type, listener, options);\n\t\t\tif (this.$$c) {\n\t\t\t\tconst unsub = this.$$l_u.get(listener);\n\t\t\t\tif (unsub) {\n\t\t\t\t\tunsub();\n\t\t\t\t\tthis.$$l_u.delete(listener);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tasync connectedCallback() {\n\t\t\tthis.$$cn = true;\n\t\t\tif (!this.$$c) {\n\t\t\t\t// We wait one tick to let possible child slot elements be created/mounted\n\t\t\t\tawait Promise.resolve();\n\t\t\t\tif (!this.$$cn || this.$$c) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfunction create_slot(name) {\n\t\t\t\t\treturn () => {\n\t\t\t\t\t\tlet node;\n\t\t\t\t\t\tconst obj = {\n\t\t\t\t\t\t\tc: function create() {\n\t\t\t\t\t\t\t\tnode = element('slot');\n\t\t\t\t\t\t\t\tif (name !== 'default') {\n\t\t\t\t\t\t\t\t\tattr(node, 'name', name);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t * @param {HTMLElement} target\n\t\t\t\t\t\t\t * @param {HTMLElement} [anchor]\n\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\tm: function mount(target, anchor) {\n\t\t\t\t\t\t\t\tinsert(target, node, anchor);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\td: function destroy(detaching) {\n\t\t\t\t\t\t\t\tif (detaching) {\n\t\t\t\t\t\t\t\t\tdetach(node);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn obj;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tconst $$slots = {};\n\t\t\t\tconst existing_slots = get_custom_elements_slots(this);\n\t\t\t\tfor (const name of this.$$s) {\n\t\t\t\t\tif (name in existing_slots) {\n\t\t\t\t\t\t$$slots[name] = [create_slot(name)];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (const attribute of this.attributes) {\n\t\t\t\t\t// this.$$data takes precedence over this.attributes\n\t\t\t\t\tconst name = this.$$g_p(attribute.name);\n\t\t\t\t\tif (!(name in this.$$d)) {\n\t\t\t\t\t\tthis.$$d[name] = get_custom_element_value(name, attribute.value, this.$$p_d, 'toProp');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Port over props that were set programmatically before ce was initialized\n\t\t\t\tfor (const key in this.$$p_d) {\n\t\t\t\t\tif (!(key in this.$$d) && this[key] !== undefined) {\n\t\t\t\t\t\tthis.$$d[key] = this[key]; // don't transform, these were set through JavaScript\n\t\t\t\t\t\tdelete this[key]; // remove the property that shadows the getter/setter\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$$c = new this.$$ctor({\n\t\t\t\t\ttarget: this.shadowRoot || this,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...this.$$d,\n\t\t\t\t\t\t$$slots,\n\t\t\t\t\t\t$$scope: {\n\t\t\t\t\t\t\tctx: []\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Reflect component props as attributes\n\t\t\t\tconst reflect_attributes = () => {\n\t\t\t\t\tthis.$$r = true;\n\t\t\t\t\tfor (const key in this.$$p_d) {\n\t\t\t\t\t\tthis.$$d[key] = this.$$c.$$.ctx[this.$$c.$$.props[key]];\n\t\t\t\t\t\tif (this.$$p_d[key].reflect) {\n\t\t\t\t\t\t\tconst attribute_value = get_custom_element_value(\n\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\tthis.$$d[key],\n\t\t\t\t\t\t\t\tthis.$$p_d,\n\t\t\t\t\t\t\t\t'toAttribute'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (attribute_value == null) {\n\t\t\t\t\t\t\t\tthis.removeAttribute(this.$$p_d[key].attribute || key);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.setAttribute(this.$$p_d[key].attribute || key, attribute_value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.$$r = false;\n\t\t\t\t};\n\t\t\t\tthis.$$c.$$.after_update.push(reflect_attributes);\n\t\t\t\treflect_attributes(); // once initially because after_update is added too late for first render\n\n\t\t\t\tfor (const type in this.$$l) {\n\t\t\t\t\tfor (const listener of this.$$l[type]) {\n\t\t\t\t\t\tconst unsub = this.$$c.$on(type, listener);\n\t\t\t\t\t\tthis.$$l_u.set(listener, unsub);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$$l = {};\n\t\t\t}\n\t\t}\n\n\t\t// We don't need this when working within Svelte code, but for compatibility of people using this outside of Svelte\n\t\t// and setting attributes through setAttribute etc, this is helpful\n\t\tattributeChangedCallback(attr, _oldValue, newValue) {\n\t\t\tif (this.$$r) return;\n\t\t\tattr = this.$$g_p(attr);\n\t\t\tthis.$$d[attr] = get_custom_element_value(attr, newValue, this.$$p_d, 'toProp');\n\t\t\tthis.$$c?.$set({ [attr]: this.$$d[attr] });\n\t\t}\n\n\t\tdisconnectedCallback() {\n\t\t\tthis.$$cn = false;\n\t\t\t// In a microtask, because this could be a move within the DOM\n\t\t\tPromise.resolve().then(() => {\n\t\t\t\tif (!this.$$cn && this.$$c) {\n\t\t\t\t\tthis.$$c.$destroy();\n\t\t\t\t\tthis.$$c = undefined;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t$$g_p(attribute_name) {\n\t\t\treturn (\n\t\t\t\tObject.keys(this.$$p_d).find(\n\t\t\t\t\t(key) =>\n\t\t\t\t\t\tthis.$$p_d[key].attribute === attribute_name ||\n\t\t\t\t\t\t(!this.$$p_d[key].attribute && key.toLowerCase() === attribute_name)\n\t\t\t\t) || attribute_name\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * @param {string} prop\n * @param {any} value\n * @param {Record<string, CustomElementPropDefinition>} props_definition\n * @param {'toAttribute' | 'toProp'} [transform]\n */\nfunction get_custom_element_value(prop, value, props_definition, transform) {\n\tconst type = props_definition[prop]?.type;\n\tvalue = type === 'Boolean' && typeof value !== 'boolean' ? value != null : value;\n\tif (!transform || !props_definition[prop]) {\n\t\treturn value;\n\t} else if (transform === 'toAttribute') {\n\t\tswitch (type) {\n\t\t\tcase 'Object':\n\t\t\tcase 'Array':\n\t\t\t\treturn value == null ? null : JSON.stringify(value);\n\t\t\tcase 'Boolean':\n\t\t\t\treturn value ? '' : null;\n\t\t\tcase 'Number':\n\t\t\t\treturn value == null ? null : value;\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t} else {\n\t\tswitch (type) {\n\t\t\tcase 'Object':\n\t\t\tcase 'Array':\n\t\t\t\treturn value && JSON.parse(value);\n\t\t\tcase 'Boolean':\n\t\t\t\treturn value; // conversion already handled above\n\t\t\tcase 'Number':\n\t\t\t\treturn value != null ? +value : value;\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t}\n}\n\n/**\n * @internal\n *\n * Turn a Svelte component into a custom element.\n * @param {import('./public.js').ComponentType} Component  A Svelte component constructor\n * @param {Record<string, CustomElementPropDefinition>} props_definition  The props to observe\n * @param {string[]} slots  The slots to create\n * @param {string[]} accessors  Other accessors besides the ones for props the component has\n * @param {boolean} use_shadow_dom  Whether to use shadow DOM\n * @param {(ce: new () => HTMLElement) => new () => HTMLElement} [extend]\n */\nexport function create_custom_element(\n\tComponent,\n\tprops_definition,\n\tslots,\n\taccessors,\n\tuse_shadow_dom,\n\textend\n) {\n\tlet Class = class extends SvelteElement {\n\t\tconstructor() {\n\t\t\tsuper(Component, slots, use_shadow_dom);\n\t\t\tthis.$$p_d = props_definition;\n\t\t}\n\t\tstatic get observedAttributes() {\n\t\t\treturn Object.keys(props_definition).map((key) =>\n\t\t\t\t(props_definition[key].attribute || key).toLowerCase()\n\t\t\t);\n\t\t}\n\t};\n\tObject.keys(props_definition).forEach((prop) => {\n\t\tObject.defineProperty(Class.prototype, prop, {\n\t\t\tget() {\n\t\t\t\treturn this.$$c && prop in this.$$c ? this.$$c[prop] : this.$$d[prop];\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tvalue = get_custom_element_value(prop, value, props_definition);\n\t\t\t\tthis.$$d[prop] = value;\n\t\t\t\tthis.$$c?.$set({ [prop]: value });\n\t\t\t}\n\t\t});\n\t});\n\taccessors.forEach((accessor) => {\n\t\tObject.defineProperty(Class.prototype, accessor, {\n\t\t\tget() {\n\t\t\t\treturn this.$$c?.[accessor];\n\t\t\t}\n\t\t});\n\t});\n\tif (extend) {\n\t\t// @ts-expect-error - assigning here is fine\n\t\tClass = extend(Class);\n\t}\n\tComponent.element = /** @type {any} */ (Class);\n\treturn Class;\n}\n\n/**\n * Base class for Svelte components. Used when dev=false.\n *\n * @template {Record<string, any>} [Props=any]\n * @template {Record<string, any>} [Events=any]\n */\nexport class SvelteComponent {\n\t/**\n\t * ### PRIVATE API\n\t *\n\t * Do not use, may change at any time\n\t *\n\t * @type {any}\n\t */\n\t$$ = undefined;\n\t/**\n\t * ### PRIVATE API\n\t *\n\t * Do not use, may change at any time\n\t *\n\t * @type {any}\n\t */\n\t$$set = undefined;\n\n\t/** @returns {void} */\n\t$destroy() {\n\t\tdestroy_component(this, 1);\n\t\tthis.$destroy = noop;\n\t}\n\n\t/**\n\t * @template {Extract<keyof Events, string>} K\n\t * @param {K} type\n\t * @param {((e: Events[K]) => void) | null | undefined} callback\n\t * @returns {() => void}\n\t */\n\t$on(type, callback) {\n\t\tif (!is_function(callback)) {\n\t\t\treturn noop;\n\t\t}\n\t\tconst callbacks = this.$$.callbacks[type] || (this.$$.callbacks[type] = []);\n\t\tcallbacks.push(callback);\n\t\treturn () => {\n\t\t\tconst index = callbacks.indexOf(callback);\n\t\t\tif (index !== -1) callbacks.splice(index, 1);\n\t\t};\n\t}\n\n\t/**\n\t * @param {Partial<Props>} props\n\t * @returns {void}\n\t */\n\t$set(props) {\n\t\tif (this.$$set && !is_empty(props)) {\n\t\t\tthis.$$.skip_bound = true;\n\t\t\tthis.$$set(props);\n\t\t\tthis.$$.skip_bound = false;\n\t\t}\n\t}\n}\n\n/**\n * @typedef {Object} CustomElementPropDefinition\n * @property {string} [attribute]\n * @property {boolean} [reflect]\n * @property {'String'|'Boolean'|'Number'|'Array'|'Object'} [type]\n */\n","// generated during release, do not modify\n\n/**\n * The current version, as set in package.json.\n *\n * https://svelte.dev/docs/svelte-compiler#svelte-version\n * @type {string}\n */\nexport const VERSION = '4.2.19';\nexport const PUBLIC_VERSION = '4';\n","import { PUBLIC_VERSION } from '../../../shared/version.js';\n\nif (typeof window !== 'undefined')\n\t// @ts-ignore\n\t(window.__svelte || (window.__svelte = { v: new Set() })).v.add(PUBLIC_VERSION);\n","<svg viewBox=\"0 0 14 14\" width=\"13\" height=\"13\">\n  <path\n    d=\"M13.12.706a.982.982 0 0 0-1.391 0L6.907 5.517 2.087.696a.982.982 0 1 0-1.391 1.39l4.821 4.821L.696 11.73a.982.982 0 1 0 1.39 1.39l4.821-4.821 4.822 4.821a.982.982 0 1 0 1.39-1.39L8.298 6.908l4.821-4.822a.988.988 0 0 0 0-1.38Z\"\n  />\n</svg>\n\n<style>\n  svg {\n    display: block;\n    fill: var(--color-icon-button);\n  }\n</style>\n","<svg viewBox=\"0 0 30 30\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n  <path\n    d=\"M15 0C6.705 0 0 6.705 0 15C0 23.295 6.705 30 15 30C23.295 30 30 23.295 30 15C30 6.705 23.295 0 15 0ZM22.5 20.385L20.385 22.5L15 17.115L9.615 22.5L7.5 20.385L12.885 15L7.5 9.615L9.615 7.5L15 12.885L20.385 7.5L22.5 9.615L17.115 15L22.5 20.385Z\"\n  />\n</svg>\n\n<style>\n  svg {\n    display: block;\n    fill: #e15042;\n  }\n</style>\n","<script lang=\"ts\">\n  import type { Feature, ShowPlaceType } from \"./types\";\n\n  export let feature: Feature;\n\n  export let selected = false;\n\n  export let showPlaceType: ShowPlaceType;\n\n  export let missingIconsCache: Set<string>;\n\n  export let iconsBaseUrl: string;\n\n  const categories = feature.properties?.categories;\n\n  let category: string | undefined;\n\n  let imageUrl: string | undefined;\n\n  let loadIconAttempt = 0;\n\n  let isReverse = feature.place_type[0] === \"reverse\";\n\n  $: index = categories?.length ?? 0;\n\n  $: {\n    // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n    loadIconAttempt;\n\n    do {\n      index--;\n\n      category = categories?.[index];\n\n      imageUrl = category\n        ? iconsBaseUrl + category.replace(/ /g, \"_\") + \".svg\"\n        : undefined;\n    } while (index > -1 && (!imageUrl || missingIconsCache.has(imageUrl)));\n  }\n\n  $: placeType =\n    feature.properties?.categories?.join(\", \") ??\n    feature.properties?.place_type_name?.[0] ??\n    feature.place_type[0];\n\n  function handleImgError() {\n    if (imageUrl) {\n      missingIconsCache.add(imageUrl);\n    }\n\n    loadIconAttempt++;\n  }\n</script>\n\n<!-- svelte-ignore a11y-no-noninteractive-tabindex -->\n<li tabindex=\"0\" data-selected={selected} class:selected on:mouseenter on:focus>\n  {#if imageUrl}\n    <img src={imageUrl} alt={category} on:error={() => handleImgError()} />\n  {:else if feature.address}\n    <img src={iconsBaseUrl + \"housenumber.svg\"} alt={placeType} />\n  {:else if feature.id.startsWith(\"road.\")}\n    <img src={iconsBaseUrl + \"road.svg\"} alt={placeType} />\n  {:else if feature.id.startsWith(\"address.\")}\n    <img src={iconsBaseUrl + \"street.svg\"} alt={placeType} />\n  {:else if feature.id.startsWith(\"postal_code.\")}\n    <img src={iconsBaseUrl + \"postal_code.svg\"} alt={placeType} />\n  {:else if feature.id.startsWith(\"poi.\")}\n    <img src={iconsBaseUrl + \"poi.svg\"} alt={placeType} />\n  {:else if isReverse}\n    <img src={iconsBaseUrl + \"reverse.svg\"} alt={placeType} />\n  {:else}\n    <img src={iconsBaseUrl + \"area.svg\"} alt={placeType} />\n  {/if}\n\n  <span class=\"texts\">\n    <span>\n      <span class=\"primary\">\n        {isReverse ? feature.place_name : feature.place_name.replace(/,.*/, \"\")}\n      </span>\n\n      {#if showPlaceType === \"always\" || (showPlaceType !== \"never\" && !feature.address && !feature.id.startsWith(\"road.\") && !feature.id.startsWith(\"address.\") && !feature.id.startsWith(\"postal_code.\") && (!feature.id.startsWith(\"poi.\") || !imageUrl) && !isReverse)}\n        <span class=\"secondary\">\n          {placeType}\n        </span>\n      {/if}\n    </span>\n\n    <span class=\"line2\">\n      {isReverse ? \"\" : feature.place_name.replace(/[^,]*,?\\s*/, \"\")}\n    </span>\n  </span>\n</li>\n\n<style lang=\"scss\">\n  li {\n    text-align: left;\n    cursor: default;\n    display: grid;\n    grid-template-columns: 40px 1fr;\n    color: var(--color-text);\n    padding: 8px 0px;\n    font-size: 14px;\n    line-height: 18px;\n    min-width: fit-content;\n\n    &:first-child {\n      padding-top: 10px;\n    }\n\n    &:last-child {\n      padding-bottom: 10px;\n    }\n\n    &.selected {\n      background-color: #f3f6ff;\n\n      & {\n        animation: backAndForth 5s linear infinite;\n      }\n\n      & .primary {\n        color: #2b8bfb;\n      }\n    }\n\n    & > img {\n      align-self: center;\n      justify-self: center;\n      opacity: 0.75;\n    }\n  }\n\n  .texts {\n    padding: 0 17px 0 0;\n\n    & > * {\n      white-space: nowrap;\n      display: block;\n      min-width: fit-content;\n    }\n  }\n\n  .primary {\n    font-weight: 600;\n  }\n\n  .secondary {\n    color: #aeb6c7;\n    padding-left: 4px;\n  }\n\n  .line2 {\n    color: #aeb6c7;\n  }\n\n  @keyframes backAndForth {\n    0% {\n      transform: translateX(0);\n    }\n    10% {\n      transform: translateX(0);\n    }\n    45% {\n      transform: translateX(calc(-100% + 270px));\n    }\n    55% {\n      transform: translateX(calc(-100% + 270px));\n    }\n    90% {\n      transform: translateX(0);\n    }\n    100% {\n      transform: translateX(0);\n    }\n  }\n</style>\n","<div>\n  <svg viewBox=\"0 0 18 18\" width=\"24\" height=\"24\">\n    <path\n      fill=\"#333\"\n      d=\"M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z\"\n    />\n    <path\n      opacity=\".1\"\n      d=\"M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z\"\n    />\n  </svg>\n</div>\n\n<style>\n  div {\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n    pointer-events: none;\n\n    display: flex;\n    align-items: center;\n  }\n\n  svg {\n    animation: rotate 0.8s infinite cubic-bezier(0.45, 0.05, 0.55, 0.95);\n  }\n\n  @keyframes rotate {\n    from {\n      -webkit-transform: rotate(0);\n      transform: rotate(0);\n    }\n    to {\n      -webkit-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  export let displayIn: \"list\" | \"leaflet\" | \"maplibre\";\n</script>\n\n<svg\n  width={displayIn === \"list\" ? 20 : undefined}\n  viewBox=\"0 0 70 85\"\n  fill=\"none\"\n  class:in-map={displayIn !== \"list\"}\n  class:list-icon={displayIn === \"list\"}\n>\n  <path\n    stroke-width=\"4\"\n    d=\"M 5,33.103579 C 5,17.607779 18.457,5 35,5 C 51.543,5 65,17.607779 65,33.103579 C 65,56.388679 40.4668,76.048179 36.6112,79.137779 C 36.3714,79.329879 36.2116,79.457979 36.1427,79.518879 C 35.8203,79.800879 35.4102,79.942779 35,79.942779 C 34.5899,79.942779 34.1797,79.800879 33.8575,79.518879 C 33.7886,79.457979 33.6289,79.330079 33.3893,79.138079 C 29.5346,76.049279 5,56.389379 5,33.103579 Z M 35.0001,49.386379 C 43.1917,49.386379 49.8323,42.646079 49.8323,34.331379 C 49.8323,26.016779 43.1917,19.276479 35.0001,19.276479 C 26.8085,19.276479 20.1679,26.016779 20.1679,34.331379 C 20.1679,42.646079 26.8085,49.386379 35.0001,49.386379 Z\"\n  />\n</svg>\n\n<style>\n  svg {\n    display: block;\n    fill: #6b7c93;\n    stroke: #6b7c93;\n  }\n\n  .list-icon {\n    grid-row: 1/3;\n    align-self: center;\n    margin: 8px;\n  }\n\n  .in-map {\n    height: 30px;\n  }\n\n  :global(.maplibregl-canvas-container .marker-selected) {\n    z-index: 1;\n  }\n\n  :global(.maplibregl-canvas-container) svg path,\n  :global(.leaflet-map-pane) svg path {\n    fill: #3170fe;\n    stroke: #3170fe;\n  }\n\n  :global(.marker-selected) svg path {\n    fill: #98b7ff;\n    stroke: #3170fe;\n  }\n\n  :global(.marker-reverse) svg path {\n    fill: silver;\n    stroke: gray;\n  }\n\n  :global(.marker-interactive) {\n    cursor: pointer !important;\n  }\n\n  /* :global(.marker-fuzzy) svg path {\n    fill: silver;\n    stroke: gray;\n  }\n\n  :global(.marker-fuzzy.marker-selected) svg path {\n    fill: #ddd;\n    stroke: silver;\n  } */\n\n  :global(.maptiler-gc-popup > .maplibregl-popup-content) {\n    padding: 2px 8px;\n  }\n</style>\n","<svg viewBox=\"0 0 60.006 21.412\" width=\"14\" height=\"20\">\n  <path\n    d=\"M30.003-26.765C13.46-26.765 0-14.158 0 1.337c0 23.286 24.535 42.952 28.39 46.04.24.192.402.316.471.376.323.282.732.424 1.142.424.41 0 .82-.142 1.142-.424.068-.06.231-.183.471-.376 3.856-3.09 28.39-22.754 28.39-46.04 0-15.495-13.46-28.102-30.003-28.102Zm1.757 12.469c4.38 0 7.858 1.052 10.431 3.158 2.595 2.105 3.89 4.913 3.89 8.422 0 2.34-.53 4.362-1.593 6.063-1.063 1.702-3.086 3.616-6.063 5.742-2.042 1.51-3.337 2.659-3.89 3.446-.532.787-.8 1.82-.8 3.096v1.914h-8.449V15.18c0-2.041.434-3.815 1.306-5.325.872-1.51 2.467-3.118 4.785-4.82 2.233-1.594 3.7-2.89 4.402-3.889a5.582 5.582 0 0 0 1.087-3.35c0-1.382-.51-2.435-1.531-3.158-1.02-.723-2.45-1.087-4.28-1.087-3.19 0-6.826 1.047-10.91 3.131l-3.472-6.986c4.742-2.659 9.77-3.992 15.087-3.992Zm-1.88 37.324c1.765 0 3.124.472 4.08 1.408.98.936 1.47 2.276 1.47 4.02 0 1.68-.49 3.007-1.47 3.985-.977.957-2.336 1.435-4.08 1.435-1.787 0-3.171-.465-4.15-1.4-.978-.958-1.47-2.298-1.47-4.02 0-1.787.48-3.14 1.436-4.054.957-.915 2.355-1.374 4.184-1.374Z\"\n  />\n</svg>\n\n<style>\n  svg {\n    display: block;\n    fill: var(--color-icon-button);\n  }\n</style>\n","<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  width=\"13\"\n  height=\"13\"\n  viewBox=\"0 0 13 13\"\n>\n  <circle cx=\"4.789\" cy=\"4.787\" r=\"3.85\" />\n  <path d=\"M12.063 12.063 7.635 7.635\" />\n</svg>\n\n<style>\n  circle {\n    stroke-width: 1.875;\n    fill: none;\n  }\n\n  path {\n    stroke-width: 1.875;\n    stroke-linecap: round;\n  }\n\n  svg {\n    display: block;\n    stroke: var(--color-icon-button);\n  }\n</style>\n","import type { BBox } from \"./types\";\n\n// taken from Leaflet\nexport function wrapNum(\n  x: number,\n  range: [number, number],\n  includeMax: boolean,\n) {\n  const max = range[1],\n    min = range[0],\n    d = max - min;\n\n  return x === max && includeMax ? x : ((((x - min) % d) + d) % d) + min;\n}\n\nexport function unwrapBbox(bbox0: BBox): BBox {\n  const bbox = [...bbox0] satisfies BBox;\n\n  if (bbox[2] < bbox[0]) {\n    if (\n      Math.abs((bbox[0] + bbox[2] + 360) / 2) >\n      Math.abs((bbox[0] - 360 + bbox[2]) / 2)\n    ) {\n      bbox[0] -= 360;\n    } else {\n      bbox[2] += 360;\n    }\n  }\n\n  return bbox;\n}\n","import type { MapController, ProximityRule } from \"./types\";\n\nlet cachedLocation: { time: number; coords: undefined | string } | undefined;\n\nexport async function getProximity(\n  mapController: MapController | undefined,\n  proximity: ProximityRule[] | null | undefined,\n  ac: AbortController,\n) {\n  const centerAndZoom = mapController?.getCenterAndZoom();\n\n  for (const rule of proximity ?? []) {\n    if (\n      centerAndZoom &&\n      ((rule.minZoom != undefined && rule.minZoom > centerAndZoom[0]) ||\n        (rule.maxZoom != undefined && rule.maxZoom < centerAndZoom[0]))\n    ) {\n      continue;\n    }\n\n    if (rule.type === \"fixed\") {\n      return rule.coordinates.join(\",\");\n    }\n\n    cg: if (rule.type === \"client-geolocation\") {\n      if (\n        cachedLocation &&\n        rule.cachedLocationExpiry &&\n        cachedLocation.time + rule.cachedLocationExpiry > Date.now()\n      ) {\n        if (!cachedLocation.coords) {\n          break cg;\n        }\n\n        return cachedLocation.coords;\n      }\n\n      let coords: string | undefined;\n\n      try {\n        coords = await new Promise<string>((resolve, reject) => {\n          ac.signal.addEventListener(\"abort\", () => {\n            reject(Error(\"aborted\"));\n          });\n\n          navigator.geolocation.getCurrentPosition(\n            (pos) => {\n              resolve(\n                [pos.coords.longitude, pos.coords.latitude]\n                  .map((c) => c.toFixed(6))\n                  .join(\",\"),\n              );\n            },\n            (err) => {\n              reject(err);\n            },\n            rule,\n          );\n        });\n\n        return coords;\n      } catch {\n        // ignore\n      } finally {\n        if (rule.cachedLocationExpiry) {\n          cachedLocation = {\n            time: Date.now(),\n            coords,\n          };\n        }\n      }\n\n      if (ac.signal.aborted) {\n        return;\n      }\n    }\n\n    if (rule.type === \"server-geolocation\") {\n      return \"ip\";\n    }\n\n    if (centerAndZoom && rule.type === \"map-center\") {\n      return centerAndZoom[1].toFixed(6) + \",\" + centerAndZoom[2].toFixed(6);\n    }\n  }\n}\n","//Coordinates pattern matching regex\n//DM with invalid minutes (goes to coords_other); this is just a shortened version of that to create a guard condition\nconst dm_invalid = /^(NORTH|SOUTH|[NS])?\\s*([+-]?[0-8]?[0-9])\\s*([\\.:]|D(?:EG)?(?:REES)?)?\\s*,?([6-9][0-9])\\s*(['\\.:]|M(?:IN)?(?:UTES)?)?\\s*(NORTH|SOUTH|[NS])?(?:\\s*[,/;]\\s*|\\s*)(EAST|WEST|[EW])?\\s*([+-]?[0-1]?[0-9]?[0-9])\\s*([\\.:]|D(?:EG)?(?:REES)?)?\\s*,?([6-9][0-9])\\s*(['\\.:]|M(?:IN)?(?:UTES)?)?\\s*(EAST|WEST|[EW])?$/i;\n//DM as numbers only - see issue #15\nconst dm_numbers = /^([+-]?[0-8]?[0-9])\\s+([0-5]?[0-9]\\.\\d{3,})[\\s,]{1,}([+-]?[0-1]?[0-9]?[0-9])\\s+([0-5]?[0-9]\\.\\d{3,})$/;\n//decimal degrees\nconst dd_re = /^(NORTH|SOUTH|[NS])?[\\s]*([+-]?[0-8]?[0-9](?:[\\.,]\\d{3,}))[\\s]*([]?)[\\s]*(NORTH|SOUTH|[NS])?[\\s]*[,/;]?[\\s]*(EAST|WEST|[EW])?[\\s]*([+-]?[0-1]?[0-9]?[0-9](?:[\\.,]\\d{3,}))[\\s]*([]?)[\\s]*(EAST|WEST|[EW])?$/i;\n//degrees minutes seconds with '.' as separator - gives array with 15 values\nconst dms_periods = /^(NORTH|SOUTH|[NS])?\\s*([+-]?[0-8]?[0-9])\\s*(\\.)\\s*([0-5]?[0-9])\\s*(\\.)\\s*((?:[0-5]?[0-9])(?:[\\.,]\\d{1,3})?)?\\s*(NORTH|SOUTH|[NS])?(?:\\s*[,/;]\\s*|\\s*)(EAST|WEST|[EW])?\\s*([+-]?[0-1]?[0-9]?[0-9])\\s*(\\.)\\s*([0-5]?[0-9])\\s*(\\.)\\s*((?:[0-5]?[0-9])(?:[\\.,]\\d{1,3})?)?\\s*(EAST|WEST|[EW])?$/i;\n//degrees minutes seconds with words 'degrees, minutes, seconds' as separators (needed because the s of seconds messes with the S of SOUTH) - gives array of 17 values\nconst dms_abbr = /^(NORTH|SOUTH|[NS])?\\s*([+-]?[0-8]?[0-9])\\s*(D(?:EG)?(?:REES)?)\\s*([0-5]?[0-9])\\s*(M(?:IN)?(?:UTES)?)\\s*((?:[0-5]?[0-9])(?:[\\.,]\\d{1,3})?)?\\s*(S(?:EC)?(?:ONDS)?)?\\s*(NORTH|SOUTH|[NS])?(?:\\s*[,/;]\\s*|\\s*)(EAST|WEST|[EW])?\\s*([+-]?[0-1]?[0-9]?[0-9])\\s*(D(?:EG)?(?:REES)?)\\s*([0-5]?[0-9])\\s*(M(?:IN)?(?:UTES)?)\\s*((?:[0-5]?[0-9])(?:[\\.,]\\d{1,3})?)?\\s*(S(?:EC)?(?:ONDS)?)\\s*(EAST|WEST|[EW])?$/i;\n//everything else - gives array of 17 values \nconst coords_other = /^(NORTH|SOUTH|[NS])?\\s*([+-]?[0-8]?[0-9])\\s*([\\.:]|D(?:EG)?(?:REES)?)?\\s*,?([0-5]?[0-9](?:[\\.,]\\d{1,})?)?\\s*(['\\.:]|M(?:IN)?(?:UTES)?)?\\s*,?((?:[0-5]?[0-9])(?:[\\.,]\\d{1,3})?)?\\s*(''||||[\"\\.])?\\s*(NORTH|SOUTH|[NS])?(?:\\s*[,/;]\\s*|\\s*)(EAST|WEST|[EW])?\\s*([+-]?[0-1]?[0-9]?[0-9])\\s*([\\.:]|D(?:EG)?(?:REES)?)?\\s*,?([0-5]?[0-9](?:[\\.,]\\d{1,})?)?\\s*(['\\.:]|M(?:IN)?(?:UTES)?)?\\s*,?((?:[0-5]?[0-9])(?:[\\.,]\\d{1,3})?)?\\s*(''||||[\"\\.])?\\s*(EAST|WEST|[EW])?$/i;\nexport { dm_invalid, dm_numbers, dd_re, dms_periods, dms_abbr, coords_other };\n","//borrowed from https://www.codegrepper.com/code-examples/javascript/javascript+converting+latitude+longitude+to+gps+coordinates\n/**\n * Converts decimalCoordinates to commonly used string formats\n * Note that this will add degree and direction symbols to decimal coordinates\n * @param {string} format Either DMS or DM\n * @returns {string}\n */\nfunction toCoordinateFormat(format) {\n    if (!['DMS', 'DM', 'DD'].includes(format))\n        throw new Error('invalid format specified');\n    if (this.decimalCoordinates && this.decimalCoordinates.trim()) {\n        const parts = this.decimalCoordinates.split(',').map(x => Number(x.trim()));\n        const decimalLatitude = Number(parts[0]);\n        const decimalLongitude = Number(parts[1]);\n        const absoluteLatitude = Math.abs(decimalLatitude);\n        const absoluteLongitude = Math.abs(decimalLongitude);\n        const latDir = decimalLatitude > 0 ? \"N\" : \"S\";\n        const longDir = decimalLongitude > 0 ? \"E\" : \"W\";\n        let result;\n        if (format == 'DD') {\n            result = `${absoluteLatitude} ${latDir}, ${absoluteLongitude} ${longDir}`;\n        }\n        //else we need some more things\n        const degreesLatitude = Math.floor(absoluteLatitude);\n        const degreesLongitude = Math.floor(absoluteLongitude);\n        const minutesLatitudeNotTruncated = (absoluteLatitude - degreesLatitude) * 60;\n        const minutesLongitudeNotTruncated = (absoluteLongitude - degreesLongitude) * 60;\n        if (format == 'DM') {\n            let dmMinsLatitude = round(minutesLatitudeNotTruncated, 3).toFixed(3).padStart(6, '0');\n            let dmMinsLongitude = round(minutesLongitudeNotTruncated, 3).toFixed(3).padStart(6, '0');\n            if (dmMinsLatitude.endsWith('.000') && dmMinsLongitude.endsWith('.000')) {\n                dmMinsLatitude = dmMinsLatitude.replace(/\\.000$/, '');\n                dmMinsLongitude = dmMinsLongitude.replace(/\\.000$/, '');\n            }\n            result = `${degreesLatitude} ${dmMinsLatitude}' ${latDir}, ${degreesLongitude} ${dmMinsLongitude}' ${longDir}`;\n        }\n        if (format == \"DMS\") {\n            const latMinutes = Math.floor(minutesLatitudeNotTruncated);\n            const longMinutes = Math.floor(minutesLongitudeNotTruncated);\n            let latSeconds = ((minutesLatitudeNotTruncated - latMinutes) * 60).toFixed(1).padStart(4, '0');\n            let longSeconds = ((minutesLongitudeNotTruncated - longMinutes) * 60).toFixed(1).padStart(4, '0');\n            const latMinutesString = latMinutes.toString().padStart(2, '0');\n            const longMinutesString = longMinutes.toString().padStart(2, '0');\n            // if they both end in .0 we drop the .0\n            if (latSeconds.endsWith('.0') && longSeconds.endsWith('.0')) {\n                latSeconds = latSeconds.replace(/\\.0$/, '');\n                longSeconds = longSeconds.replace(/\\.0$/, '');\n            }\n            result = `${degreesLatitude} ${latMinutesString}' ${latSeconds}\" ${latDir}, ${degreesLongitude} ${longMinutesString}' ${longSeconds}\" ${longDir}`;\n        }\n        return result;\n    }\n    else {\n        throw new Error('no decimal coordinates to convert');\n    }\n}\nfunction round(num, places) {\n    const d = Math.pow(10, places);\n    return Math.round((num + Number.EPSILON) * d) / d;\n}\nexport default toCoordinateFormat;\n","//function for converting coordinates from a string to decimal and verbatim\n//this is just a comment\nimport { dm_invalid, dm_numbers, dd_re, dms_periods, dms_abbr, coords_other } from './regex.js';\nimport toCoordinateFormat from './toCoordinateFormat.js';\n/**\n * Function for converting coordinates in a variety of formats to decimal coordinates\n * @param {string} coordsString The coordinates string to convert\n * @param {number} [decimalPlaces] The number of decimal places for converted coordinates; default is 5\n * @returns {{verbatimCoordinates: string, decimalCoordinates: string, decimalLatitude: number, decimalLongitude: number, closeEnough: function(string): boolean, toCoordinateFormat: toCoordinateFormat}}\n */\nfunction converter(coordsString, decimalPlaces) {\n    //TODO add exact match to entered string, so that it can be used to filter out superflous text around it\n    if (!decimalPlaces) {\n        decimalPlaces = 5;\n    }\n    coordsString = coordsString.replace(/\\s+/g, ' ').trim(); //just to tidy up whitespaces\n    let ddLat = null;\n    let ddLng = null;\n    let latdir = \"\";\n    let lngdir = \"\";\n    let originalFormat = null;\n    let match = [];\n    let matchSuccess = false;\n    if (dm_invalid.test(coordsString)) {\n        throw new Error(\"invalid coordinate value\");\n    }\n    if (dm_numbers.test(coordsString)) {\n        match = dm_numbers.exec(coordsString);\n        matchSuccess = checkMatch(match);\n        if (matchSuccess) {\n            ddLat = Math.abs(match[1]) + match[2] / 60;\n            if (Number(match[1]) < 0) {\n                ddLat *= -1;\n            }\n            ddLng = Math.abs(match[3]) + match[4] / 60;\n            if (Number(match[3]) < 0) {\n                ddLng *= -1;\n            }\n            originalFormat = \"DM\";\n        }\n        else {\n            throw new Error(\"invalid coordinate format\");\n        }\n    }\n    else if (dd_re.test(coordsString)) {\n        match = dd_re.exec(coordsString);\n        matchSuccess = checkMatch(match);\n        if (matchSuccess) {\n            ddLat = match[2];\n            ddLng = match[6];\n            //need to fix if there are ','s instead of '.'\n            if (ddLat.includes(',')) {\n                ddLat = ddLat.replace(',', '.');\n            }\n            if (ddLng.includes(',')) {\n                ddLng = ddLng.replace(',', '.');\n            }\n            originalFormat = \"DD\";\n            //validation, we don't want things like 23.00000\n            //some more validation: no zero coords or degrees only\n            if (Number(Math.round(ddLat)) == Number(ddLat)) {\n                throw new Error('integer only coordinate provided');\n            }\n            if (Number(Math.round(ddLng)) == Number(ddLng)) {\n                throw new Error('integer only coordinate provided');\n            }\n            //get directions\n            if (match[1]) {\n                latdir = match[1];\n                lngdir = match[5];\n            }\n            else if (match[4]) {\n                latdir = match[4];\n                lngdir = match[8];\n            }\n        }\n        else {\n            throw new Error(\"invalid decimal coordinate format\");\n        }\n    }\n    else if (dms_periods.test(coordsString)) {\n        match = dms_periods.exec(coordsString);\n        matchSuccess = checkMatch(match);\n        if (matchSuccess) {\n            ddLat = Math.abs(parseInt(match[2]));\n            if (match[4]) {\n                ddLat += match[4] / 60;\n                originalFormat = \"DM\";\n            }\n            if (match[6]) {\n                ddLat += match[6].replace(',', '.') / 3600;\n                originalFormat = \"DMS\";\n            }\n            if (parseInt(match[2]) < 0) {\n                ddLat = -1 * ddLat;\n            }\n            ddLng = Math.abs(parseInt(match[9]));\n            if (match[11]) {\n                ddLng += match[11] / 60;\n            }\n            if (match[13]) {\n                ddLng += match[13].replace(',', '.') / 3600;\n            }\n            if (parseInt(match[9]) < 0) {\n                ddLng = -1 * ddLng;\n            }\n            //the compass directions\n            if (match[1]) {\n                latdir = match[1];\n                lngdir = match[8];\n            }\n            else if (match[7]) {\n                latdir = match[7];\n                lngdir = match[14];\n            }\n        }\n        else {\n            throw new Error(\"invalid DMS coordinates format\");\n        }\n    }\n    else if (dms_abbr.test(coordsString)) {\n        match = dms_abbr.exec(coordsString);\n        matchSuccess = checkMatch(match);\n        if (matchSuccess) {\n            ddLat = Math.abs(parseInt(match[2]));\n            if (match[4]) {\n                ddLat += match[4] / 60;\n                originalFormat = \"DM\";\n            }\n            if (match[6]) {\n                ddLat += match[6] / 3600;\n                originalFormat = \"DMS\";\n            }\n            if (parseInt(match[2]) < 0) {\n                ddLat = -1 * ddLat;\n            }\n            ddLng = Math.abs(parseInt(match[10]));\n            if (match[12]) {\n                ddLng += match[12] / 60;\n            }\n            if (match[14]) {\n                ddLng += match[14] / 3600;\n            }\n            if (parseInt(match[10]) < 0) {\n                ddLng = -1 * ddLng;\n            }\n            //the compass directions\n            if (match[1]) {\n                latdir = match[1];\n                lngdir = match[9];\n            }\n            else if (match[8]) {\n                latdir = match[8];\n                lngdir = match[16];\n            }\n        }\n        else {\n            throw new Error(\"invalid DMS coordinates format\");\n        }\n    }\n    else if (coords_other.test(coordsString)) {\n        match = coords_other.exec(coordsString);\n        matchSuccess = checkMatch(match);\n        // we need an extra check here for things that matched that shouldn't have\n        if (match.filter(x => x).length <= 5) {\n            throw new Error(\"invalid coordinates format\");\n        }\n        if (matchSuccess) {\n            ddLat = Math.abs(parseInt(match[2]));\n            if (match[4]) {\n                ddLat += match[4].replace(',', '.') / 60;\n                originalFormat = \"DM\";\n            }\n            if (match[6]) {\n                ddLat += match[6].replace(',', '.') / 3600;\n                originalFormat = \"DMS\";\n            }\n            if (parseInt(match[2]) < 0) {\n                ddLat = -1 * ddLat;\n            }\n            ddLng = Math.abs(parseInt(match[10]));\n            if (match[12]) {\n                ddLng += match[12].replace(',', '.') / 60;\n            }\n            if (match[14]) {\n                ddLng += match[14].replace(',', '.') / 3600;\n            }\n            if (parseInt(match[10]) < 0) {\n                ddLng = -1 * ddLng;\n            }\n            //the compass directions\n            if (match[1]) {\n                latdir = match[1];\n                lngdir = match[9];\n            }\n            else if (match[8]) {\n                latdir = match[8];\n                lngdir = match[16];\n            }\n        }\n        else {\n            throw new Error(\"invalid coordinates format\");\n        }\n    }\n    if (matchSuccess) {\n        //more validation....\n        //check longitude value - it can be wrong!\n        if (Math.abs(ddLng) >= 180) {\n            throw new Error(\"invalid longitude value\");\n        }\n        //just to be safe check latitude also...\n        if (Math.abs(ddLat) >= 90) {\n            throw new Error(\"invalid latitude value\");\n        }\n        //if we have one direction we must have the other\n        if ((latdir && !lngdir) || (!latdir && lngdir)) {\n            throw new Error(\"invalid coordinates value\");\n        }\n        //the directions can't be the same\n        if (latdir && latdir == lngdir) {\n            throw new Error(\"invalid coordinates format\");\n        }\n        // a bit of tidying up...\n        if (ddLat.toString().includes(',')) {\n            ddLat = ddLat.replace(',', '.');\n        }\n        if (ddLng.toString().includes(',')) {\n            ddLng = ddLng.replace(',', '.');\n        }\n        //make sure the signs and cardinal directions match\n        let patt = /S|SOUTH/i;\n        if (patt.test(latdir)) {\n            if (ddLat > 0) {\n                ddLat = -1 * ddLat;\n            }\n        }\n        patt = /W|WEST/i;\n        if (patt.test(lngdir)) {\n            if (ddLng > 0) {\n                ddLng = -1 * ddLng;\n            }\n        }\n        //we need to get the verbatim coords from the string\n        //we can't split down the middle because if there are decimals they may have different numbers on each side\n        //so we need to find the separating character, or if none, use the match values to split down the middle\n        const verbatimCoordinates = match[0].trim();\n        let verbatimLat;\n        let verbatimLng;\n        const sepChars = /[,/;\\u0020]/g; //comma, forward slash and spacebar\n        const seps = verbatimCoordinates.match(sepChars);\n        if (seps == null) {\n            //split down the middle\n            const middle = Math.floor(coordsString.length / 2);\n            verbatimLat = verbatimCoordinates.substring(0, middle).trim();\n            verbatimLng = verbatimCoordinates.substring(middle).trim();\n        }\n        else { //if length is odd then find the index of the middle value\n            //get the middle index\n            let middle;\n            //easy for odd numbers\n            if (seps.length % 2 == 1) {\n                middle = Math.floor(seps.length / 2);\n            }\n            else {\n                middle = (seps.length / 2) - 1;\n            }\n            //walk through seps until we get to the middle\n            let splitIndex = 0;\n            //it might be only one value\n            if (middle == 0) {\n                splitIndex = verbatimCoordinates.indexOf(seps[0]);\n                verbatimLat = verbatimCoordinates.substring(0, splitIndex).trim();\n                verbatimLng = verbatimCoordinates.substring(splitIndex + 1).trim();\n            }\n            else {\n                let currSepIndex = 0;\n                let startSearchIndex = 0;\n                while (currSepIndex <= middle) {\n                    splitIndex = verbatimCoordinates.indexOf(seps[currSepIndex], startSearchIndex);\n                    startSearchIndex = splitIndex + 1;\n                    currSepIndex++;\n                }\n                verbatimLat = verbatimCoordinates.substring(0, splitIndex).trim();\n                verbatimLng = verbatimCoordinates.substring(splitIndex + 1).trim();\n            }\n        }\n        //validation again...\n        //we only allow zeros after the period if its DM\n        const splitLat = verbatimLat.split('.');\n        if (splitLat.length == 2) {\n            if (splitLat[1] == 0 && splitLat[1].length != 2) {\n                throw new Error('invalid coordinates format');\n            }\n        }\n        const splitLon = verbatimLng.split('.');\n        if (splitLon.length == 2) {\n            if (splitLon[1] == 0 && splitLon[1].length != 2) {\n                throw new Error('invalid coordinates format');\n            }\n        }\n        //no integer coords allowed\n        if (/^\\d+$/.test(verbatimLat) || /^\\d+$/.test(verbatimLng)) {\n            throw new Error('degree only coordinate/s provided');\n        }\n        //all done!!\n        //just truncate the decimals appropriately\n        ddLat = Number(Number(ddLat).toFixed(decimalPlaces));\n        ddLng = Number(Number(ddLng).toFixed(decimalPlaces));\n        return Object.freeze({\n            verbatimCoordinates,\n            verbatimLatitude: verbatimLat,\n            verbatimLongitude: verbatimLng,\n            decimalLatitude: ddLat,\n            decimalLongitude: ddLng,\n            decimalCoordinates: `${ddLat},${ddLng}`,\n            originalFormat,\n            closeEnough: coordsCloseEnough,\n            toCoordinateFormat\n        });\n    }\n    else {\n        throw new Error(\"coordinates pattern match failed\");\n    }\n}\nfunction checkMatch(match) {\n    if (!isNaN(match[0])) { //we've matched a number, not what we want....\n        return false;\n    }\n    //first remove the empty values from the array\n    const filteredMatch = [...match];\n    //we need to shift the array because it contains the whole coordinates string in the first item\n    filteredMatch.shift();\n    //check the array length is an even number\n    if (filteredMatch.length % 2 > 0) {\n        return false;\n    }\n    // regex for testing corresponding values match\n    const numerictest = /^[-+]?\\d+([\\.,]\\d+)?$/; //for testing numeric values\n    const stringtest = /[eastsouthnorthwest]+/i; //for testing string values (north, south, etc)\n    const halflen = filteredMatch.length / 2;\n    for (let i = 0; i < halflen; i++) {\n        const leftside = filteredMatch[i];\n        const rightside = filteredMatch[i + halflen];\n        const bothAreNumbers = numerictest.test(leftside) && numerictest.test(rightside);\n        const bothAreStrings = stringtest.test(leftside) && stringtest.test(rightside);\n        const valuesAreEqual = leftside == rightside;\n        if (leftside == undefined && rightside == undefined) { //we have to handle undefined because regex converts it to string 'undefined'!!\n            continue;\n        }\n        else if (leftside == undefined || rightside == undefined) { //no we need to handle the case where one is and the other not...\n            return false;\n        }\n        else if (bothAreNumbers || bothAreStrings || valuesAreEqual) {\n            continue;\n        }\n        else {\n            return false;\n        }\n    }\n    return true;\n}\n//functions for coordinate validation\n//as decimal arithmetic is not straightforward, we approximate\nfunction decimalsCloseEnough(dec1, dec2) {\n    const originaldiff = Math.abs(dec1 - dec2);\n    const diff = Number(originaldiff.toFixed(6));\n    if (diff <= 0.00001) {\n        return true;\n    }\n    else {\n        return false;\n    }\n}\nfunction coordsCloseEnough(coordsToTest) {\n    if (!coordsToTest) {\n        throw new Error('coords must be provided');\n    }\n    if (coordsToTest.includes(',')) {\n        const coords = coordsToTest.split(',');\n        if (Number(coords[0]) == NaN || Number(coords[1]) == NaN) {\n            throw new Error(\"coords are not valid decimals\");\n        }\n        else {\n            return decimalsCloseEnough(this.decimalLatitude, Number(coords[0])) && decimalsCloseEnough(this.decimalLongitude, coords[1]); //this here will be the converted coordinates object\n        }\n    }\n    else {\n        throw new Error(\"coords being tested must be separated by a comma\");\n    }\n}\n// An enum for coordinates formats\nconst to = Object.freeze({\n    DMS: 'DMS',\n    DM: 'DM',\n    DD: 'DD'\n});\nconverter.to = to;\nexport default converter;\n","//return an array of coordinate strings for testing\n//coordinations-parser formats\n//https://www.npmjs.com/package/coordinate-parser\nconst coordsParserFormats = [\n    {\n        verbatimCoordinates: '40.123, -74.123',\n        verbatimLatitude: '40.123',\n        verbatimLongitude: '-74.123'\n    },\n    {\n        verbatimCoordinates: '40.123 N 74.123 W',\n        verbatimLatitude: '40.123 N',\n        verbatimLongitude: '74.123 W'\n    },\n    {\n        verbatimCoordinates: '40.123 N 74.123 W',\n        verbatimLatitude: '40.123 N',\n        verbatimLongitude: '74.123 W'\n    },\n    {\n        verbatimCoordinates: '40 7 22.8\" N 74 7 22.8\" W',\n        verbatimLatitude: '40 7 22.8\" N',\n        verbatimLongitude: '74 7 22.8\" W'\n    },\n    {\n        verbatimCoordinates: '40 7.38 , -74 7.38',\n        verbatimLatitude: '40 7.38',\n        verbatimLongitude: '-74 7.38'\n    },\n    {\n        verbatimCoordinates: 'N40722.8, W74722.8',\n        verbatimLatitude: 'N40722.8',\n        verbatimLongitude: 'W74722.8'\n    },\n    {\n        verbatimCoordinates: '40722.8\"N, 74722.8\"W',\n        verbatimLatitude: '40722.8\"N',\n        verbatimLongitude: '74722.8\"W'\n    },\n    {\n        verbatimCoordinates: '407\\'22.8\"N, 747\\'22.8\"W',\n        verbatimLatitude: '407\\'22.8\"N',\n        verbatimLongitude: '747\\'22.8\"W'\n    },\n    {\n        verbatimCoordinates: '40 7 22.8, -74 7 22.8',\n        verbatimLatitude: '40 7 22.8',\n        verbatimLongitude: '-74 7 22.8'\n    },\n    {\n        verbatimCoordinates: '40.123 -74.123',\n        verbatimLatitude: '40.123',\n        verbatimLongitude: '-74.123'\n    },\n    {\n        verbatimCoordinates: '40.123,-74.123',\n        verbatimLatitude: '40.123',\n        verbatimLongitude: '-74.123'\n    },\n    {\n        verbatimCoordinates: '40.123N74.123W',\n        verbatimLatitude: '40.123N',\n        verbatimLongitude: '74.123W'\n    },\n    {\n        verbatimCoordinates: '4007.38N7407.38W',\n        verbatimLatitude: '4007.38N',\n        verbatimLongitude: '7407.38W'\n    },\n    {\n        verbatimCoordinates: '40722.8\"N, 74722.8\"W',\n        verbatimLatitude: '40722.8\"N',\n        verbatimLongitude: '74722.8\"W'\n    },\n    {\n        verbatimCoordinates: '400722.8N740722.8W',\n        verbatimLatitude: '400722.8N',\n        verbatimLongitude: '740722.8W'\n    },\n    {\n        verbatimCoordinates: 'N 40 7.38 W 74 7.38',\n        verbatimLatitude: 'N 40 7.38',\n        verbatimLongitude: 'W 74 7.38'\n    },\n    {\n        verbatimCoordinates: '40:7:22.8N 74:7:22.8W',\n        verbatimLatitude: '40:7:22.8N',\n        verbatimLongitude: '74:7:22.8W'\n    },\n    {\n        verbatimCoordinates: '40:7:23N,74:7:23W',\n        verbatimLatitude: '40:7:23N',\n        verbatimLongitude: '74:7:23W',\n        decimalLatitude: 40.1230555555,\n        decimalLongitude: -74.1230555555\n    },\n    {\n        verbatimCoordinates: '40723\"N 74723\"W',\n        verbatimLatitude: '40723\"N',\n        verbatimLongitude: '74723\"W',\n        decimalLatitude: 40.1230555555,\n        decimalLongitude: -74.12305555555555\n    },\n    {\n        verbatimCoordinates: '40723\"S 74723\"E',\n        verbatimLatitude: '40723\"S',\n        verbatimLongitude: '74723\"E',\n        decimalLatitude: -40.1230555555,\n        decimalLongitude: 74.12305555555555\n    },\n    {\n        verbatimCoordinates: '40723\" -74723\"',\n        verbatimLatitude: '40723\"',\n        verbatimLongitude: '-74723\"',\n        decimalLatitude: 40.1230555555,\n        decimalLongitude: -74.123055555\n    },\n    {\n        verbatimCoordinates: '40d 7 23\" N 74d 7 23\" W',\n        verbatimLatitude: '40d 7 23\" N',\n        verbatimLongitude: '74d 7 23\" W',\n        decimalLatitude: 40.1230555555,\n        decimalLongitude: -74.123055555\n    },\n    {\n        verbatimCoordinates: '40.123N 74.123W',\n        verbatimLatitude: '40.123N',\n        verbatimLongitude: '74.123W'\n    },\n    {\n        verbatimCoordinates: '40 7.38, -74 7.38',\n        verbatimLatitude: '40 7.38',\n        verbatimLongitude: '-74 7.38'\n    },\n    {\n        verbatimCoordinates: '40 7.38, -74 7.38',\n        verbatimLatitude: '40 7.38',\n        verbatimLongitude: '-74 7.38'\n    },\n    {\n        verbatimCoordinates: '40 7 22.8; -74 7 22.8',\n        verbatimLatitude: '40 7 22.8',\n        verbatimLongitude: '-74 7 22.8'\n    }\n];\nconst coordsParserDecimals = {\n    decimalLatitude: 40.123,\n    decimalLongitude: -74.123\n};\n//formats from https://gist.github.com/moole/3707127/337bd31d813a10abcf55084381803e5bbb0b20dc \nconst coordsRegexFormats = [\n    {\n        verbatimCoordinates: '504\\'17.698\"south, 1424\\'2.826\"east',\n        verbatimLatitude: '504\\'17.698\"south',\n        verbatimLongitude: '1424\\'2.826\"east',\n        decimalLatitude: -50.0715827777777778,\n        decimalLongitude: 14.400785\n    },\n    {\n        verbatimCoordinates: '50d4m17.698S 14d24m2.826E',\n        verbatimLatitude: '50d4m17.698S',\n        verbatimLongitude: '14d24m2.826E',\n        decimalLatitude: -50.0715827777777778,\n        decimalLongitude: 14.400785\n    },\n    {\n        verbatimCoordinates: '40:26:46N,79:56:55W',\n        verbatimLatitude: '40:26:46N',\n        verbatimLongitude: '79:56:55W',\n        decimalLatitude: 40.4461111111111111,\n        decimalLongitude: -79.9486111111111111\n    },\n    {\n        verbatimCoordinates: '40:26:46.302N 79:56:55.903W',\n        verbatimLatitude: '40:26:46.302N',\n        verbatimLongitude: '79:56:55.903W',\n        decimalLatitude: 40.446195,\n        decimalLongitude: -79.9488619444444444\n    },\n    {\n        verbatimCoordinates: '402647N 795836W',\n        verbatimLatitude: '402647N',\n        verbatimLongitude: '795836W',\n        decimalLatitude: 40.4463888888888889,\n        decimalLongitude: -79.9766666666666667\n    },\n    {\n        verbatimCoordinates: '40d 26 47 N 79d 58 36 W',\n        verbatimLatitude: '40d 26 47 N',\n        verbatimLongitude: '79d 58 36 W',\n        decimalLatitude: 40.4463888888888889,\n        decimalLongitude: -79.9766666666666667\n    },\n    {\n        verbatimCoordinates: '40.446195N 79.948862W',\n        verbatimLatitude: '40.446195N',\n        verbatimLongitude: '79.948862W',\n        decimalLatitude: 40.446195,\n        decimalLongitude: -79.948862\n    },\n    {\n        verbatimCoordinates: '40,446195 79,948862',\n        verbatimLatitude: '40,446195',\n        verbatimLongitude: '79,948862',\n        decimalLatitude: 40.446195,\n        decimalLongitude: 79.948862\n    },\n    {\n        verbatimCoordinates: '40 26.7717, -79 56.93172',\n        verbatimLatitude: '40 26.7717',\n        verbatimLongitude: '-79 56.93172',\n        decimalLatitude: 40.446195,\n        decimalLongitude: -79.948862\n    },\n    {\n        verbatimCoordinates: '40.446195, -79.948862',\n        verbatimLatitude: '40.446195',\n        verbatimLongitude: '-79.948862',\n        decimalLatitude: 40.446195,\n        decimalLongitude: -79.948862\n    },\n    {\n        verbatimCoordinates: '40.123256; -74.123256',\n        verbatimLatitude: '40.123256',\n        verbatimLongitude: '-74.123256',\n        decimalLatitude: 40.123256,\n        decimalLongitude: -74.123256\n    },\n    {\n        verbatimCoordinates: '1824S 2245E',\n        verbatimLatitude: '1824S',\n        verbatimLongitude: '2245E',\n        decimalLatitude: -18.4,\n        decimalLongitude: 22.75\n    }\n];\n// additional formats we've encountered\nconst otherFormats = [\n    {\n        verbatimCoordinates: '10.432342S 10.6345345E',\n        verbatimLatitude: '10.432342S',\n        verbatimLongitude: '10.6345345E',\n        decimalLatitude: -10.432342,\n        decimalLongitude: 10.6345345\n    },\n    {\n        verbatimCoordinates: '10.00S 10.00E',\n        verbatimLatitude: '10.00S',\n        verbatimLongitude: '10.00E',\n        decimalLatitude: -10.00000,\n        decimalLongitude: 10.00000\n    },\n    {\n        verbatimCoordinates: '00.00S 01.00E',\n        verbatimLatitude: '00.00S',\n        verbatimLongitude: '01.00E',\n        decimalLatitude: 0.00000,\n        decimalLongitude: 1.00000\n    },\n    {\n        verbatimCoordinates: '18.24S 22.45E',\n        verbatimLatitude: '18.24S',\n        verbatimLongitude: '22.45E',\n        decimalLatitude: -18.4,\n        decimalLongitude: 22.75\n    },\n    {\n        verbatimCoordinates: '27deg 15min 45.2sec S 18deg 32min 53.7sec E',\n        verbatimLatitude: '27deg 15min 45.2sec S',\n        verbatimLongitude: '18deg 32min 53.7sec E',\n        decimalLatitude: -27.2625555555555556,\n        decimalLongitude: 18.54825\n    },\n    {\n        verbatimCoordinates: '-23.3245 S / 28.2344 E',\n        verbatimLatitude: '-23.3245 S',\n        verbatimLongitude: '28.2344 E',\n        decimalLatitude: -23.3245,\n        decimalLongitude: 28.2344\n    },\n    {\n        verbatimCoordinates: '40 26.7717 -79 56.93172',\n        verbatimLatitude: '40 26.7717',\n        verbatimLongitude: '-79 56.93172',\n        decimalLatitude: 40.446195,\n        decimalLongitude: -79.948862\n    },\n    {\n        verbatimCoordinates: '27.15.45S 18.32.53E',\n        verbatimLatitude: '27.15.45S',\n        verbatimLongitude: '18.32.53E',\n        decimalLatitude: -27.2625,\n        decimalLongitude: 18.548055\n    },\n    {\n        verbatimCoordinates: '-27.15.45 18.32.53',\n        verbatimLatitude: '-27.15.45',\n        verbatimLongitude: '18.32.53',\n        decimalLatitude: -27.2625,\n        decimalLongitude: 18.548055\n    },\n    {\n        verbatimCoordinates: '27.15.45.2S 18.32.53.4E',\n        verbatimLatitude: '27.15.45.2S',\n        verbatimLongitude: '18.32.53.4E',\n        decimalLatitude: -27.262556,\n        decimalLongitude: 18.548167\n    },\n    {\n        verbatimCoordinates: '27.15.45,2S 18.32.53,4E',\n        verbatimLatitude: '27.15.45,2S',\n        verbatimLongitude: '18.32.53,4E',\n        decimalLatitude: -27.262556,\n        decimalLongitude: 18.548167\n    },\n    {\n        verbatimCoordinates: 'S23.43563   E22.45634 ',\n        verbatimLatitude: 'S23.43563 ',\n        verbatimLongitude: 'E22.45634 ',\n        decimalLatitude: -23.43563,\n        decimalLongitude: 22.45634\n    },\n    {\n        verbatimCoordinates: '27,71372 S 23,07771 E',\n        verbatimLatitude: '27,71372 S',\n        verbatimLongitude: '23,07771 E',\n        decimalLatitude: -27.71372,\n        decimalLongitude: 23.07771\n    },\n    {\n        verbatimCoordinates: '27.45.34 S 23.23.23 E',\n        verbatimLatitude: '27.45.34 S',\n        verbatimLongitude: '23.23.23 E',\n        decimalLatitude: -27.759444,\n        decimalLongitude: 23.38972222\n    },\n    {\n        verbatimCoordinates: 'S 27.45.34 E 23.23.23',\n        verbatimLatitude: 'S 27.45.34',\n        verbatimLongitude: 'E 23.23.23',\n        decimalLatitude: -27.759444,\n        decimalLongitude: 23.38972222\n    },\n    {\n        verbatimCoordinates: '53 16.3863,4 52.8171',\n        verbatimLatitude: '53 16.3863',\n        verbatimLongitude: '4 52.8171',\n        decimalLatitude: 53.273105,\n        decimalLongitude: 4.88029\n    },\n    {\n        verbatimCoordinates: '50 8.2914,-5 2.4447',\n        verbatimLatitude: '50 8.2914',\n        verbatimLongitude: '-5 2.4447',\n        decimalLatitude: 50.13819,\n        decimalLongitude: -5.040745\n    },\n    {\n        verbatimCoordinates: `N 48 30,6410', E 18 57,4583'`,\n        verbatimLatitude: `N 48 30,6410'`,\n        verbatimLongitude: `E 18 57,4583'`,\n        decimalLatitude: 48.51068,\n        decimalLongitude: 18.95764\n    },\n    {\n        verbatimCoordinates: `1.23456, 18.33453`,\n        verbatimLatitude: `1.23456`,\n        verbatimLongitude: `18.33453`,\n        decimalLatitude: 1.23456,\n        decimalLongitude: 18.33453\n    }\n];\nfunction getAllTestFormats() {\n    const arr1 = [];\n    coordsParserFormats.forEach(item => {\n        if (item.decimalLatitude) {\n            arr1.push(item);\n        }\n        else {\n            arr1.push({ ...item, ...coordsParserDecimals });\n        }\n    });\n    return [...arr1, ...coordsRegexFormats, ...otherFormats];\n}\nexport default getAllTestFormats();\n","//adds the formats to the convert object\n//we need to use this as the source for the npm package so that the formats are not included in the bundle\nimport converter from './converter.js';\nimport testFormats from './tests/testformats.js';\nconverter.formats = testFormats.map(format => format.verbatimCoordinates);\nexport const convert = converter;\n","<script lang=\"ts\">\n  import { createEventDispatcher, onDestroy } from \"svelte\";\n  import { default as ClearIcon } from \"./ClearIcon.svelte\";\n  import { default as FailIcon } from \"./FailIcon.svelte\";\n  import { default as FeatureItem } from \"./FeatureItem.svelte\";\n  import { default as LoadingIcon } from \"./LoadingIcon.svelte\";\n  import MarkerIcon from \"./MarkerIcon.svelte\";\n  import { default as ReverseGeocodingIcon } from \"./ReverseGeocodingIcon.svelte\";\n  import { default as SearchIcon } from \"./SearchIcon.svelte\";\n  import { unwrapBbox, wrapNum } from \"./geoUtils\";\n  import { getProximity } from \"./proximity\";\n  import { convert } from \"geo-coordinates-parser\";\n  import type {\n    BBox,\n    DispatcherType,\n    EnableReverse,\n    Feature,\n    FeatureCollection,\n    MapController,\n    PickedResultStyle,\n    ProximityRule,\n    ShowPlaceType,\n  } from \"./types\";\n\n  export const ZOOM_DEFAULTS: Record<string, number> = {\n    continental_marine: 4,\n    country: 4,\n    major_landform: 8,\n    region: 5,\n    subregion: 6,\n    county: 7,\n    joint_municipality: 8,\n    joint_submunicipality: 9,\n    municipality: 10,\n    municipal_district: 11,\n    locality: 12,\n    neighbourhood: 13,\n    place: 14,\n    postal_code: 14,\n    road: 16,\n    poi: 17,\n    address: 18,\n    \"poi.peak\": 15,\n    \"poi.shop\": 18,\n    \"poi.cafe\": 18,\n    \"poi.restaurant\": 18,\n    \"poi.aerodrome\": 13,\n    // TODO add many more\n  };\n\n  let className: string | undefined = undefined;\n\n  export { className as class };\n\n  export let apiKey: string;\n\n  export let bbox: BBox | undefined = undefined;\n\n  export let clearButtonTitle = \"clear\";\n\n  export let clearOnBlur = false;\n\n  export let collapsed = false;\n\n  export let country: string | string[] | undefined = undefined;\n\n  export let debounceSearch = 200;\n\n  export let enableReverse: EnableReverse = \"never\";\n\n  export let errorMessage = \"Something went wrong\";\n\n  export let filter: (feature: Feature) => boolean = () => true;\n\n  export let flyTo = true;\n\n  export let fuzzyMatch = true;\n\n  export let language: string | string[] | null | undefined = undefined;\n\n  export let limit: number | undefined = undefined;\n\n  export let mapController: MapController | undefined = undefined;\n\n  export let minLength = 2;\n\n  export let noResultsMessage =\n    \"Oops! Looks like you're trying to predict something that's not quite right. We can't seem to find what you're looking for. Maybe try double-checking your spelling or try a different search term. Keep on typing - we'll do our best to get you where you need to go!\";\n\n  export let placeholder = \"Search\";\n\n  export let proximity: ProximityRule[] | null | undefined = [\n    { type: \"server-geolocation\" },\n  ];\n\n  export let reverseActive = enableReverse === \"always\";\n\n  export let reverseButtonTitle = \"toggle reverse geocoding\";\n\n  export let searchValue = \"\";\n\n  export let pickedResultStyle: PickedResultStyle = \"full-geometry\";\n\n  export let showPlaceType: ShowPlaceType = \"if-needed\";\n\n  export let showResultsWhileTyping = true;\n\n  export let selectFirst = true;\n\n  export let flyToSelected = false;\n\n  export let markerOnSelected = true;\n\n  export let types: string[] | undefined = undefined;\n\n  export let exhaustiveReverseGeocoding = false;\n\n  export let excludeTypes = false;\n\n  export let zoom: Record<string, number> = ZOOM_DEFAULTS;\n\n  export let apiUrl: string = import.meta.env.VITE_API_URL;\n\n  export let fetchParameters: RequestInit = {};\n\n  export let iconsBaseUrl =\n    \"https://cdn.maptiler.com/maptiler-geocoding-control/v\" +\n    import.meta.env.VITE_LIB_VERSION +\n    \"/icons/\";\n\n  export let adjustUrlQuery: (sp: URLSearchParams) => void = () => {};\n\n  export function focus() {\n    input.focus();\n  }\n\n  export function blur() {\n    input.blur();\n  }\n\n  export function setQuery(value: string, submit = true, reverse = false) {\n    searchValue = value;\n\n    if (submit) {\n      selectedItemIndex = -1;\n\n      handleOnSubmit();\n    } else {\n      handleInput(!reverse, reverse);\n\n      setTimeout(() => {\n        input.focus();\n        input.select();\n      });\n    }\n  }\n\n  export function clearList() {\n    listFeatures = undefined;\n    picked = undefined;\n    selectedItemIndex = -1;\n  }\n\n  export function clearMap() {\n    markedFeatures = [];\n    picked = undefined;\n  }\n\n  let focused = false;\n\n  let listFeatures: Feature[] | undefined;\n\n  let markedFeatures: Feature[] | undefined;\n\n  let picked: Feature | undefined;\n\n  let lastSearchUrl = \"\";\n\n  let input: HTMLInputElement;\n\n  let selectedItemIndex = -1;\n\n  let error: unknown;\n\n  let cachedFeatures: Feature[] = [];\n\n  let abortController: AbortController | undefined;\n\n  let searchTimeoutRef: number | undefined;\n\n  let focusedDelayed: boolean;\n\n  let prevIdToFly: string | undefined;\n\n  const missingIconsCache = new Set<string>();\n\n  const dispatch = createEventDispatcher<DispatcherType>();\n\n  $: {\n    reverseActive = enableReverse === \"always\";\n  }\n\n  $: if (\n    pickedResultStyle !== \"marker-only\" &&\n    picked &&\n    !picked.address &&\n    picked.geometry.type === \"Point\" &&\n    picked.place_type[0] !== \"reverse\"\n  ) {\n    search(picked.id, { byId: true }).catch((err) => (error = err));\n  }\n\n  $: {\n    if (mapController && picked && picked.id !== prevIdToFly && flyTo) {\n      if (\n        !picked.bbox ||\n        (picked.bbox[0] === picked.bbox[2] && picked.bbox[1] === picked.bbox[3])\n      ) {\n        mapController.flyTo(picked.center, computeZoom(picked));\n      } else {\n        mapController.fitBounds(\n          unwrapBbox(picked.bbox),\n          50,\n          computeZoom(picked),\n        );\n      }\n\n      listFeatures = undefined;\n      markedFeatures = undefined;\n      selectedItemIndex = -1;\n    }\n\n    prevIdToFly = picked?.id;\n  }\n\n  $: if (mapController && selected && flyTo && flyToSelected) {\n    mapController.flyTo(selected.center, computeZoom(selected));\n  }\n\n  $: showPolygonMarker =\n    pickedResultStyle === \"full-geometry-including-polygon-center-marker\";\n\n  // if markerOnSelected was dynamically changed to false\n  $: if (!markerOnSelected) {\n    mapController?.setFeatures(undefined, undefined, showPolygonMarker);\n  }\n\n  $: if (mapController && markerOnSelected && !markedFeatures) {\n    mapController.setFeatures(\n      selected ? [selected] : undefined,\n      undefined,\n      showPolygonMarker,\n    );\n\n    mapController.setSelectedMarker(selected ? 0 : -1);\n  }\n\n  $: if (markedFeatures !== listFeatures) {\n    markedFeatures = undefined;\n  }\n\n  $: if (mapController) {\n    mapController.setFeatures(markedFeatures, picked, showPolygonMarker);\n  }\n\n  $: if (searchValue.length < minLength) {\n    picked = undefined;\n    listFeatures = undefined;\n    error = undefined;\n    markedFeatures = listFeatures;\n  }\n\n  // highlight selected marker\n  $: if (markedFeatures && mapController) {\n    mapController.setSelectedMarker(selectedItemIndex);\n  }\n\n  // close dropdown in the next cycle so that the selected item event has the chance to fire\n  $: setTimeout(() => {\n    focusedDelayed = focused;\n\n    if (clearOnBlur && !focused) {\n      searchValue = \"\";\n    }\n  });\n\n  $: if (selectFirst && listFeatures?.length) {\n    selectedItemIndex = 0;\n  }\n\n  // clear selection on edit\n  $: {\n    // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n    searchValue;\n\n    selectedItemIndex = -1;\n  }\n\n  $: selected = listFeatures?.[selectedItemIndex];\n\n  $: if (mapController) {\n    const coords = isQueryReverse(searchValue);\n\n    mapController.setReverseMarker(\n      coords ? [coords.decimalLongitude, coords.decimalLatitude] : undefined,\n    );\n  }\n\n  $: dispatch(\"select\", { feature: selected });\n\n  $: dispatch(\"pick\", { feature: picked });\n\n  $: dispatch(\"optionsvisibilitychange\", {\n    optionsVisible: focusedDelayed && !!listFeatures,\n  });\n\n  $: dispatch(\"featureslisted\", { features: listFeatures });\n\n  $: dispatch(\"featuresmarked\", { features: markedFeatures });\n\n  $: dispatch(\"reversetoggle\", { reverse: reverseActive });\n\n  $: dispatch(\"querychange\", { query: searchValue });\n\n  $: if (mapController) {\n    mapController.indicateReverse(reverseActive);\n  }\n\n  $: if (mapController) {\n    mapController.setEventHandler((e) => {\n      switch (e.type) {\n        case \"mapClick\":\n          if (reverseActive) {\n            handleReverse(e.coordinates);\n          }\n\n          break;\n        case \"markerClick\":\n          {\n            const feature = listFeatures?.find(\n              (feature) => feature.id === e.id,\n            );\n\n            if (feature) {\n              pick(feature);\n            }\n          }\n\n          break;\n        case \"markerMouseEnter\":\n          if (markedFeatures) {\n            selectedItemIndex = !focusedDelayed\n              ? -1\n              : (listFeatures?.findIndex((feature) => feature.id === e.id) ??\n                -1);\n          }\n\n          break;\n        case \"markerMouseLeave\":\n          if (markedFeatures) {\n            selectedItemIndex = -1;\n          }\n\n          break;\n      }\n    });\n  }\n\n  onDestroy(() => {\n    if (mapController) {\n      mapController.setEventHandler(undefined);\n      mapController.indicateReverse(false);\n      mapController.setSelectedMarker(-1);\n      mapController.setFeatures(undefined, undefined, false);\n    }\n  });\n\n  function handleOnSubmit(event?: unknown) {\n    if (searchTimeoutRef) {\n      clearTimeout(searchTimeoutRef);\n\n      searchTimeoutRef = undefined;\n    }\n\n    if (selectedItemIndex > -1 && listFeatures) {\n      picked = listFeatures[selectedItemIndex];\n\n      searchValue =\n        picked.place_type[0] === \"reverse\"\n          ? picked.place_name\n          : picked.place_name.replace(/,.*/, \"\");\n\n      error = undefined;\n\n      markedFeatures = undefined;\n\n      selectedItemIndex = -1;\n    } else if (searchValue) {\n      const zoomTo = event || !isQueryReverse(searchValue);\n\n      search(searchValue, { exact: true })\n        .then(() => {\n          markedFeatures = listFeatures;\n\n          picked = undefined;\n\n          if (zoomTo) {\n            zoomToResults();\n          }\n        })\n        .catch((err) => (error = err));\n    }\n  }\n\n  function isQueryReverse(searchValue: string) {\n    try {\n      return convert(searchValue, 6);\n    } catch {\n      return false;\n    }\n  }\n\n  async function search(\n    searchValue: string,\n    {\n      byId = false,\n      exact = false,\n    }: undefined | { byId?: boolean; exact?: boolean } = {},\n  ) {\n    error = undefined;\n\n    abortController?.abort();\n\n    const ac = new AbortController();\n\n    abortController = ac;\n\n    try {\n      const isReverse = isQueryReverse(searchValue);\n\n      const sp = new URLSearchParams();\n\n      if (language !== undefined) {\n        sp.set(\n          \"language\",\n          Array.isArray(language) ? language.join(\",\") : (language ?? \"\"),\n        );\n      }\n\n      if (types) {\n        sp.set(\"types\", types.join(\",\"));\n      }\n\n      if (excludeTypes) {\n        sp.set(\"excludeTypes\", String(excludeTypes));\n      }\n\n      if (bbox) {\n        sp.set(\"bbox\", bbox.map((c) => c.toFixed(6)).join(\",\"));\n      }\n\n      if (country) {\n        sp.set(\"country\", Array.isArray(country) ? country.join(\",\") : country);\n      }\n\n      if (!byId && !isReverse) {\n        const coords = await getProximity(mapController, proximity, ac);\n\n        if (coords) {\n          sp.set(\"proximity\", coords);\n        }\n\n        if (exact || !showResultsWhileTyping) {\n          sp.set(\"autocomplete\", \"false\");\n        }\n\n        sp.set(\"fuzzyMatch\", String(fuzzyMatch));\n      }\n\n      if (\n        limit !== undefined &&\n        (exhaustiveReverseGeocoding || !isReverse || types?.length === 1)\n      ) {\n        sp.set(\"limit\", String(limit));\n      }\n\n      sp.set(\"key\", apiKey);\n\n      adjustUrlQuery(sp);\n\n      const url =\n        apiUrl +\n        \"/\" +\n        encodeURIComponent(\n          isReverse\n            ? isReverse.decimalLongitude + \",\" + isReverse.decimalLatitude\n            : searchValue,\n        ) +\n        \".json?\" +\n        sp.toString();\n\n      if (url === lastSearchUrl) {\n        if (byId) {\n          listFeatures = undefined;\n\n          picked = cachedFeatures[0];\n        } else {\n          listFeatures = cachedFeatures;\n        }\n\n        return;\n      }\n\n      lastSearchUrl = url;\n\n      const res = await fetch(url, {\n        signal: ac.signal,\n        ...fetchParameters,\n      });\n\n      if (!res.ok) {\n        throw new Error(await res.text());\n      }\n\n      const featureCollection: FeatureCollection = await res.json();\n\n      dispatch(\"response\", { url, featureCollection });\n\n      if (byId) {\n        listFeatures = undefined;\n\n        picked = featureCollection.features[0];\n\n        cachedFeatures = [picked];\n      } else {\n        listFeatures = featureCollection.features.filter(filter);\n\n        if (isReverse) {\n          listFeatures.unshift({\n            type: \"Feature\",\n            properties: {},\n            id:\n              \"reverse_\" +\n              isReverse.decimalLongitude +\n              \"_\" +\n              isReverse.decimalLatitude,\n            text: isReverse.decimalLatitude + \", \" + isReverse.decimalLongitude,\n            place_name:\n              isReverse.decimalLatitude + \", \" + isReverse.decimalLongitude,\n            place_type: [\"reverse\"],\n            center: [isReverse.decimalLongitude, isReverse.decimalLatitude],\n            bbox: [\n              isReverse.decimalLongitude,\n              isReverse.decimalLatitude,\n              isReverse.decimalLongitude,\n              isReverse.decimalLatitude,\n            ],\n            geometry: {\n              type: \"Point\",\n              coordinates: [\n                isReverse.decimalLongitude,\n                isReverse.decimalLatitude,\n              ],\n            },\n          });\n        }\n\n        cachedFeatures = listFeatures;\n\n        if (isReverse) {\n          input.focus();\n        }\n      }\n    } catch (e) {\n      if (\n        e &&\n        typeof e === \"object\" &&\n        \"name\" in e &&\n        e.name === \"AbortError\"\n      ) {\n        return;\n      }\n\n      throw e;\n    } finally {\n      if (ac === abortController) {\n        abortController = undefined;\n      }\n    }\n  }\n\n  function zoomToResults() {\n    if (!markedFeatures?.length || !flyTo) {\n      return;\n    }\n\n    const bbox: BBox = [180, 90, -180, -90];\n\n    const fuzzyOnly = !markedFeatures.some((feature) => !feature.matching_text);\n\n    let allZoom: number | undefined;\n\n    for (const feature of markedFeatures) {\n      const featZoom = computeZoom(feature);\n\n      allZoom =\n        allZoom === undefined\n          ? featZoom\n          : featZoom === undefined\n            ? allZoom\n            : Math.max(allZoom, featZoom);\n\n      if (fuzzyOnly || !feature.matching_text) {\n        for (const i of [0, 1, 2, 3] as const) {\n          bbox[i] = Math[i < 2 ? \"min\" : \"max\"](\n            bbox[i],\n            feature.bbox?.[i] ?? feature.center[i % 2],\n          );\n        }\n      }\n    }\n\n    if (mapController && markedFeatures.length > 0) {\n      if (picked && bbox[0] === bbox[2] && bbox[1] === bbox[3]) {\n        mapController.flyTo(picked.center, computeZoom(picked));\n      } else {\n        mapController.fitBounds(unwrapBbox(bbox), 50, allZoom);\n      }\n    }\n  }\n\n  function computeZoom(feature: Feature): number | undefined {\n    if (\n      !feature.bbox ||\n      (feature.bbox[0] !== feature.bbox[2] &&\n        feature.bbox[1] !== feature.bbox[3])\n    ) {\n      return undefined;\n    }\n\n    const index = feature.id.replace(/\\..*/, \"\");\n\n    return (\n      (Array.isArray(feature.properties?.categories)\n        ? (feature.properties.categories as string[]).reduce(\n            (a, category) => {\n              const b = zoom[index + \".\" + category];\n\n              return a === undefined ? b : b === undefined ? a : Math.max(a, b);\n            },\n            undefined as undefined | number,\n          )\n        : undefined) ?? zoom[index]\n    );\n  }\n\n  function handleReverse(coordinates: [lng: number, lat: number]) {\n    reverseActive = enableReverse === \"always\";\n\n    listFeatures = undefined;\n    picked = undefined;\n    selectedItemIndex = -1;\n\n    setQuery(\n      coordinates[1].toFixed(6) +\n        \", \" +\n        wrapNum(coordinates[0], [-180, 180], true).toFixed(6),\n      false,\n      true,\n    );\n  }\n\n  function handleKeyDown(e: KeyboardEvent) {\n    if (!listFeatures) {\n      return;\n    }\n\n    let dir = e.key === \"ArrowDown\" ? 1 : e.key === \"ArrowUp\" ? -1 : 0;\n\n    if (dir) {\n      if (selectedItemIndex === (selectFirst ? 0 : -1) && dir === -1) {\n        selectedItemIndex = listFeatures.length;\n      }\n\n      selectedItemIndex += dir;\n\n      if (selectedItemIndex >= listFeatures.length) {\n        selectedItemIndex = -1;\n      }\n\n      if (selectedItemIndex < 0 && selectFirst) {\n        selectedItemIndex = 0;\n      }\n\n      e.preventDefault();\n    }\n  }\n\n  function handleInput(debounce = true, reverse = false) {\n    error = undefined;\n\n    if (showResultsWhileTyping || reverse) {\n      if (searchTimeoutRef) {\n        clearTimeout(searchTimeoutRef);\n      }\n\n      if (searchValue.length < minLength) {\n        return;\n      }\n\n      const sv = searchValue;\n\n      searchTimeoutRef = window.setTimeout(\n        () => {\n          search(sv).catch((err) => (error = err));\n        },\n        debounce ? debounceSearch : 0,\n      );\n    } else {\n      listFeatures = undefined;\n      error = undefined;\n    }\n  }\n\n  function pick(feature: Feature) {\n    picked = feature;\n    searchValue = feature.place_name;\n    selectedItemIndex = -1;\n  }\n</script>\n\n{#if false}\n  <!-- This workaround is just to use marker styles. Bug in svlete/vite? Investigate. -->\n  <MarkerIcon displayIn=\"list\" />\n{/if}\n\n<!-- svelte-ignore a11y-no-noninteractive-tabindex -->\n<form\n  tabindex=\"0\"\n  on:submit|preventDefault={handleOnSubmit}\n  class:can-collapse={collapsed && searchValue === \"\"}\n  class={className}\n>\n  <div class=\"input-group\">\n    <button class=\"search-button\" type=\"button\" on:click={() => input.focus()}>\n      <SearchIcon />\n    </button>\n\n    <input\n      bind:this={input}\n      bind:value={searchValue}\n      on:focus={() => (focused = true)}\n      on:blur={() => (focused = false)}\n      on:keydown={handleKeyDown}\n      on:input={() => handleInput()}\n      {placeholder}\n      aria-label={placeholder}\n    />\n\n    <div class=\"clear-button-container\" class:displayable={searchValue !== \"\"}>\n      <button\n        type=\"button\"\n        on:click={() => {\n          searchValue = \"\";\n          input.focus();\n        }}\n        title={clearButtonTitle}\n      >\n        <ClearIcon />\n      </button>\n\n      {#if abortController}\n        <LoadingIcon />\n      {/if}\n    </div>\n\n    {#if enableReverse === \"button\"}\n      <button\n        type=\"button\"\n        class:active={reverseActive}\n        title={reverseButtonTitle}\n        on:click={() => (reverseActive = !reverseActive)}\n      >\n        <ReverseGeocodingIcon />\n      </button>\n    {/if}\n\n    <slot />\n  </div>\n\n  {#if error}\n    <div class=\"error\">\n      <FailIcon />\n\n      <div>{errorMessage}</div>\n\n      <button on:click={() => (error = undefined)}>\n        <ClearIcon />\n      </button>\n    </div>\n  {:else if !focusedDelayed}\n    {\"\"}\n  {:else if listFeatures?.length === 0}\n    <div class=\"no-results\">\n      <FailIcon />\n\n      <div>{noResultsMessage}</div>\n    </div>\n  {:else if focusedDelayed && listFeatures?.length}\n    <ul\n      class=\"options\"\n      on:mouseleave={() => {\n        if (!selectFirst) {\n          selectedItemIndex = -1;\n        }\n      }}\n      on:blur={() => undefined}\n    >\n      {#each listFeatures as feature, i (feature.id + (feature.address ? \",\" + feature.address : \"\"))}\n        <FeatureItem\n          {feature}\n          {showPlaceType}\n          selected={selectedItemIndex === i}\n          on:mouseenter={() => (selectedItemIndex = i)}\n          on:focus={() => pick(feature)}\n          {missingIconsCache}\n          {iconsBaseUrl}\n        />\n      {/each}\n    </ul>\n  {/if}\n</form>\n\n<style lang=\"scss\">\n  form {\n    font-family: \"Open Sans\", \"Ubuntu\", \"Helvetica Neue\", Arial, Helvetica,\n      sans-serif;\n    position: relative;\n    background-color: #fff;\n    z-index: 10;\n    border-radius: 4px;\n    margin: 0;\n    transition: max-width 0.25s;\n    box-shadow: 0px 2px 5px rgba(51, 51, 89, 0.15);\n    --color-text: #444952;\n    --color-icon-button: #444952;\n\n    &,\n    & *,\n    & *:after,\n    & *:before {\n      box-sizing: border-box;\n    }\n\n    &.can-collapse {\n      max-width: 29px;\n\n      & input::placeholder {\n        transition: opacity 0.25s;\n        opacity: 0;\n      }\n    }\n\n    &,\n    &:focus-within,\n    &:hover {\n      width: 270px;\n      max-width: 270px;\n\n      & input::placeholder {\n        opacity: 1;\n      }\n    }\n  }\n\n  input {\n    font: inherit;\n    font-size: 14px;\n    flex-grow: 1;\n    min-height: 29px;\n    background-color: transparent;\n    color: #444952;\n    white-space: nowrap;\n    overflow: hidden;\n    border: 0;\n    margin: 0;\n    padding: 0;\n\n    &:focus {\n      color: #444952;\n      outline: 0;\n      outline: none;\n      box-shadow: none;\n    }\n  }\n\n  ul,\n  div.error,\n  div.no-results {\n    background-color: #fff;\n    border-radius: 4px;\n    left: 0;\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    position: absolute;\n    width: 100%;\n    top: calc(100% + 6px);\n    overflow: hidden;\n  }\n\n  ul {\n    font-size: 14px;\n    line-height: 16px;\n    box-shadow: 0px 5px 10px rgba(51, 51, 89, 0.15);\n  }\n\n  div.error,\n  div.no-results {\n    font: inherit;\n    line-height: 18px;\n    font-size: 12px;\n    display: flex;\n    gap: 16px;\n  }\n\n  div.error {\n    padding: 16px;\n    font-weight: 600;\n    color: #e25041;\n    background-color: #fbeae8;\n\n    div {\n      flex-grow: 1;\n    }\n\n    :global(svg) {\n      flex-shrink: 0;\n      width: 20px;\n      height: 20px;\n    }\n\n    button {\n      flex-shrink: 0;\n      & > :global(svg) {\n        width: 13px;\n        fill: #e25041;\n      }\n\n      &:hover :global(svg),\n      &:active :global(svg) {\n        fill: #444952;\n      }\n    }\n  }\n\n  div.no-results {\n    padding: 14px 24px 14px 16px;\n    font-weight: 400;\n    color: #6b7c93;\n    box-shadow: 0px 5px 10px rgba(51, 51, 89, 0.15);\n\n    :global(svg) {\n      margin-top: 4px;\n      flex-shrink: 0;\n      width: 20px;\n      height: 20px;\n      width: 30px;\n      height: 30px;\n    }\n  }\n\n  :global(.leaflet-bottom) ul.options,\n  :global(.maplibregl-ctrl-bottom-left) ul.options,\n  :global(.maplibregl-ctrl-bottom-right) ul.options {\n    top: auto;\n    bottom: calc(100% + 6px);\n  }\n\n  button {\n    padding: 0;\n    margin: 0;\n    border: 0;\n    background-color: transparent;\n    height: auto;\n    width: auto;\n\n    &:hover {\n      background-color: transparent;\n    }\n  }\n\n  button:hover :global(svg),\n  button:active :global(svg) {\n    fill: #2b8bfb;\n  }\n\n  .input-group {\n    display: flex;\n    align-items: stretch;\n    gap: 7px;\n    padding-inline: 8px;\n    border-radius: 4px;\n    overflow: hidden;\n\n    &:focus-within {\n      outline: #2b8bfb solid 2px;\n    }\n  }\n\n  .search-button {\n    flex-shrink: 0;\n  }\n\n  :global(.maplibregl-ctrl-geocoder:not(.maptiler-ctrl) .search-button svg) {\n    width: 12px !important;\n    transform: translate(0.5px, 0);\n  }\n\n  .clear-button-container {\n    display: flex;\n    display: none;\n    position: relative;\n    align-items: stretch;\n\n    &.displayable {\n      display: flex;\n      flex-shrink: 0;\n    }\n  }\n\n  :global(.maplibregl-ctrl-geocoder) {\n    position: relative;\n    z-index: 3;\n  }\n\n  :global(.maptiler-ctrl) {\n    &:not(:empty) {\n      box-shadow: none;\n    }\n\n    & .input-group {\n      padding-inline: 8px;\n      border: white solid 2px;\n\n      &:focus-within {\n        border: #2b8bfb solid 2px;\n        outline: 0;\n        outline: none;\n      }\n    }\n\n    & form {\n      &.can-collapse {\n        max-width: 33px;\n      }\n\n      &,\n      &:focus-within,\n      &:hover {\n        width: 270px;\n        max-width: 270px;\n      }\n    }\n  }\n</style>\n","// index.ts\nvar earthRadius = 63710088e-1;\nvar factors = {\n  centimeters: earthRadius * 100,\n  centimetres: earthRadius * 100,\n  degrees: 360 / (2 * Math.PI),\n  feet: earthRadius * 3.28084,\n  inches: earthRadius * 39.37,\n  kilometers: earthRadius / 1e3,\n  kilometres: earthRadius / 1e3,\n  meters: earthRadius,\n  metres: earthRadius,\n  miles: earthRadius / 1609.344,\n  millimeters: earthRadius * 1e3,\n  millimetres: earthRadius * 1e3,\n  nauticalmiles: earthRadius / 1852,\n  radians: 1,\n  yards: earthRadius * 1.0936\n};\nvar areaFactors = {\n  acres: 247105e-9,\n  centimeters: 1e4,\n  centimetres: 1e4,\n  feet: 10.763910417,\n  hectares: 1e-4,\n  inches: 1550.003100006,\n  kilometers: 1e-6,\n  kilometres: 1e-6,\n  meters: 1,\n  metres: 1,\n  miles: 386e-9,\n  nauticalmiles: 29155334959812285e-23,\n  millimeters: 1e6,\n  millimetres: 1e6,\n  yards: 1.195990046\n};\nfunction feature(geom, properties, options = {}) {\n  const feat = { type: \"Feature\" };\n  if (options.id === 0 || options.id) {\n    feat.id = options.id;\n  }\n  if (options.bbox) {\n    feat.bbox = options.bbox;\n  }\n  feat.properties = properties || {};\n  feat.geometry = geom;\n  return feat;\n}\nfunction geometry(type, coordinates, _options = {}) {\n  switch (type) {\n    case \"Point\":\n      return point(coordinates).geometry;\n    case \"LineString\":\n      return lineString(coordinates).geometry;\n    case \"Polygon\":\n      return polygon(coordinates).geometry;\n    case \"MultiPoint\":\n      return multiPoint(coordinates).geometry;\n    case \"MultiLineString\":\n      return multiLineString(coordinates).geometry;\n    case \"MultiPolygon\":\n      return multiPolygon(coordinates).geometry;\n    default:\n      throw new Error(type + \" is invalid\");\n  }\n}\nfunction point(coordinates, properties, options = {}) {\n  if (!coordinates) {\n    throw new Error(\"coordinates is required\");\n  }\n  if (!Array.isArray(coordinates)) {\n    throw new Error(\"coordinates must be an Array\");\n  }\n  if (coordinates.length < 2) {\n    throw new Error(\"coordinates must be at least 2 numbers long\");\n  }\n  if (!isNumber(coordinates[0]) || !isNumber(coordinates[1])) {\n    throw new Error(\"coordinates must contain numbers\");\n  }\n  const geom = {\n    type: \"Point\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction points(coordinates, properties, options = {}) {\n  return featureCollection(\n    coordinates.map((coords) => {\n      return point(coords, properties);\n    }),\n    options\n  );\n}\nfunction polygon(coordinates, properties, options = {}) {\n  for (const ring of coordinates) {\n    if (ring.length < 4) {\n      throw new Error(\n        \"Each LinearRing of a Polygon must have 4 or more Positions.\"\n      );\n    }\n    if (ring[ring.length - 1].length !== ring[0].length) {\n      throw new Error(\"First and last Position are not equivalent.\");\n    }\n    for (let j = 0; j < ring[ring.length - 1].length; j++) {\n      if (ring[ring.length - 1][j] !== ring[0][j]) {\n        throw new Error(\"First and last Position are not equivalent.\");\n      }\n    }\n  }\n  const geom = {\n    type: \"Polygon\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction polygons(coordinates, properties, options = {}) {\n  return featureCollection(\n    coordinates.map((coords) => {\n      return polygon(coords, properties);\n    }),\n    options\n  );\n}\nfunction lineString(coordinates, properties, options = {}) {\n  if (coordinates.length < 2) {\n    throw new Error(\"coordinates must be an array of two or more positions\");\n  }\n  const geom = {\n    type: \"LineString\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction lineStrings(coordinates, properties, options = {}) {\n  return featureCollection(\n    coordinates.map((coords) => {\n      return lineString(coords, properties);\n    }),\n    options\n  );\n}\nfunction featureCollection(features, options = {}) {\n  const fc = { type: \"FeatureCollection\" };\n  if (options.id) {\n    fc.id = options.id;\n  }\n  if (options.bbox) {\n    fc.bbox = options.bbox;\n  }\n  fc.features = features;\n  return fc;\n}\nfunction multiLineString(coordinates, properties, options = {}) {\n  const geom = {\n    type: \"MultiLineString\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction multiPoint(coordinates, properties, options = {}) {\n  const geom = {\n    type: \"MultiPoint\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction multiPolygon(coordinates, properties, options = {}) {\n  const geom = {\n    type: \"MultiPolygon\",\n    coordinates\n  };\n  return feature(geom, properties, options);\n}\nfunction geometryCollection(geometries, properties, options = {}) {\n  const geom = {\n    type: \"GeometryCollection\",\n    geometries\n  };\n  return feature(geom, properties, options);\n}\nfunction round(num, precision = 0) {\n  if (precision && !(precision >= 0)) {\n    throw new Error(\"precision must be a positive number\");\n  }\n  const multiplier = Math.pow(10, precision || 0);\n  return Math.round(num * multiplier) / multiplier;\n}\nfunction radiansToLength(radians, units = \"kilometers\") {\n  const factor = factors[units];\n  if (!factor) {\n    throw new Error(units + \" units is invalid\");\n  }\n  return radians * factor;\n}\nfunction lengthToRadians(distance, units = \"kilometers\") {\n  const factor = factors[units];\n  if (!factor) {\n    throw new Error(units + \" units is invalid\");\n  }\n  return distance / factor;\n}\nfunction lengthToDegrees(distance, units) {\n  return radiansToDegrees(lengthToRadians(distance, units));\n}\nfunction bearingToAzimuth(bearing) {\n  let angle = bearing % 360;\n  if (angle < 0) {\n    angle += 360;\n  }\n  return angle;\n}\nfunction azimuthToBearing(angle) {\n  angle = angle % 360;\n  if (angle > 0)\n    return angle > 180 ? angle - 360 : angle;\n  return angle < -180 ? angle + 360 : angle;\n}\nfunction radiansToDegrees(radians) {\n  const degrees = radians % (2 * Math.PI);\n  return degrees * 180 / Math.PI;\n}\nfunction degreesToRadians(degrees) {\n  const radians = degrees % 360;\n  return radians * Math.PI / 180;\n}\nfunction convertLength(length, originalUnit = \"kilometers\", finalUnit = \"kilometers\") {\n  if (!(length >= 0)) {\n    throw new Error(\"length must be a positive number\");\n  }\n  return radiansToLength(lengthToRadians(length, originalUnit), finalUnit);\n}\nfunction convertArea(area, originalUnit = \"meters\", finalUnit = \"kilometers\") {\n  if (!(area >= 0)) {\n    throw new Error(\"area must be a positive number\");\n  }\n  const startFactor = areaFactors[originalUnit];\n  if (!startFactor) {\n    throw new Error(\"invalid original units\");\n  }\n  const finalFactor = areaFactors[finalUnit];\n  if (!finalFactor) {\n    throw new Error(\"invalid final units\");\n  }\n  return area / startFactor * finalFactor;\n}\nfunction isNumber(num) {\n  return !isNaN(num) && num !== null && !Array.isArray(num);\n}\nfunction isObject(input) {\n  return input !== null && typeof input === \"object\" && !Array.isArray(input);\n}\nfunction validateBBox(bbox) {\n  if (!bbox) {\n    throw new Error(\"bbox is required\");\n  }\n  if (!Array.isArray(bbox)) {\n    throw new Error(\"bbox must be an Array\");\n  }\n  if (bbox.length !== 4 && bbox.length !== 6) {\n    throw new Error(\"bbox must be an Array of 4 or 6 numbers\");\n  }\n  bbox.forEach((num) => {\n    if (!isNumber(num)) {\n      throw new Error(\"bbox must only contain numbers\");\n    }\n  });\n}\nfunction validateId(id) {\n  if (!id) {\n    throw new Error(\"id is required\");\n  }\n  if ([\"string\", \"number\"].indexOf(typeof id) === -1) {\n    throw new Error(\"id must be a number or a string\");\n  }\n}\nexport {\n  areaFactors,\n  azimuthToBearing,\n  bearingToAzimuth,\n  convertArea,\n  convertLength,\n  degreesToRadians,\n  earthRadius,\n  factors,\n  feature,\n  featureCollection,\n  geometry,\n  geometryCollection,\n  isNumber,\n  isObject,\n  lengthToDegrees,\n  lengthToRadians,\n  lineString,\n  lineStrings,\n  multiLineString,\n  multiPoint,\n  multiPolygon,\n  point,\n  points,\n  polygon,\n  polygons,\n  radiansToDegrees,\n  radiansToLength,\n  round,\n  validateBBox,\n  validateId\n};\n//# sourceMappingURL=index.js.map","/**\n * splaytree v3.1.2\n * Fast Splay tree for Node and browser\n *\n * @author Alexander Milevski <info@w8r.name>\n * @license MIT\n * @preserve\n */\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\n\nvar Node = /** @class */ (function () {\r\n    function Node(key, data) {\r\n        this.next = null;\r\n        this.key = key;\r\n        this.data = data;\r\n        this.left = null;\r\n        this.right = null;\r\n    }\r\n    return Node;\r\n}());\n\n/* follows \"An implementation of top-down splaying\"\r\n * by D. Sleator <sleator@cs.cmu.edu> March 1992\r\n */\r\nfunction DEFAULT_COMPARE(a, b) {\r\n    return a > b ? 1 : a < b ? -1 : 0;\r\n}\r\n/**\r\n * Simple top down splay, not requiring i to be in the tree t.\r\n */\r\nfunction splay(i, t, comparator) {\r\n    var N = new Node(null, null);\r\n    var l = N;\r\n    var r = N;\r\n    while (true) {\r\n        var cmp = comparator(i, t.key);\r\n        //if (i < t.key) {\r\n        if (cmp < 0) {\r\n            if (t.left === null)\r\n                break;\r\n            //if (i < t.left.key) {\r\n            if (comparator(i, t.left.key) < 0) {\r\n                var y = t.left; /* rotate right */\r\n                t.left = y.right;\r\n                y.right = t;\r\n                t = y;\r\n                if (t.left === null)\r\n                    break;\r\n            }\r\n            r.left = t; /* link right */\r\n            r = t;\r\n            t = t.left;\r\n            //} else if (i > t.key) {\r\n        }\r\n        else if (cmp > 0) {\r\n            if (t.right === null)\r\n                break;\r\n            //if (i > t.right.key) {\r\n            if (comparator(i, t.right.key) > 0) {\r\n                var y = t.right; /* rotate left */\r\n                t.right = y.left;\r\n                y.left = t;\r\n                t = y;\r\n                if (t.right === null)\r\n                    break;\r\n            }\r\n            l.right = t; /* link left */\r\n            l = t;\r\n            t = t.right;\r\n        }\r\n        else\r\n            break;\r\n    }\r\n    /* assemble */\r\n    l.right = t.left;\r\n    r.left = t.right;\r\n    t.left = N.right;\r\n    t.right = N.left;\r\n    return t;\r\n}\r\nfunction insert(i, data, t, comparator) {\r\n    var node = new Node(i, data);\r\n    if (t === null) {\r\n        node.left = node.right = null;\r\n        return node;\r\n    }\r\n    t = splay(i, t, comparator);\r\n    var cmp = comparator(i, t.key);\r\n    if (cmp < 0) {\r\n        node.left = t.left;\r\n        node.right = t;\r\n        t.left = null;\r\n    }\r\n    else if (cmp >= 0) {\r\n        node.right = t.right;\r\n        node.left = t;\r\n        t.right = null;\r\n    }\r\n    return node;\r\n}\r\nfunction split(key, v, comparator) {\r\n    var left = null;\r\n    var right = null;\r\n    if (v) {\r\n        v = splay(key, v, comparator);\r\n        var cmp = comparator(v.key, key);\r\n        if (cmp === 0) {\r\n            left = v.left;\r\n            right = v.right;\r\n        }\r\n        else if (cmp < 0) {\r\n            right = v.right;\r\n            v.right = null;\r\n            left = v;\r\n        }\r\n        else {\r\n            left = v.left;\r\n            v.left = null;\r\n            right = v;\r\n        }\r\n    }\r\n    return { left: left, right: right };\r\n}\r\nfunction merge(left, right, comparator) {\r\n    if (right === null)\r\n        return left;\r\n    if (left === null)\r\n        return right;\r\n    right = splay(left.key, right, comparator);\r\n    right.left = left;\r\n    return right;\r\n}\r\n/**\r\n * Prints level of the tree\r\n */\r\nfunction printRow(root, prefix, isTail, out, printNode) {\r\n    if (root) {\r\n        out(\"\" + prefix + (isTail ? ' ' : ' ') + printNode(root) + \"\\n\");\r\n        var indent = prefix + (isTail ? '    ' : '   ');\r\n        if (root.left)\r\n            printRow(root.left, indent, false, out, printNode);\r\n        if (root.right)\r\n            printRow(root.right, indent, true, out, printNode);\r\n    }\r\n}\r\nvar Tree = /** @class */ (function () {\r\n    function Tree(comparator) {\r\n        if (comparator === void 0) { comparator = DEFAULT_COMPARE; }\r\n        this._root = null;\r\n        this._size = 0;\r\n        this._comparator = comparator;\r\n    }\r\n    /**\r\n     * Inserts a key, allows duplicates\r\n     */\r\n    Tree.prototype.insert = function (key, data) {\r\n        this._size++;\r\n        return this._root = insert(key, data, this._root, this._comparator);\r\n    };\r\n    /**\r\n     * Adds a key, if it is not present in the tree\r\n     */\r\n    Tree.prototype.add = function (key, data) {\r\n        var node = new Node(key, data);\r\n        if (this._root === null) {\r\n            node.left = node.right = null;\r\n            this._size++;\r\n            this._root = node;\r\n        }\r\n        var comparator = this._comparator;\r\n        var t = splay(key, this._root, comparator);\r\n        var cmp = comparator(key, t.key);\r\n        if (cmp === 0)\r\n            this._root = t;\r\n        else {\r\n            if (cmp < 0) {\r\n                node.left = t.left;\r\n                node.right = t;\r\n                t.left = null;\r\n            }\r\n            else if (cmp > 0) {\r\n                node.right = t.right;\r\n                node.left = t;\r\n                t.right = null;\r\n            }\r\n            this._size++;\r\n            this._root = node;\r\n        }\r\n        return this._root;\r\n    };\r\n    /**\r\n     * @param  {Key} key\r\n     * @return {Node|null}\r\n     */\r\n    Tree.prototype.remove = function (key) {\r\n        this._root = this._remove(key, this._root, this._comparator);\r\n    };\r\n    /**\r\n     * Deletes i from the tree if it's there\r\n     */\r\n    Tree.prototype._remove = function (i, t, comparator) {\r\n        var x;\r\n        if (t === null)\r\n            return null;\r\n        t = splay(i, t, comparator);\r\n        var cmp = comparator(i, t.key);\r\n        if (cmp === 0) { /* found it */\r\n            if (t.left === null) {\r\n                x = t.right;\r\n            }\r\n            else {\r\n                x = splay(i, t.left, comparator);\r\n                x.right = t.right;\r\n            }\r\n            this._size--;\r\n            return x;\r\n        }\r\n        return t; /* It wasn't there */\r\n    };\r\n    /**\r\n     * Removes and returns the node with smallest key\r\n     */\r\n    Tree.prototype.pop = function () {\r\n        var node = this._root;\r\n        if (node) {\r\n            while (node.left)\r\n                node = node.left;\r\n            this._root = splay(node.key, this._root, this._comparator);\r\n            this._root = this._remove(node.key, this._root, this._comparator);\r\n            return { key: node.key, data: node.data };\r\n        }\r\n        return null;\r\n    };\r\n    /**\r\n     * Find without splaying\r\n     */\r\n    Tree.prototype.findStatic = function (key) {\r\n        var current = this._root;\r\n        var compare = this._comparator;\r\n        while (current) {\r\n            var cmp = compare(key, current.key);\r\n            if (cmp === 0)\r\n                return current;\r\n            else if (cmp < 0)\r\n                current = current.left;\r\n            else\r\n                current = current.right;\r\n        }\r\n        return null;\r\n    };\r\n    Tree.prototype.find = function (key) {\r\n        if (this._root) {\r\n            this._root = splay(key, this._root, this._comparator);\r\n            if (this._comparator(key, this._root.key) !== 0)\r\n                return null;\r\n        }\r\n        return this._root;\r\n    };\r\n    Tree.prototype.contains = function (key) {\r\n        var current = this._root;\r\n        var compare = this._comparator;\r\n        while (current) {\r\n            var cmp = compare(key, current.key);\r\n            if (cmp === 0)\r\n                return true;\r\n            else if (cmp < 0)\r\n                current = current.left;\r\n            else\r\n                current = current.right;\r\n        }\r\n        return false;\r\n    };\r\n    Tree.prototype.forEach = function (visitor, ctx) {\r\n        var current = this._root;\r\n        var Q = []; /* Initialize stack s */\r\n        var done = false;\r\n        while (!done) {\r\n            if (current !== null) {\r\n                Q.push(current);\r\n                current = current.left;\r\n            }\r\n            else {\r\n                if (Q.length !== 0) {\r\n                    current = Q.pop();\r\n                    visitor.call(ctx, current);\r\n                    current = current.right;\r\n                }\r\n                else\r\n                    done = true;\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * Walk key range from `low` to `high`. Stops if `fn` returns a value.\r\n     */\r\n    Tree.prototype.range = function (low, high, fn, ctx) {\r\n        var Q = [];\r\n        var compare = this._comparator;\r\n        var node = this._root;\r\n        var cmp;\r\n        while (Q.length !== 0 || node) {\r\n            if (node) {\r\n                Q.push(node);\r\n                node = node.left;\r\n            }\r\n            else {\r\n                node = Q.pop();\r\n                cmp = compare(node.key, high);\r\n                if (cmp > 0) {\r\n                    break;\r\n                }\r\n                else if (compare(node.key, low) >= 0) {\r\n                    if (fn.call(ctx, node))\r\n                        return this; // stop if smth is returned\r\n                }\r\n                node = node.right;\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * Returns array of keys\r\n     */\r\n    Tree.prototype.keys = function () {\r\n        var keys = [];\r\n        this.forEach(function (_a) {\r\n            var key = _a.key;\r\n            return keys.push(key);\r\n        });\r\n        return keys;\r\n    };\r\n    /**\r\n     * Returns array of all the data in the nodes\r\n     */\r\n    Tree.prototype.values = function () {\r\n        var values = [];\r\n        this.forEach(function (_a) {\r\n            var data = _a.data;\r\n            return values.push(data);\r\n        });\r\n        return values;\r\n    };\r\n    Tree.prototype.min = function () {\r\n        if (this._root)\r\n            return this.minNode(this._root).key;\r\n        return null;\r\n    };\r\n    Tree.prototype.max = function () {\r\n        if (this._root)\r\n            return this.maxNode(this._root).key;\r\n        return null;\r\n    };\r\n    Tree.prototype.minNode = function (t) {\r\n        if (t === void 0) { t = this._root; }\r\n        if (t)\r\n            while (t.left)\r\n                t = t.left;\r\n        return t;\r\n    };\r\n    Tree.prototype.maxNode = function (t) {\r\n        if (t === void 0) { t = this._root; }\r\n        if (t)\r\n            while (t.right)\r\n                t = t.right;\r\n        return t;\r\n    };\r\n    /**\r\n     * Returns node at given index\r\n     */\r\n    Tree.prototype.at = function (index) {\r\n        var current = this._root;\r\n        var done = false;\r\n        var i = 0;\r\n        var Q = [];\r\n        while (!done) {\r\n            if (current) {\r\n                Q.push(current);\r\n                current = current.left;\r\n            }\r\n            else {\r\n                if (Q.length > 0) {\r\n                    current = Q.pop();\r\n                    if (i === index)\r\n                        return current;\r\n                    i++;\r\n                    current = current.right;\r\n                }\r\n                else\r\n                    done = true;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Tree.prototype.next = function (d) {\r\n        var root = this._root;\r\n        var successor = null;\r\n        if (d.right) {\r\n            successor = d.right;\r\n            while (successor.left)\r\n                successor = successor.left;\r\n            return successor;\r\n        }\r\n        var comparator = this._comparator;\r\n        while (root) {\r\n            var cmp = comparator(d.key, root.key);\r\n            if (cmp === 0)\r\n                break;\r\n            else if (cmp < 0) {\r\n                successor = root;\r\n                root = root.left;\r\n            }\r\n            else\r\n                root = root.right;\r\n        }\r\n        return successor;\r\n    };\r\n    Tree.prototype.prev = function (d) {\r\n        var root = this._root;\r\n        var predecessor = null;\r\n        if (d.left !== null) {\r\n            predecessor = d.left;\r\n            while (predecessor.right)\r\n                predecessor = predecessor.right;\r\n            return predecessor;\r\n        }\r\n        var comparator = this._comparator;\r\n        while (root) {\r\n            var cmp = comparator(d.key, root.key);\r\n            if (cmp === 0)\r\n                break;\r\n            else if (cmp < 0)\r\n                root = root.left;\r\n            else {\r\n                predecessor = root;\r\n                root = root.right;\r\n            }\r\n        }\r\n        return predecessor;\r\n    };\r\n    Tree.prototype.clear = function () {\r\n        this._root = null;\r\n        this._size = 0;\r\n        return this;\r\n    };\r\n    Tree.prototype.toList = function () {\r\n        return toList(this._root);\r\n    };\r\n    /**\r\n     * Bulk-load items. Both array have to be same size\r\n     */\r\n    Tree.prototype.load = function (keys, values, presort) {\r\n        if (values === void 0) { values = []; }\r\n        if (presort === void 0) { presort = false; }\r\n        var size = keys.length;\r\n        var comparator = this._comparator;\r\n        // sort if needed\r\n        if (presort)\r\n            sort(keys, values, 0, size - 1, comparator);\r\n        if (this._root === null) { // empty tree\r\n            this._root = loadRecursive(keys, values, 0, size);\r\n            this._size = size;\r\n        }\r\n        else { // that re-builds the whole tree from two in-order traversals\r\n            var mergedList = mergeLists(this.toList(), createList(keys, values), comparator);\r\n            size = this._size + size;\r\n            this._root = sortedListToBST({ head: mergedList }, 0, size);\r\n        }\r\n        return this;\r\n    };\r\n    Tree.prototype.isEmpty = function () { return this._root === null; };\r\n    Object.defineProperty(Tree.prototype, \"size\", {\r\n        get: function () { return this._size; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Tree.prototype, \"root\", {\r\n        get: function () { return this._root; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Tree.prototype.toString = function (printNode) {\r\n        if (printNode === void 0) { printNode = function (n) { return String(n.key); }; }\r\n        var out = [];\r\n        printRow(this._root, '', true, function (v) { return out.push(v); }, printNode);\r\n        return out.join('');\r\n    };\r\n    Tree.prototype.update = function (key, newKey, newData) {\r\n        var comparator = this._comparator;\r\n        var _a = split(key, this._root, comparator), left = _a.left, right = _a.right;\r\n        if (comparator(key, newKey) < 0) {\r\n            right = insert(newKey, newData, right, comparator);\r\n        }\r\n        else {\r\n            left = insert(newKey, newData, left, comparator);\r\n        }\r\n        this._root = merge(left, right, comparator);\r\n    };\r\n    Tree.prototype.split = function (key) {\r\n        return split(key, this._root, this._comparator);\r\n    };\r\n    Tree.prototype[Symbol.iterator] = function () {\r\n        var current, Q, done;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    current = this._root;\r\n                    Q = [];\r\n                    done = false;\r\n                    _a.label = 1;\r\n                case 1:\r\n                    if (!!done) return [3 /*break*/, 6];\r\n                    if (!(current !== null)) return [3 /*break*/, 2];\r\n                    Q.push(current);\r\n                    current = current.left;\r\n                    return [3 /*break*/, 5];\r\n                case 2:\r\n                    if (!(Q.length !== 0)) return [3 /*break*/, 4];\r\n                    current = Q.pop();\r\n                    return [4 /*yield*/, current];\r\n                case 3:\r\n                    _a.sent();\r\n                    current = current.right;\r\n                    return [3 /*break*/, 5];\r\n                case 4:\r\n                    done = true;\r\n                    _a.label = 5;\r\n                case 5: return [3 /*break*/, 1];\r\n                case 6: return [2 /*return*/];\r\n            }\r\n        });\r\n    };\r\n    return Tree;\r\n}());\r\nfunction loadRecursive(keys, values, start, end) {\r\n    var size = end - start;\r\n    if (size > 0) {\r\n        var middle = start + Math.floor(size / 2);\r\n        var key = keys[middle];\r\n        var data = values[middle];\r\n        var node = new Node(key, data);\r\n        node.left = loadRecursive(keys, values, start, middle);\r\n        node.right = loadRecursive(keys, values, middle + 1, end);\r\n        return node;\r\n    }\r\n    return null;\r\n}\r\nfunction createList(keys, values) {\r\n    var head = new Node(null, null);\r\n    var p = head;\r\n    for (var i = 0; i < keys.length; i++) {\r\n        p = p.next = new Node(keys[i], values[i]);\r\n    }\r\n    p.next = null;\r\n    return head.next;\r\n}\r\nfunction toList(root) {\r\n    var current = root;\r\n    var Q = [];\r\n    var done = false;\r\n    var head = new Node(null, null);\r\n    var p = head;\r\n    while (!done) {\r\n        if (current) {\r\n            Q.push(current);\r\n            current = current.left;\r\n        }\r\n        else {\r\n            if (Q.length > 0) {\r\n                current = p = p.next = Q.pop();\r\n                current = current.right;\r\n            }\r\n            else\r\n                done = true;\r\n        }\r\n    }\r\n    p.next = null; // that'll work even if the tree was empty\r\n    return head.next;\r\n}\r\nfunction sortedListToBST(list, start, end) {\r\n    var size = end - start;\r\n    if (size > 0) {\r\n        var middle = start + Math.floor(size / 2);\r\n        var left = sortedListToBST(list, start, middle);\r\n        var root = list.head;\r\n        root.left = left;\r\n        list.head = list.head.next;\r\n        root.right = sortedListToBST(list, middle + 1, end);\r\n        return root;\r\n    }\r\n    return null;\r\n}\r\nfunction mergeLists(l1, l2, compare) {\r\n    var head = new Node(null, null); // dummy\r\n    var p = head;\r\n    var p1 = l1;\r\n    var p2 = l2;\r\n    while (p1 !== null && p2 !== null) {\r\n        if (compare(p1.key, p2.key) < 0) {\r\n            p.next = p1;\r\n            p1 = p1.next;\r\n        }\r\n        else {\r\n            p.next = p2;\r\n            p2 = p2.next;\r\n        }\r\n        p = p.next;\r\n    }\r\n    if (p1 !== null) {\r\n        p.next = p1;\r\n    }\r\n    else if (p2 !== null) {\r\n        p.next = p2;\r\n    }\r\n    return head.next;\r\n}\r\nfunction sort(keys, values, left, right, compare) {\r\n    if (left >= right)\r\n        return;\r\n    var pivot = keys[(left + right) >> 1];\r\n    var i = left - 1;\r\n    var j = right + 1;\r\n    while (true) {\r\n        do\r\n            i++;\r\n        while (compare(keys[i], pivot) < 0);\r\n        do\r\n            j--;\r\n        while (compare(keys[j], pivot) > 0);\r\n        if (i >= j)\r\n            break;\r\n        var tmp = keys[i];\r\n        keys[i] = keys[j];\r\n        keys[j] = tmp;\r\n        tmp = values[i];\r\n        values[i] = values[j];\r\n        values[j] = tmp;\r\n    }\r\n    sort(keys, values, left, j, compare);\r\n    sort(keys, values, j + 1, right, compare);\r\n}\n\nexport default Tree;\n//# sourceMappingURL=splay.esm.js.map\n","export const epsilon = 1.1102230246251565e-16;\nexport const splitter = 134217729;\nexport const resulterrbound = (3 + 8 * epsilon) * epsilon;\n\n// fast_expansion_sum_zeroelim routine from oritinal code\nexport function sum(elen, e, flen, f, h) {\n    let Q, Qnew, hh, bvirt;\n    let enow = e[0];\n    let fnow = f[0];\n    let eindex = 0;\n    let findex = 0;\n    if ((fnow > enow) === (fnow > -enow)) {\n        Q = enow;\n        enow = e[++eindex];\n    } else {\n        Q = fnow;\n        fnow = f[++findex];\n    }\n    let hindex = 0;\n    if (eindex < elen && findex < flen) {\n        if ((fnow > enow) === (fnow > -enow)) {\n            Qnew = enow + Q;\n            hh = Q - (Qnew - enow);\n            enow = e[++eindex];\n        } else {\n            Qnew = fnow + Q;\n            hh = Q - (Qnew - fnow);\n            fnow = f[++findex];\n        }\n        Q = Qnew;\n        if (hh !== 0) {\n            h[hindex++] = hh;\n        }\n        while (eindex < elen && findex < flen) {\n            if ((fnow > enow) === (fnow > -enow)) {\n                Qnew = Q + enow;\n                bvirt = Qnew - Q;\n                hh = Q - (Qnew - bvirt) + (enow - bvirt);\n                enow = e[++eindex];\n            } else {\n                Qnew = Q + fnow;\n                bvirt = Qnew - Q;\n                hh = Q - (Qnew - bvirt) + (fnow - bvirt);\n                fnow = f[++findex];\n            }\n            Q = Qnew;\n            if (hh !== 0) {\n                h[hindex++] = hh;\n            }\n        }\n    }\n    while (eindex < elen) {\n        Qnew = Q + enow;\n        bvirt = Qnew - Q;\n        hh = Q - (Qnew - bvirt) + (enow - bvirt);\n        enow = e[++eindex];\n        Q = Qnew;\n        if (hh !== 0) {\n            h[hindex++] = hh;\n        }\n    }\n    while (findex < flen) {\n        Qnew = Q + fnow;\n        bvirt = Qnew - Q;\n        hh = Q - (Qnew - bvirt) + (fnow - bvirt);\n        fnow = f[++findex];\n        Q = Qnew;\n        if (hh !== 0) {\n            h[hindex++] = hh;\n        }\n    }\n    if (Q !== 0 || hindex === 0) {\n        h[hindex++] = Q;\n    }\n    return hindex;\n}\n\nexport function sum_three(alen, a, blen, b, clen, c, tmp, out) {\n    return sum(sum(alen, a, blen, b, tmp), tmp, clen, c, out);\n}\n\n// scale_expansion_zeroelim routine from oritinal code\nexport function scale(elen, e, b, h) {\n    let Q, sum, hh, product1, product0;\n    let bvirt, c, ahi, alo, bhi, blo;\n\n    c = splitter * b;\n    bhi = c - (c - b);\n    blo = b - bhi;\n    let enow = e[0];\n    Q = enow * b;\n    c = splitter * enow;\n    ahi = c - (c - enow);\n    alo = enow - ahi;\n    hh = alo * blo - (Q - ahi * bhi - alo * bhi - ahi * blo);\n    let hindex = 0;\n    if (hh !== 0) {\n        h[hindex++] = hh;\n    }\n    for (let i = 1; i < elen; i++) {\n        enow = e[i];\n        product1 = enow * b;\n        c = splitter * enow;\n        ahi = c - (c - enow);\n        alo = enow - ahi;\n        product0 = alo * blo - (product1 - ahi * bhi - alo * bhi - ahi * blo);\n        sum = Q + product0;\n        bvirt = sum - Q;\n        hh = Q - (sum - bvirt) + (product0 - bvirt);\n        if (hh !== 0) {\n            h[hindex++] = hh;\n        }\n        Q = product1 + sum;\n        hh = sum - (Q - product1);\n        if (hh !== 0) {\n            h[hindex++] = hh;\n        }\n    }\n    if (Q !== 0 || hindex === 0) {\n        h[hindex++] = Q;\n    }\n    return hindex;\n}\n\nexport function negate(elen, e) {\n    for (let i = 0; i < elen; i++) e[i] = -e[i];\n    return elen;\n}\n\nexport function estimate(elen, e) {\n    let Q = e[0];\n    for (let i = 1; i < elen; i++) Q += e[i];\n    return Q;\n}\n\nexport function vec(n) {\n    return new Float64Array(n);\n}\n","import {epsilon, splitter, resulterrbound, estimate, vec, sum} from './util.js';\n\nconst ccwerrboundA = (3 + 16 * epsilon) * epsilon;\nconst ccwerrboundB = (2 + 12 * epsilon) * epsilon;\nconst ccwerrboundC = (9 + 64 * epsilon) * epsilon * epsilon;\n\nconst B = vec(4);\nconst C1 = vec(8);\nconst C2 = vec(12);\nconst D = vec(16);\nconst u = vec(4);\n\nfunction orient2dadapt(ax, ay, bx, by, cx, cy, detsum) {\n    let acxtail, acytail, bcxtail, bcytail;\n    let bvirt, c, ahi, alo, bhi, blo, _i, _j, _0, s1, s0, t1, t0, u3;\n\n    const acx = ax - cx;\n    const bcx = bx - cx;\n    const acy = ay - cy;\n    const bcy = by - cy;\n\n    s1 = acx * bcy;\n    c = splitter * acx;\n    ahi = c - (c - acx);\n    alo = acx - ahi;\n    c = splitter * bcy;\n    bhi = c - (c - bcy);\n    blo = bcy - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = acy * bcx;\n    c = splitter * acy;\n    ahi = c - (c - acy);\n    alo = acy - ahi;\n    c = splitter * bcx;\n    bhi = c - (c - bcx);\n    blo = bcx - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    B[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    B[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    B[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    B[3] = u3;\n\n    let det = estimate(4, B);\n    let errbound = ccwerrboundB * detsum;\n    if (det >= errbound || -det >= errbound) {\n        return det;\n    }\n\n    bvirt = ax - acx;\n    acxtail = ax - (acx + bvirt) + (bvirt - cx);\n    bvirt = bx - bcx;\n    bcxtail = bx - (bcx + bvirt) + (bvirt - cx);\n    bvirt = ay - acy;\n    acytail = ay - (acy + bvirt) + (bvirt - cy);\n    bvirt = by - bcy;\n    bcytail = by - (bcy + bvirt) + (bvirt - cy);\n\n    if (acxtail === 0 && acytail === 0 && bcxtail === 0 && bcytail === 0) {\n        return det;\n    }\n\n    errbound = ccwerrboundC * detsum + resulterrbound * Math.abs(det);\n    det += (acx * bcytail + bcy * acxtail) - (acy * bcxtail + bcx * acytail);\n    if (det >= errbound || -det >= errbound) return det;\n\n    s1 = acxtail * bcy;\n    c = splitter * acxtail;\n    ahi = c - (c - acxtail);\n    alo = acxtail - ahi;\n    c = splitter * bcy;\n    bhi = c - (c - bcy);\n    blo = bcy - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = acytail * bcx;\n    c = splitter * acytail;\n    ahi = c - (c - acytail);\n    alo = acytail - ahi;\n    c = splitter * bcx;\n    bhi = c - (c - bcx);\n    blo = bcx - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    u[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    u[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    u[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    u[3] = u3;\n    const C1len = sum(4, B, 4, u, C1);\n\n    s1 = acx * bcytail;\n    c = splitter * acx;\n    ahi = c - (c - acx);\n    alo = acx - ahi;\n    c = splitter * bcytail;\n    bhi = c - (c - bcytail);\n    blo = bcytail - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = acy * bcxtail;\n    c = splitter * acy;\n    ahi = c - (c - acy);\n    alo = acy - ahi;\n    c = splitter * bcxtail;\n    bhi = c - (c - bcxtail);\n    blo = bcxtail - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    u[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    u[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    u[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    u[3] = u3;\n    const C2len = sum(C1len, C1, 4, u, C2);\n\n    s1 = acxtail * bcytail;\n    c = splitter * acxtail;\n    ahi = c - (c - acxtail);\n    alo = acxtail - ahi;\n    c = splitter * bcytail;\n    bhi = c - (c - bcytail);\n    blo = bcytail - bhi;\n    s0 = alo * blo - (s1 - ahi * bhi - alo * bhi - ahi * blo);\n    t1 = acytail * bcxtail;\n    c = splitter * acytail;\n    ahi = c - (c - acytail);\n    alo = acytail - ahi;\n    c = splitter * bcxtail;\n    bhi = c - (c - bcxtail);\n    blo = bcxtail - bhi;\n    t0 = alo * blo - (t1 - ahi * bhi - alo * bhi - ahi * blo);\n    _i = s0 - t0;\n    bvirt = s0 - _i;\n    u[0] = s0 - (_i + bvirt) + (bvirt - t0);\n    _j = s1 + _i;\n    bvirt = _j - s1;\n    _0 = s1 - (_j - bvirt) + (_i - bvirt);\n    _i = _0 - t1;\n    bvirt = _0 - _i;\n    u[1] = _0 - (_i + bvirt) + (bvirt - t1);\n    u3 = _j + _i;\n    bvirt = u3 - _j;\n    u[2] = _j - (u3 - bvirt) + (_i - bvirt);\n    u[3] = u3;\n    const Dlen = sum(C2len, C2, 4, u, D);\n\n    return D[Dlen - 1];\n}\n\nexport function orient2d(ax, ay, bx, by, cx, cy) {\n    const detleft = (ay - cy) * (bx - cx);\n    const detright = (ax - cx) * (by - cy);\n    const det = detleft - detright;\n\n    const detsum = Math.abs(detleft + detright);\n    if (Math.abs(det) >= ccwerrboundA * detsum) return det;\n\n    return -orient2dadapt(ax, ay, bx, by, cx, cy, detsum);\n}\n\nexport function orient2dfast(ax, ay, bx, by, cx, cy) {\n    return (ay - cy) * (bx - cx) - (ax - cx) * (by - cy);\n}\n","import SplayTree from 'splaytree';\nimport { orient2d } from 'robust-predicates';\n\n/**\n * A bounding box has the format:\n *\n *  { ll: { x: xmin, y: ymin }, ur: { x: xmax, y: ymax } }\n *\n */\n\nconst isInBbox = (bbox, point) => {\n  return bbox.ll.x <= point.x && point.x <= bbox.ur.x && bbox.ll.y <= point.y && point.y <= bbox.ur.y;\n};\n\n/* Returns either null, or a bbox (aka an ordered pair of points)\n * If there is only one point of overlap, a bbox with identical points\n * will be returned */\nconst getBboxOverlap = (b1, b2) => {\n  // check if the bboxes overlap at all\n  if (b2.ur.x < b1.ll.x || b1.ur.x < b2.ll.x || b2.ur.y < b1.ll.y || b1.ur.y < b2.ll.y) return null;\n\n  // find the middle two X values\n  const lowerX = b1.ll.x < b2.ll.x ? b2.ll.x : b1.ll.x;\n  const upperX = b1.ur.x < b2.ur.x ? b1.ur.x : b2.ur.x;\n\n  // find the middle two Y values\n  const lowerY = b1.ll.y < b2.ll.y ? b2.ll.y : b1.ll.y;\n  const upperY = b1.ur.y < b2.ur.y ? b1.ur.y : b2.ur.y;\n\n  // put those middle values together to get the overlap\n  return {\n    ll: {\n      x: lowerX,\n      y: lowerY\n    },\n    ur: {\n      x: upperX,\n      y: upperY\n    }\n  };\n};\n\n/* Javascript doesn't do integer math. Everything is\n * floating point with percision Number.EPSILON.\n *\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/EPSILON\n */\n\nlet epsilon = Number.EPSILON;\n\n// IE Polyfill\nif (epsilon === undefined) epsilon = Math.pow(2, -52);\nconst EPSILON_SQ = epsilon * epsilon;\n\n/* FLP comparator */\nconst cmp = (a, b) => {\n  // check if they're both 0\n  if (-epsilon < a && a < epsilon) {\n    if (-epsilon < b && b < epsilon) {\n      return 0;\n    }\n  }\n\n  // check if they're flp equal\n  const ab = a - b;\n  if (ab * ab < EPSILON_SQ * a * b) {\n    return 0;\n  }\n\n  // normal comparison\n  return a < b ? -1 : 1;\n};\n\n/**\n * This class rounds incoming values sufficiently so that\n * floating points problems are, for the most part, avoided.\n *\n * Incoming points are have their x & y values tested against\n * all previously seen x & y values. If either is 'too close'\n * to a previously seen value, it's value is 'snapped' to the\n * previously seen value.\n *\n * All points should be rounded by this class before being\n * stored in any data structures in the rest of this algorithm.\n */\n\nclass PtRounder {\n  constructor() {\n    this.reset();\n  }\n  reset() {\n    this.xRounder = new CoordRounder();\n    this.yRounder = new CoordRounder();\n  }\n  round(x, y) {\n    return {\n      x: this.xRounder.round(x),\n      y: this.yRounder.round(y)\n    };\n  }\n}\nclass CoordRounder {\n  constructor() {\n    this.tree = new SplayTree();\n    // preseed with 0 so we don't end up with values < Number.EPSILON\n    this.round(0);\n  }\n\n  // Note: this can rounds input values backwards or forwards.\n  //       You might ask, why not restrict this to just rounding\n  //       forwards? Wouldn't that allow left endpoints to always\n  //       remain left endpoints during splitting (never change to\n  //       right). No - it wouldn't, because we snap intersections\n  //       to endpoints (to establish independence from the segment\n  //       angle for t-intersections).\n  round(coord) {\n    const node = this.tree.add(coord);\n    const prevNode = this.tree.prev(node);\n    if (prevNode !== null && cmp(node.key, prevNode.key) === 0) {\n      this.tree.remove(coord);\n      return prevNode.key;\n    }\n    const nextNode = this.tree.next(node);\n    if (nextNode !== null && cmp(node.key, nextNode.key) === 0) {\n      this.tree.remove(coord);\n      return nextNode.key;\n    }\n    return coord;\n  }\n}\n\n// singleton available by import\nconst rounder = new PtRounder();\n\n/* Cross Product of two vectors with first point at origin */\nconst crossProduct = (a, b) => a.x * b.y - a.y * b.x;\n\n/* Dot Product of two vectors with first point at origin */\nconst dotProduct = (a, b) => a.x * b.x + a.y * b.y;\n\n/* Comparator for two vectors with same starting point */\nconst compareVectorAngles = (basePt, endPt1, endPt2) => {\n  const res = orient2d(basePt.x, basePt.y, endPt1.x, endPt1.y, endPt2.x, endPt2.y);\n  if (res > 0) return -1;\n  if (res < 0) return 1;\n  return 0;\n};\nconst length = v => Math.sqrt(dotProduct(v, v));\n\n/* Get the sine of the angle from pShared -> pAngle to pShaed -> pBase */\nconst sineOfAngle = (pShared, pBase, pAngle) => {\n  const vBase = {\n    x: pBase.x - pShared.x,\n    y: pBase.y - pShared.y\n  };\n  const vAngle = {\n    x: pAngle.x - pShared.x,\n    y: pAngle.y - pShared.y\n  };\n  return crossProduct(vAngle, vBase) / length(vAngle) / length(vBase);\n};\n\n/* Get the cosine of the angle from pShared -> pAngle to pShaed -> pBase */\nconst cosineOfAngle = (pShared, pBase, pAngle) => {\n  const vBase = {\n    x: pBase.x - pShared.x,\n    y: pBase.y - pShared.y\n  };\n  const vAngle = {\n    x: pAngle.x - pShared.x,\n    y: pAngle.y - pShared.y\n  };\n  return dotProduct(vAngle, vBase) / length(vAngle) / length(vBase);\n};\n\n/* Get the x coordinate where the given line (defined by a point and vector)\n * crosses the horizontal line with the given y coordiante.\n * In the case of parrallel lines (including overlapping ones) returns null. */\nconst horizontalIntersection = (pt, v, y) => {\n  if (v.y === 0) return null;\n  return {\n    x: pt.x + v.x / v.y * (y - pt.y),\n    y: y\n  };\n};\n\n/* Get the y coordinate where the given line (defined by a point and vector)\n * crosses the vertical line with the given x coordiante.\n * In the case of parrallel lines (including overlapping ones) returns null. */\nconst verticalIntersection = (pt, v, x) => {\n  if (v.x === 0) return null;\n  return {\n    x: x,\n    y: pt.y + v.y / v.x * (x - pt.x)\n  };\n};\n\n/* Get the intersection of two lines, each defined by a base point and a vector.\n * In the case of parrallel lines (including overlapping ones) returns null. */\nconst intersection$1 = (pt1, v1, pt2, v2) => {\n  // take some shortcuts for vertical and horizontal lines\n  // this also ensures we don't calculate an intersection and then discover\n  // it's actually outside the bounding box of the line\n  if (v1.x === 0) return verticalIntersection(pt2, v2, pt1.x);\n  if (v2.x === 0) return verticalIntersection(pt1, v1, pt2.x);\n  if (v1.y === 0) return horizontalIntersection(pt2, v2, pt1.y);\n  if (v2.y === 0) return horizontalIntersection(pt1, v1, pt2.y);\n\n  // General case for non-overlapping segments.\n  // This algorithm is based on Schneider and Eberly.\n  // http://www.cimec.org.ar/~ncalvo/Schneider_Eberly.pdf - pg 244\n\n  const kross = crossProduct(v1, v2);\n  if (kross == 0) return null;\n  const ve = {\n    x: pt2.x - pt1.x,\n    y: pt2.y - pt1.y\n  };\n  const d1 = crossProduct(ve, v1) / kross;\n  const d2 = crossProduct(ve, v2) / kross;\n\n  // take the average of the two calculations to minimize rounding error\n  const x1 = pt1.x + d2 * v1.x,\n    x2 = pt2.x + d1 * v2.x;\n  const y1 = pt1.y + d2 * v1.y,\n    y2 = pt2.y + d1 * v2.y;\n  const x = (x1 + x2) / 2;\n  const y = (y1 + y2) / 2;\n  return {\n    x: x,\n    y: y\n  };\n};\n\nclass SweepEvent {\n  // for ordering sweep events in the sweep event queue\n  static compare(a, b) {\n    // favor event with a point that the sweep line hits first\n    const ptCmp = SweepEvent.comparePoints(a.point, b.point);\n    if (ptCmp !== 0) return ptCmp;\n\n    // the points are the same, so link them if needed\n    if (a.point !== b.point) a.link(b);\n\n    // favor right events over left\n    if (a.isLeft !== b.isLeft) return a.isLeft ? 1 : -1;\n\n    // we have two matching left or right endpoints\n    // ordering of this case is the same as for their segments\n    return Segment.compare(a.segment, b.segment);\n  }\n\n  // for ordering points in sweep line order\n  static comparePoints(aPt, bPt) {\n    if (aPt.x < bPt.x) return -1;\n    if (aPt.x > bPt.x) return 1;\n    if (aPt.y < bPt.y) return -1;\n    if (aPt.y > bPt.y) return 1;\n    return 0;\n  }\n\n  // Warning: 'point' input will be modified and re-used (for performance)\n  constructor(point, isLeft) {\n    if (point.events === undefined) point.events = [this];else point.events.push(this);\n    this.point = point;\n    this.isLeft = isLeft;\n    // this.segment, this.otherSE set by factory\n  }\n  link(other) {\n    if (other.point === this.point) {\n      throw new Error(\"Tried to link already linked events\");\n    }\n    const otherEvents = other.point.events;\n    for (let i = 0, iMax = otherEvents.length; i < iMax; i++) {\n      const evt = otherEvents[i];\n      this.point.events.push(evt);\n      evt.point = this.point;\n    }\n    this.checkForConsuming();\n  }\n\n  /* Do a pass over our linked events and check to see if any pair\n   * of segments match, and should be consumed. */\n  checkForConsuming() {\n    // FIXME: The loops in this method run O(n^2) => no good.\n    //        Maintain little ordered sweep event trees?\n    //        Can we maintaining an ordering that avoids the need\n    //        for the re-sorting with getLeftmostComparator in geom-out?\n\n    // Compare each pair of events to see if other events also match\n    const numEvents = this.point.events.length;\n    for (let i = 0; i < numEvents; i++) {\n      const evt1 = this.point.events[i];\n      if (evt1.segment.consumedBy !== undefined) continue;\n      for (let j = i + 1; j < numEvents; j++) {\n        const evt2 = this.point.events[j];\n        if (evt2.consumedBy !== undefined) continue;\n        if (evt1.otherSE.point.events !== evt2.otherSE.point.events) continue;\n        evt1.segment.consume(evt2.segment);\n      }\n    }\n  }\n  getAvailableLinkedEvents() {\n    // point.events is always of length 2 or greater\n    const events = [];\n    for (let i = 0, iMax = this.point.events.length; i < iMax; i++) {\n      const evt = this.point.events[i];\n      if (evt !== this && !evt.segment.ringOut && evt.segment.isInResult()) {\n        events.push(evt);\n      }\n    }\n    return events;\n  }\n\n  /**\n   * Returns a comparator function for sorting linked events that will\n   * favor the event that will give us the smallest left-side angle.\n   * All ring construction starts as low as possible heading to the right,\n   * so by always turning left as sharp as possible we'll get polygons\n   * without uncessary loops & holes.\n   *\n   * The comparator function has a compute cache such that it avoids\n   * re-computing already-computed values.\n   */\n  getLeftmostComparator(baseEvent) {\n    const cache = new Map();\n    const fillCache = linkedEvent => {\n      const nextEvent = linkedEvent.otherSE;\n      cache.set(linkedEvent, {\n        sine: sineOfAngle(this.point, baseEvent.point, nextEvent.point),\n        cosine: cosineOfAngle(this.point, baseEvent.point, nextEvent.point)\n      });\n    };\n    return (a, b) => {\n      if (!cache.has(a)) fillCache(a);\n      if (!cache.has(b)) fillCache(b);\n      const {\n        sine: asine,\n        cosine: acosine\n      } = cache.get(a);\n      const {\n        sine: bsine,\n        cosine: bcosine\n      } = cache.get(b);\n\n      // both on or above x-axis\n      if (asine >= 0 && bsine >= 0) {\n        if (acosine < bcosine) return 1;\n        if (acosine > bcosine) return -1;\n        return 0;\n      }\n\n      // both below x-axis\n      if (asine < 0 && bsine < 0) {\n        if (acosine < bcosine) return -1;\n        if (acosine > bcosine) return 1;\n        return 0;\n      }\n\n      // one above x-axis, one below\n      if (bsine < asine) return -1;\n      if (bsine > asine) return 1;\n      return 0;\n    };\n  }\n}\n\n// Give segments unique ID's to get consistent sorting of\n// segments and sweep events when all else is identical\nlet segmentId = 0;\nclass Segment {\n  /* This compare() function is for ordering segments in the sweep\n   * line tree, and does so according to the following criteria:\n   *\n   * Consider the vertical line that lies an infinestimal step to the\n   * right of the right-more of the two left endpoints of the input\n   * segments. Imagine slowly moving a point up from negative infinity\n   * in the increasing y direction. Which of the two segments will that\n   * point intersect first? That segment comes 'before' the other one.\n   *\n   * If neither segment would be intersected by such a line, (if one\n   * or more of the segments are vertical) then the line to be considered\n   * is directly on the right-more of the two left inputs.\n   */\n  static compare(a, b) {\n    const alx = a.leftSE.point.x;\n    const blx = b.leftSE.point.x;\n    const arx = a.rightSE.point.x;\n    const brx = b.rightSE.point.x;\n\n    // check if they're even in the same vertical plane\n    if (brx < alx) return 1;\n    if (arx < blx) return -1;\n    const aly = a.leftSE.point.y;\n    const bly = b.leftSE.point.y;\n    const ary = a.rightSE.point.y;\n    const bry = b.rightSE.point.y;\n\n    // is left endpoint of segment B the right-more?\n    if (alx < blx) {\n      // are the two segments in the same horizontal plane?\n      if (bly < aly && bly < ary) return 1;\n      if (bly > aly && bly > ary) return -1;\n\n      // is the B left endpoint colinear to segment A?\n      const aCmpBLeft = a.comparePoint(b.leftSE.point);\n      if (aCmpBLeft < 0) return 1;\n      if (aCmpBLeft > 0) return -1;\n\n      // is the A right endpoint colinear to segment B ?\n      const bCmpARight = b.comparePoint(a.rightSE.point);\n      if (bCmpARight !== 0) return bCmpARight;\n\n      // colinear segments, consider the one with left-more\n      // left endpoint to be first (arbitrary?)\n      return -1;\n    }\n\n    // is left endpoint of segment A the right-more?\n    if (alx > blx) {\n      if (aly < bly && aly < bry) return -1;\n      if (aly > bly && aly > bry) return 1;\n\n      // is the A left endpoint colinear to segment B?\n      const bCmpALeft = b.comparePoint(a.leftSE.point);\n      if (bCmpALeft !== 0) return bCmpALeft;\n\n      // is the B right endpoint colinear to segment A?\n      const aCmpBRight = a.comparePoint(b.rightSE.point);\n      if (aCmpBRight < 0) return 1;\n      if (aCmpBRight > 0) return -1;\n\n      // colinear segments, consider the one with left-more\n      // left endpoint to be first (arbitrary?)\n      return 1;\n    }\n\n    // if we get here, the two left endpoints are in the same\n    // vertical plane, ie alx === blx\n\n    // consider the lower left-endpoint to come first\n    if (aly < bly) return -1;\n    if (aly > bly) return 1;\n\n    // left endpoints are identical\n    // check for colinearity by using the left-more right endpoint\n\n    // is the A right endpoint more left-more?\n    if (arx < brx) {\n      const bCmpARight = b.comparePoint(a.rightSE.point);\n      if (bCmpARight !== 0) return bCmpARight;\n    }\n\n    // is the B right endpoint more left-more?\n    if (arx > brx) {\n      const aCmpBRight = a.comparePoint(b.rightSE.point);\n      if (aCmpBRight < 0) return 1;\n      if (aCmpBRight > 0) return -1;\n    }\n    if (arx !== brx) {\n      // are these two [almost] vertical segments with opposite orientation?\n      // if so, the one with the lower right endpoint comes first\n      const ay = ary - aly;\n      const ax = arx - alx;\n      const by = bry - bly;\n      const bx = brx - blx;\n      if (ay > ax && by < bx) return 1;\n      if (ay < ax && by > bx) return -1;\n    }\n\n    // we have colinear segments with matching orientation\n    // consider the one with more left-more right endpoint to be first\n    if (arx > brx) return 1;\n    if (arx < brx) return -1;\n\n    // if we get here, two two right endpoints are in the same\n    // vertical plane, ie arx === brx\n\n    // consider the lower right-endpoint to come first\n    if (ary < bry) return -1;\n    if (ary > bry) return 1;\n\n    // right endpoints identical as well, so the segments are idential\n    // fall back on creation order as consistent tie-breaker\n    if (a.id < b.id) return -1;\n    if (a.id > b.id) return 1;\n\n    // identical segment, ie a === b\n    return 0;\n  }\n\n  /* Warning: a reference to ringWindings input will be stored,\n   *  and possibly will be later modified */\n  constructor(leftSE, rightSE, rings, windings) {\n    this.id = ++segmentId;\n    this.leftSE = leftSE;\n    leftSE.segment = this;\n    leftSE.otherSE = rightSE;\n    this.rightSE = rightSE;\n    rightSE.segment = this;\n    rightSE.otherSE = leftSE;\n    this.rings = rings;\n    this.windings = windings;\n    // left unset for performance, set later in algorithm\n    // this.ringOut, this.consumedBy, this.prev\n  }\n  static fromRing(pt1, pt2, ring) {\n    let leftPt, rightPt, winding;\n\n    // ordering the two points according to sweep line ordering\n    const cmpPts = SweepEvent.comparePoints(pt1, pt2);\n    if (cmpPts < 0) {\n      leftPt = pt1;\n      rightPt = pt2;\n      winding = 1;\n    } else if (cmpPts > 0) {\n      leftPt = pt2;\n      rightPt = pt1;\n      winding = -1;\n    } else throw new Error(`Tried to create degenerate segment at [${pt1.x}, ${pt1.y}]`);\n    const leftSE = new SweepEvent(leftPt, true);\n    const rightSE = new SweepEvent(rightPt, false);\n    return new Segment(leftSE, rightSE, [ring], [winding]);\n  }\n\n  /* When a segment is split, the rightSE is replaced with a new sweep event */\n  replaceRightSE(newRightSE) {\n    this.rightSE = newRightSE;\n    this.rightSE.segment = this;\n    this.rightSE.otherSE = this.leftSE;\n    this.leftSE.otherSE = this.rightSE;\n  }\n  bbox() {\n    const y1 = this.leftSE.point.y;\n    const y2 = this.rightSE.point.y;\n    return {\n      ll: {\n        x: this.leftSE.point.x,\n        y: y1 < y2 ? y1 : y2\n      },\n      ur: {\n        x: this.rightSE.point.x,\n        y: y1 > y2 ? y1 : y2\n      }\n    };\n  }\n\n  /* A vector from the left point to the right */\n  vector() {\n    return {\n      x: this.rightSE.point.x - this.leftSE.point.x,\n      y: this.rightSE.point.y - this.leftSE.point.y\n    };\n  }\n  isAnEndpoint(pt) {\n    return pt.x === this.leftSE.point.x && pt.y === this.leftSE.point.y || pt.x === this.rightSE.point.x && pt.y === this.rightSE.point.y;\n  }\n\n  /* Compare this segment with a point.\n   *\n   * A point P is considered to be colinear to a segment if there\n   * exists a distance D such that if we travel along the segment\n   * from one * endpoint towards the other a distance D, we find\n   * ourselves at point P.\n   *\n   * Return value indicates:\n   *\n   *   1: point lies above the segment (to the left of vertical)\n   *   0: point is colinear to segment\n   *  -1: point lies below the segment (to the right of vertical)\n   */\n  comparePoint(point) {\n    if (this.isAnEndpoint(point)) return 0;\n    const lPt = this.leftSE.point;\n    const rPt = this.rightSE.point;\n    const v = this.vector();\n\n    // Exactly vertical segments.\n    if (lPt.x === rPt.x) {\n      if (point.x === lPt.x) return 0;\n      return point.x < lPt.x ? 1 : -1;\n    }\n\n    // Nearly vertical segments with an intersection.\n    // Check to see where a point on the line with matching Y coordinate is.\n    const yDist = (point.y - lPt.y) / v.y;\n    const xFromYDist = lPt.x + yDist * v.x;\n    if (point.x === xFromYDist) return 0;\n\n    // General case.\n    // Check to see where a point on the line with matching X coordinate is.\n    const xDist = (point.x - lPt.x) / v.x;\n    const yFromXDist = lPt.y + xDist * v.y;\n    if (point.y === yFromXDist) return 0;\n    return point.y < yFromXDist ? -1 : 1;\n  }\n\n  /**\n   * Given another segment, returns the first non-trivial intersection\n   * between the two segments (in terms of sweep line ordering), if it exists.\n   *\n   * A 'non-trivial' intersection is one that will cause one or both of the\n   * segments to be split(). As such, 'trivial' vs. 'non-trivial' intersection:\n   *\n   *   * endpoint of segA with endpoint of segB --> trivial\n   *   * endpoint of segA with point along segB --> non-trivial\n   *   * endpoint of segB with point along segA --> non-trivial\n   *   * point along segA with point along segB --> non-trivial\n   *\n   * If no non-trivial intersection exists, return null\n   * Else, return null.\n   */\n  getIntersection(other) {\n    // If bboxes don't overlap, there can't be any intersections\n    const tBbox = this.bbox();\n    const oBbox = other.bbox();\n    const bboxOverlap = getBboxOverlap(tBbox, oBbox);\n    if (bboxOverlap === null) return null;\n\n    // We first check to see if the endpoints can be considered intersections.\n    // This will 'snap' intersections to endpoints if possible, and will\n    // handle cases of colinearity.\n\n    const tlp = this.leftSE.point;\n    const trp = this.rightSE.point;\n    const olp = other.leftSE.point;\n    const orp = other.rightSE.point;\n\n    // does each endpoint touch the other segment?\n    // note that we restrict the 'touching' definition to only allow segments\n    // to touch endpoints that lie forward from where we are in the sweep line pass\n    const touchesOtherLSE = isInBbox(tBbox, olp) && this.comparePoint(olp) === 0;\n    const touchesThisLSE = isInBbox(oBbox, tlp) && other.comparePoint(tlp) === 0;\n    const touchesOtherRSE = isInBbox(tBbox, orp) && this.comparePoint(orp) === 0;\n    const touchesThisRSE = isInBbox(oBbox, trp) && other.comparePoint(trp) === 0;\n\n    // do left endpoints match?\n    if (touchesThisLSE && touchesOtherLSE) {\n      // these two cases are for colinear segments with matching left\n      // endpoints, and one segment being longer than the other\n      if (touchesThisRSE && !touchesOtherRSE) return trp;\n      if (!touchesThisRSE && touchesOtherRSE) return orp;\n      // either the two segments match exactly (two trival intersections)\n      // or just on their left endpoint (one trivial intersection\n      return null;\n    }\n\n    // does this left endpoint matches (other doesn't)\n    if (touchesThisLSE) {\n      // check for segments that just intersect on opposing endpoints\n      if (touchesOtherRSE) {\n        if (tlp.x === orp.x && tlp.y === orp.y) return null;\n      }\n      // t-intersection on left endpoint\n      return tlp;\n    }\n\n    // does other left endpoint matches (this doesn't)\n    if (touchesOtherLSE) {\n      // check for segments that just intersect on opposing endpoints\n      if (touchesThisRSE) {\n        if (trp.x === olp.x && trp.y === olp.y) return null;\n      }\n      // t-intersection on left endpoint\n      return olp;\n    }\n\n    // trivial intersection on right endpoints\n    if (touchesThisRSE && touchesOtherRSE) return null;\n\n    // t-intersections on just one right endpoint\n    if (touchesThisRSE) return trp;\n    if (touchesOtherRSE) return orp;\n\n    // None of our endpoints intersect. Look for a general intersection between\n    // infinite lines laid over the segments\n    const pt = intersection$1(tlp, this.vector(), olp, other.vector());\n\n    // are the segments parrallel? Note that if they were colinear with overlap,\n    // they would have an endpoint intersection and that case was already handled above\n    if (pt === null) return null;\n\n    // is the intersection found between the lines not on the segments?\n    if (!isInBbox(bboxOverlap, pt)) return null;\n\n    // round the the computed point if needed\n    return rounder.round(pt.x, pt.y);\n  }\n\n  /**\n   * Split the given segment into multiple segments on the given points.\n   *  * Each existing segment will retain its leftSE and a new rightSE will be\n   *    generated for it.\n   *  * A new segment will be generated which will adopt the original segment's\n   *    rightSE, and a new leftSE will be generated for it.\n   *  * If there are more than two points given to split on, new segments\n   *    in the middle will be generated with new leftSE and rightSE's.\n   *  * An array of the newly generated SweepEvents will be returned.\n   *\n   * Warning: input array of points is modified\n   */\n  split(point) {\n    const newEvents = [];\n    const alreadyLinked = point.events !== undefined;\n    const newLeftSE = new SweepEvent(point, true);\n    const newRightSE = new SweepEvent(point, false);\n    const oldRightSE = this.rightSE;\n    this.replaceRightSE(newRightSE);\n    newEvents.push(newRightSE);\n    newEvents.push(newLeftSE);\n    const newSeg = new Segment(newLeftSE, oldRightSE, this.rings.slice(), this.windings.slice());\n\n    // when splitting a nearly vertical downward-facing segment,\n    // sometimes one of the resulting new segments is vertical, in which\n    // case its left and right events may need to be swapped\n    if (SweepEvent.comparePoints(newSeg.leftSE.point, newSeg.rightSE.point) > 0) {\n      newSeg.swapEvents();\n    }\n    if (SweepEvent.comparePoints(this.leftSE.point, this.rightSE.point) > 0) {\n      this.swapEvents();\n    }\n\n    // in the point we just used to create new sweep events with was already\n    // linked to other events, we need to check if either of the affected\n    // segments should be consumed\n    if (alreadyLinked) {\n      newLeftSE.checkForConsuming();\n      newRightSE.checkForConsuming();\n    }\n    return newEvents;\n  }\n\n  /* Swap which event is left and right */\n  swapEvents() {\n    const tmpEvt = this.rightSE;\n    this.rightSE = this.leftSE;\n    this.leftSE = tmpEvt;\n    this.leftSE.isLeft = true;\n    this.rightSE.isLeft = false;\n    for (let i = 0, iMax = this.windings.length; i < iMax; i++) {\n      this.windings[i] *= -1;\n    }\n  }\n\n  /* Consume another segment. We take their rings under our wing\n   * and mark them as consumed. Use for perfectly overlapping segments */\n  consume(other) {\n    let consumer = this;\n    let consumee = other;\n    while (consumer.consumedBy) consumer = consumer.consumedBy;\n    while (consumee.consumedBy) consumee = consumee.consumedBy;\n    const cmp = Segment.compare(consumer, consumee);\n    if (cmp === 0) return; // already consumed\n    // the winner of the consumption is the earlier segment\n    // according to sweep line ordering\n    if (cmp > 0) {\n      const tmp = consumer;\n      consumer = consumee;\n      consumee = tmp;\n    }\n\n    // make sure a segment doesn't consume it's prev\n    if (consumer.prev === consumee) {\n      const tmp = consumer;\n      consumer = consumee;\n      consumee = tmp;\n    }\n    for (let i = 0, iMax = consumee.rings.length; i < iMax; i++) {\n      const ring = consumee.rings[i];\n      const winding = consumee.windings[i];\n      const index = consumer.rings.indexOf(ring);\n      if (index === -1) {\n        consumer.rings.push(ring);\n        consumer.windings.push(winding);\n      } else consumer.windings[index] += winding;\n    }\n    consumee.rings = null;\n    consumee.windings = null;\n    consumee.consumedBy = consumer;\n\n    // mark sweep events consumed as to maintain ordering in sweep event queue\n    consumee.leftSE.consumedBy = consumer.leftSE;\n    consumee.rightSE.consumedBy = consumer.rightSE;\n  }\n\n  /* The first segment previous segment chain that is in the result */\n  prevInResult() {\n    if (this._prevInResult !== undefined) return this._prevInResult;\n    if (!this.prev) this._prevInResult = null;else if (this.prev.isInResult()) this._prevInResult = this.prev;else this._prevInResult = this.prev.prevInResult();\n    return this._prevInResult;\n  }\n  beforeState() {\n    if (this._beforeState !== undefined) return this._beforeState;\n    if (!this.prev) this._beforeState = {\n      rings: [],\n      windings: [],\n      multiPolys: []\n    };else {\n      const seg = this.prev.consumedBy || this.prev;\n      this._beforeState = seg.afterState();\n    }\n    return this._beforeState;\n  }\n  afterState() {\n    if (this._afterState !== undefined) return this._afterState;\n    const beforeState = this.beforeState();\n    this._afterState = {\n      rings: beforeState.rings.slice(0),\n      windings: beforeState.windings.slice(0),\n      multiPolys: []\n    };\n    const ringsAfter = this._afterState.rings;\n    const windingsAfter = this._afterState.windings;\n    const mpsAfter = this._afterState.multiPolys;\n\n    // calculate ringsAfter, windingsAfter\n    for (let i = 0, iMax = this.rings.length; i < iMax; i++) {\n      const ring = this.rings[i];\n      const winding = this.windings[i];\n      const index = ringsAfter.indexOf(ring);\n      if (index === -1) {\n        ringsAfter.push(ring);\n        windingsAfter.push(winding);\n      } else windingsAfter[index] += winding;\n    }\n\n    // calcualte polysAfter\n    const polysAfter = [];\n    const polysExclude = [];\n    for (let i = 0, iMax = ringsAfter.length; i < iMax; i++) {\n      if (windingsAfter[i] === 0) continue; // non-zero rule\n      const ring = ringsAfter[i];\n      const poly = ring.poly;\n      if (polysExclude.indexOf(poly) !== -1) continue;\n      if (ring.isExterior) polysAfter.push(poly);else {\n        if (polysExclude.indexOf(poly) === -1) polysExclude.push(poly);\n        const index = polysAfter.indexOf(ring.poly);\n        if (index !== -1) polysAfter.splice(index, 1);\n      }\n    }\n\n    // calculate multiPolysAfter\n    for (let i = 0, iMax = polysAfter.length; i < iMax; i++) {\n      const mp = polysAfter[i].multiPoly;\n      if (mpsAfter.indexOf(mp) === -1) mpsAfter.push(mp);\n    }\n    return this._afterState;\n  }\n\n  /* Is this segment part of the final result? */\n  isInResult() {\n    // if we've been consumed, we're not in the result\n    if (this.consumedBy) return false;\n    if (this._isInResult !== undefined) return this._isInResult;\n    const mpsBefore = this.beforeState().multiPolys;\n    const mpsAfter = this.afterState().multiPolys;\n    switch (operation.type) {\n      case \"union\":\n        {\n          // UNION - included iff:\n          //  * On one side of us there is 0 poly interiors AND\n          //  * On the other side there is 1 or more.\n          const noBefores = mpsBefore.length === 0;\n          const noAfters = mpsAfter.length === 0;\n          this._isInResult = noBefores !== noAfters;\n          break;\n        }\n      case \"intersection\":\n        {\n          // INTERSECTION - included iff:\n          //  * on one side of us all multipolys are rep. with poly interiors AND\n          //  * on the other side of us, not all multipolys are repsented\n          //    with poly interiors\n          let least;\n          let most;\n          if (mpsBefore.length < mpsAfter.length) {\n            least = mpsBefore.length;\n            most = mpsAfter.length;\n          } else {\n            least = mpsAfter.length;\n            most = mpsBefore.length;\n          }\n          this._isInResult = most === operation.numMultiPolys && least < most;\n          break;\n        }\n      case \"xor\":\n        {\n          // XOR - included iff:\n          //  * the difference between the number of multipolys represented\n          //    with poly interiors on our two sides is an odd number\n          const diff = Math.abs(mpsBefore.length - mpsAfter.length);\n          this._isInResult = diff % 2 === 1;\n          break;\n        }\n      case \"difference\":\n        {\n          // DIFFERENCE included iff:\n          //  * on exactly one side, we have just the subject\n          const isJustSubject = mps => mps.length === 1 && mps[0].isSubject;\n          this._isInResult = isJustSubject(mpsBefore) !== isJustSubject(mpsAfter);\n          break;\n        }\n      default:\n        throw new Error(`Unrecognized operation type found ${operation.type}`);\n    }\n    return this._isInResult;\n  }\n}\n\nclass RingIn {\n  constructor(geomRing, poly, isExterior) {\n    if (!Array.isArray(geomRing) || geomRing.length === 0) {\n      throw new Error(\"Input geometry is not a valid Polygon or MultiPolygon\");\n    }\n    this.poly = poly;\n    this.isExterior = isExterior;\n    this.segments = [];\n    if (typeof geomRing[0][0] !== \"number\" || typeof geomRing[0][1] !== \"number\") {\n      throw new Error(\"Input geometry is not a valid Polygon or MultiPolygon\");\n    }\n    const firstPoint = rounder.round(geomRing[0][0], geomRing[0][1]);\n    this.bbox = {\n      ll: {\n        x: firstPoint.x,\n        y: firstPoint.y\n      },\n      ur: {\n        x: firstPoint.x,\n        y: firstPoint.y\n      }\n    };\n    let prevPoint = firstPoint;\n    for (let i = 1, iMax = geomRing.length; i < iMax; i++) {\n      if (typeof geomRing[i][0] !== \"number\" || typeof geomRing[i][1] !== \"number\") {\n        throw new Error(\"Input geometry is not a valid Polygon or MultiPolygon\");\n      }\n      let point = rounder.round(geomRing[i][0], geomRing[i][1]);\n      // skip repeated points\n      if (point.x === prevPoint.x && point.y === prevPoint.y) continue;\n      this.segments.push(Segment.fromRing(prevPoint, point, this));\n      if (point.x < this.bbox.ll.x) this.bbox.ll.x = point.x;\n      if (point.y < this.bbox.ll.y) this.bbox.ll.y = point.y;\n      if (point.x > this.bbox.ur.x) this.bbox.ur.x = point.x;\n      if (point.y > this.bbox.ur.y) this.bbox.ur.y = point.y;\n      prevPoint = point;\n    }\n    // add segment from last to first if last is not the same as first\n    if (firstPoint.x !== prevPoint.x || firstPoint.y !== prevPoint.y) {\n      this.segments.push(Segment.fromRing(prevPoint, firstPoint, this));\n    }\n  }\n  getSweepEvents() {\n    const sweepEvents = [];\n    for (let i = 0, iMax = this.segments.length; i < iMax; i++) {\n      const segment = this.segments[i];\n      sweepEvents.push(segment.leftSE);\n      sweepEvents.push(segment.rightSE);\n    }\n    return sweepEvents;\n  }\n}\nclass PolyIn {\n  constructor(geomPoly, multiPoly) {\n    if (!Array.isArray(geomPoly)) {\n      throw new Error(\"Input geometry is not a valid Polygon or MultiPolygon\");\n    }\n    this.exteriorRing = new RingIn(geomPoly[0], this, true);\n    // copy by value\n    this.bbox = {\n      ll: {\n        x: this.exteriorRing.bbox.ll.x,\n        y: this.exteriorRing.bbox.ll.y\n      },\n      ur: {\n        x: this.exteriorRing.bbox.ur.x,\n        y: this.exteriorRing.bbox.ur.y\n      }\n    };\n    this.interiorRings = [];\n    for (let i = 1, iMax = geomPoly.length; i < iMax; i++) {\n      const ring = new RingIn(geomPoly[i], this, false);\n      if (ring.bbox.ll.x < this.bbox.ll.x) this.bbox.ll.x = ring.bbox.ll.x;\n      if (ring.bbox.ll.y < this.bbox.ll.y) this.bbox.ll.y = ring.bbox.ll.y;\n      if (ring.bbox.ur.x > this.bbox.ur.x) this.bbox.ur.x = ring.bbox.ur.x;\n      if (ring.bbox.ur.y > this.bbox.ur.y) this.bbox.ur.y = ring.bbox.ur.y;\n      this.interiorRings.push(ring);\n    }\n    this.multiPoly = multiPoly;\n  }\n  getSweepEvents() {\n    const sweepEvents = this.exteriorRing.getSweepEvents();\n    for (let i = 0, iMax = this.interiorRings.length; i < iMax; i++) {\n      const ringSweepEvents = this.interiorRings[i].getSweepEvents();\n      for (let j = 0, jMax = ringSweepEvents.length; j < jMax; j++) {\n        sweepEvents.push(ringSweepEvents[j]);\n      }\n    }\n    return sweepEvents;\n  }\n}\nclass MultiPolyIn {\n  constructor(geom, isSubject) {\n    if (!Array.isArray(geom)) {\n      throw new Error(\"Input geometry is not a valid Polygon or MultiPolygon\");\n    }\n    try {\n      // if the input looks like a polygon, convert it to a multipolygon\n      if (typeof geom[0][0][0] === \"number\") geom = [geom];\n    } catch (ex) {\n      // The input is either malformed or has empty arrays.\n      // In either case, it will be handled later on.\n    }\n    this.polys = [];\n    this.bbox = {\n      ll: {\n        x: Number.POSITIVE_INFINITY,\n        y: Number.POSITIVE_INFINITY\n      },\n      ur: {\n        x: Number.NEGATIVE_INFINITY,\n        y: Number.NEGATIVE_INFINITY\n      }\n    };\n    for (let i = 0, iMax = geom.length; i < iMax; i++) {\n      const poly = new PolyIn(geom[i], this);\n      if (poly.bbox.ll.x < this.bbox.ll.x) this.bbox.ll.x = poly.bbox.ll.x;\n      if (poly.bbox.ll.y < this.bbox.ll.y) this.bbox.ll.y = poly.bbox.ll.y;\n      if (poly.bbox.ur.x > this.bbox.ur.x) this.bbox.ur.x = poly.bbox.ur.x;\n      if (poly.bbox.ur.y > this.bbox.ur.y) this.bbox.ur.y = poly.bbox.ur.y;\n      this.polys.push(poly);\n    }\n    this.isSubject = isSubject;\n  }\n  getSweepEvents() {\n    const sweepEvents = [];\n    for (let i = 0, iMax = this.polys.length; i < iMax; i++) {\n      const polySweepEvents = this.polys[i].getSweepEvents();\n      for (let j = 0, jMax = polySweepEvents.length; j < jMax; j++) {\n        sweepEvents.push(polySweepEvents[j]);\n      }\n    }\n    return sweepEvents;\n  }\n}\n\nclass RingOut {\n  /* Given the segments from the sweep line pass, compute & return a series\n   * of closed rings from all the segments marked to be part of the result */\n  static factory(allSegments) {\n    const ringsOut = [];\n    for (let i = 0, iMax = allSegments.length; i < iMax; i++) {\n      const segment = allSegments[i];\n      if (!segment.isInResult() || segment.ringOut) continue;\n      let prevEvent = null;\n      let event = segment.leftSE;\n      let nextEvent = segment.rightSE;\n      const events = [event];\n      const startingPoint = event.point;\n      const intersectionLEs = [];\n\n      /* Walk the chain of linked events to form a closed ring */\n      while (true) {\n        prevEvent = event;\n        event = nextEvent;\n        events.push(event);\n\n        /* Is the ring complete? */\n        if (event.point === startingPoint) break;\n        while (true) {\n          const availableLEs = event.getAvailableLinkedEvents();\n\n          /* Did we hit a dead end? This shouldn't happen.\n           * Indicates some earlier part of the algorithm malfunctioned. */\n          if (availableLEs.length === 0) {\n            const firstPt = events[0].point;\n            const lastPt = events[events.length - 1].point;\n            throw new Error(`Unable to complete output ring starting at [${firstPt.x},` + ` ${firstPt.y}]. Last matching segment found ends at` + ` [${lastPt.x}, ${lastPt.y}].`);\n          }\n\n          /* Only one way to go, so cotinue on the path */\n          if (availableLEs.length === 1) {\n            nextEvent = availableLEs[0].otherSE;\n            break;\n          }\n\n          /* We must have an intersection. Check for a completed loop */\n          let indexLE = null;\n          for (let j = 0, jMax = intersectionLEs.length; j < jMax; j++) {\n            if (intersectionLEs[j].point === event.point) {\n              indexLE = j;\n              break;\n            }\n          }\n          /* Found a completed loop. Cut that off and make a ring */\n          if (indexLE !== null) {\n            const intersectionLE = intersectionLEs.splice(indexLE)[0];\n            const ringEvents = events.splice(intersectionLE.index);\n            ringEvents.unshift(ringEvents[0].otherSE);\n            ringsOut.push(new RingOut(ringEvents.reverse()));\n            continue;\n          }\n          /* register the intersection */\n          intersectionLEs.push({\n            index: events.length,\n            point: event.point\n          });\n          /* Choose the left-most option to continue the walk */\n          const comparator = event.getLeftmostComparator(prevEvent);\n          nextEvent = availableLEs.sort(comparator)[0].otherSE;\n          break;\n        }\n      }\n      ringsOut.push(new RingOut(events));\n    }\n    return ringsOut;\n  }\n  constructor(events) {\n    this.events = events;\n    for (let i = 0, iMax = events.length; i < iMax; i++) {\n      events[i].segment.ringOut = this;\n    }\n    this.poly = null;\n  }\n  getGeom() {\n    // Remove superfluous points (ie extra points along a straight line),\n    let prevPt = this.events[0].point;\n    const points = [prevPt];\n    for (let i = 1, iMax = this.events.length - 1; i < iMax; i++) {\n      const pt = this.events[i].point;\n      const nextPt = this.events[i + 1].point;\n      if (compareVectorAngles(pt, prevPt, nextPt) === 0) continue;\n      points.push(pt);\n      prevPt = pt;\n    }\n\n    // ring was all (within rounding error of angle calc) colinear points\n    if (points.length === 1) return null;\n\n    // check if the starting point is necessary\n    const pt = points[0];\n    const nextPt = points[1];\n    if (compareVectorAngles(pt, prevPt, nextPt) === 0) points.shift();\n    points.push(points[0]);\n    const step = this.isExteriorRing() ? 1 : -1;\n    const iStart = this.isExteriorRing() ? 0 : points.length - 1;\n    const iEnd = this.isExteriorRing() ? points.length : -1;\n    const orderedPoints = [];\n    for (let i = iStart; i != iEnd; i += step) orderedPoints.push([points[i].x, points[i].y]);\n    return orderedPoints;\n  }\n  isExteriorRing() {\n    if (this._isExteriorRing === undefined) {\n      const enclosing = this.enclosingRing();\n      this._isExteriorRing = enclosing ? !enclosing.isExteriorRing() : true;\n    }\n    return this._isExteriorRing;\n  }\n  enclosingRing() {\n    if (this._enclosingRing === undefined) {\n      this._enclosingRing = this._calcEnclosingRing();\n    }\n    return this._enclosingRing;\n  }\n\n  /* Returns the ring that encloses this one, if any */\n  _calcEnclosingRing() {\n    // start with the ealier sweep line event so that the prevSeg\n    // chain doesn't lead us inside of a loop of ours\n    let leftMostEvt = this.events[0];\n    for (let i = 1, iMax = this.events.length; i < iMax; i++) {\n      const evt = this.events[i];\n      if (SweepEvent.compare(leftMostEvt, evt) > 0) leftMostEvt = evt;\n    }\n    let prevSeg = leftMostEvt.segment.prevInResult();\n    let prevPrevSeg = prevSeg ? prevSeg.prevInResult() : null;\n    while (true) {\n      // no segment found, thus no ring can enclose us\n      if (!prevSeg) return null;\n\n      // no segments below prev segment found, thus the ring of the prev\n      // segment must loop back around and enclose us\n      if (!prevPrevSeg) return prevSeg.ringOut;\n\n      // if the two segments are of different rings, the ring of the prev\n      // segment must either loop around us or the ring of the prev prev\n      // seg, which would make us and the ring of the prev peers\n      if (prevPrevSeg.ringOut !== prevSeg.ringOut) {\n        if (prevPrevSeg.ringOut.enclosingRing() !== prevSeg.ringOut) {\n          return prevSeg.ringOut;\n        } else return prevSeg.ringOut.enclosingRing();\n      }\n\n      // two segments are from the same ring, so this was a penisula\n      // of that ring. iterate downward, keep searching\n      prevSeg = prevPrevSeg.prevInResult();\n      prevPrevSeg = prevSeg ? prevSeg.prevInResult() : null;\n    }\n  }\n}\nclass PolyOut {\n  constructor(exteriorRing) {\n    this.exteriorRing = exteriorRing;\n    exteriorRing.poly = this;\n    this.interiorRings = [];\n  }\n  addInterior(ring) {\n    this.interiorRings.push(ring);\n    ring.poly = this;\n  }\n  getGeom() {\n    const geom = [this.exteriorRing.getGeom()];\n    // exterior ring was all (within rounding error of angle calc) colinear points\n    if (geom[0] === null) return null;\n    for (let i = 0, iMax = this.interiorRings.length; i < iMax; i++) {\n      const ringGeom = this.interiorRings[i].getGeom();\n      // interior ring was all (within rounding error of angle calc) colinear points\n      if (ringGeom === null) continue;\n      geom.push(ringGeom);\n    }\n    return geom;\n  }\n}\nclass MultiPolyOut {\n  constructor(rings) {\n    this.rings = rings;\n    this.polys = this._composePolys(rings);\n  }\n  getGeom() {\n    const geom = [];\n    for (let i = 0, iMax = this.polys.length; i < iMax; i++) {\n      const polyGeom = this.polys[i].getGeom();\n      // exterior ring was all (within rounding error of angle calc) colinear points\n      if (polyGeom === null) continue;\n      geom.push(polyGeom);\n    }\n    return geom;\n  }\n  _composePolys(rings) {\n    const polys = [];\n    for (let i = 0, iMax = rings.length; i < iMax; i++) {\n      const ring = rings[i];\n      if (ring.poly) continue;\n      if (ring.isExteriorRing()) polys.push(new PolyOut(ring));else {\n        const enclosingRing = ring.enclosingRing();\n        if (!enclosingRing.poly) polys.push(new PolyOut(enclosingRing));\n        enclosingRing.poly.addInterior(ring);\n      }\n    }\n    return polys;\n  }\n}\n\n/**\n * NOTE:  We must be careful not to change any segments while\n *        they are in the SplayTree. AFAIK, there's no way to tell\n *        the tree to rebalance itself - thus before splitting\n *        a segment that's in the tree, we remove it from the tree,\n *        do the split, then re-insert it. (Even though splitting a\n *        segment *shouldn't* change its correct position in the\n *        sweep line tree, the reality is because of rounding errors,\n *        it sometimes does.)\n */\n\nclass SweepLine {\n  constructor(queue) {\n    let comparator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Segment.compare;\n    this.queue = queue;\n    this.tree = new SplayTree(comparator);\n    this.segments = [];\n  }\n  process(event) {\n    const segment = event.segment;\n    const newEvents = [];\n\n    // if we've already been consumed by another segment,\n    // clean up our body parts and get out\n    if (event.consumedBy) {\n      if (event.isLeft) this.queue.remove(event.otherSE);else this.tree.remove(segment);\n      return newEvents;\n    }\n    const node = event.isLeft ? this.tree.add(segment) : this.tree.find(segment);\n    if (!node) throw new Error(`Unable to find segment #${segment.id} ` + `[${segment.leftSE.point.x}, ${segment.leftSE.point.y}] -> ` + `[${segment.rightSE.point.x}, ${segment.rightSE.point.y}] ` + \"in SweepLine tree.\");\n    let prevNode = node;\n    let nextNode = node;\n    let prevSeg = undefined;\n    let nextSeg = undefined;\n\n    // skip consumed segments still in tree\n    while (prevSeg === undefined) {\n      prevNode = this.tree.prev(prevNode);\n      if (prevNode === null) prevSeg = null;else if (prevNode.key.consumedBy === undefined) prevSeg = prevNode.key;\n    }\n\n    // skip consumed segments still in tree\n    while (nextSeg === undefined) {\n      nextNode = this.tree.next(nextNode);\n      if (nextNode === null) nextSeg = null;else if (nextNode.key.consumedBy === undefined) nextSeg = nextNode.key;\n    }\n    if (event.isLeft) {\n      // Check for intersections against the previous segment in the sweep line\n      let prevMySplitter = null;\n      if (prevSeg) {\n        const prevInter = prevSeg.getIntersection(segment);\n        if (prevInter !== null) {\n          if (!segment.isAnEndpoint(prevInter)) prevMySplitter = prevInter;\n          if (!prevSeg.isAnEndpoint(prevInter)) {\n            const newEventsFromSplit = this._splitSafely(prevSeg, prevInter);\n            for (let i = 0, iMax = newEventsFromSplit.length; i < iMax; i++) {\n              newEvents.push(newEventsFromSplit[i]);\n            }\n          }\n        }\n      }\n\n      // Check for intersections against the next segment in the sweep line\n      let nextMySplitter = null;\n      if (nextSeg) {\n        const nextInter = nextSeg.getIntersection(segment);\n        if (nextInter !== null) {\n          if (!segment.isAnEndpoint(nextInter)) nextMySplitter = nextInter;\n          if (!nextSeg.isAnEndpoint(nextInter)) {\n            const newEventsFromSplit = this._splitSafely(nextSeg, nextInter);\n            for (let i = 0, iMax = newEventsFromSplit.length; i < iMax; i++) {\n              newEvents.push(newEventsFromSplit[i]);\n            }\n          }\n        }\n      }\n\n      // For simplicity, even if we find more than one intersection we only\n      // spilt on the 'earliest' (sweep-line style) of the intersections.\n      // The other intersection will be handled in a future process().\n      if (prevMySplitter !== null || nextMySplitter !== null) {\n        let mySplitter = null;\n        if (prevMySplitter === null) mySplitter = nextMySplitter;else if (nextMySplitter === null) mySplitter = prevMySplitter;else {\n          const cmpSplitters = SweepEvent.comparePoints(prevMySplitter, nextMySplitter);\n          mySplitter = cmpSplitters <= 0 ? prevMySplitter : nextMySplitter;\n        }\n\n        // Rounding errors can cause changes in ordering,\n        // so remove afected segments and right sweep events before splitting\n        this.queue.remove(segment.rightSE);\n        newEvents.push(segment.rightSE);\n        const newEventsFromSplit = segment.split(mySplitter);\n        for (let i = 0, iMax = newEventsFromSplit.length; i < iMax; i++) {\n          newEvents.push(newEventsFromSplit[i]);\n        }\n      }\n      if (newEvents.length > 0) {\n        // We found some intersections, so re-do the current event to\n        // make sure sweep line ordering is totally consistent for later\n        // use with the segment 'prev' pointers\n        this.tree.remove(segment);\n        newEvents.push(event);\n      } else {\n        // done with left event\n        this.segments.push(segment);\n        segment.prev = prevSeg;\n      }\n    } else {\n      // event.isRight\n\n      // since we're about to be removed from the sweep line, check for\n      // intersections between our previous and next segments\n      if (prevSeg && nextSeg) {\n        const inter = prevSeg.getIntersection(nextSeg);\n        if (inter !== null) {\n          if (!prevSeg.isAnEndpoint(inter)) {\n            const newEventsFromSplit = this._splitSafely(prevSeg, inter);\n            for (let i = 0, iMax = newEventsFromSplit.length; i < iMax; i++) {\n              newEvents.push(newEventsFromSplit[i]);\n            }\n          }\n          if (!nextSeg.isAnEndpoint(inter)) {\n            const newEventsFromSplit = this._splitSafely(nextSeg, inter);\n            for (let i = 0, iMax = newEventsFromSplit.length; i < iMax; i++) {\n              newEvents.push(newEventsFromSplit[i]);\n            }\n          }\n        }\n      }\n      this.tree.remove(segment);\n    }\n    return newEvents;\n  }\n\n  /* Safely split a segment that is currently in the datastructures\n   * IE - a segment other than the one that is currently being processed. */\n  _splitSafely(seg, pt) {\n    // Rounding errors can cause changes in ordering,\n    // so remove afected segments and right sweep events before splitting\n    // removeNode() doesn't work, so have re-find the seg\n    // https://github.com/w8r/splay-tree/pull/5\n    this.tree.remove(seg);\n    const rightSE = seg.rightSE;\n    this.queue.remove(rightSE);\n    const newEvents = seg.split(pt);\n    newEvents.push(rightSE);\n    // splitting can trigger consumption\n    if (seg.consumedBy === undefined) this.tree.add(seg);\n    return newEvents;\n  }\n}\n\n// Limits on iterative processes to prevent infinite loops - usually caused by floating-point math round-off errors.\nconst POLYGON_CLIPPING_MAX_QUEUE_SIZE = typeof process !== \"undefined\" && process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE || 1000000;\nconst POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS = typeof process !== \"undefined\" && process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS || 1000000;\nclass Operation {\n  run(type, geom, moreGeoms) {\n    operation.type = type;\n    rounder.reset();\n\n    /* Convert inputs to MultiPoly objects */\n    const multipolys = [new MultiPolyIn(geom, true)];\n    for (let i = 0, iMax = moreGeoms.length; i < iMax; i++) {\n      multipolys.push(new MultiPolyIn(moreGeoms[i], false));\n    }\n    operation.numMultiPolys = multipolys.length;\n\n    /* BBox optimization for difference operation\n     * If the bbox of a multipolygon that's part of the clipping doesn't\n     * intersect the bbox of the subject at all, we can just drop that\n     * multiploygon. */\n    if (operation.type === \"difference\") {\n      // in place removal\n      const subject = multipolys[0];\n      let i = 1;\n      while (i < multipolys.length) {\n        if (getBboxOverlap(multipolys[i].bbox, subject.bbox) !== null) i++;else multipolys.splice(i, 1);\n      }\n    }\n\n    /* BBox optimization for intersection operation\n     * If we can find any pair of multipolygons whose bbox does not overlap,\n     * then the result will be empty. */\n    if (operation.type === \"intersection\") {\n      // TODO: this is O(n^2) in number of polygons. By sorting the bboxes,\n      //       it could be optimized to O(n * ln(n))\n      for (let i = 0, iMax = multipolys.length; i < iMax; i++) {\n        const mpA = multipolys[i];\n        for (let j = i + 1, jMax = multipolys.length; j < jMax; j++) {\n          if (getBboxOverlap(mpA.bbox, multipolys[j].bbox) === null) return [];\n        }\n      }\n    }\n\n    /* Put segment endpoints in a priority queue */\n    const queue = new SplayTree(SweepEvent.compare);\n    for (let i = 0, iMax = multipolys.length; i < iMax; i++) {\n      const sweepEvents = multipolys[i].getSweepEvents();\n      for (let j = 0, jMax = sweepEvents.length; j < jMax; j++) {\n        queue.insert(sweepEvents[j]);\n        if (queue.size > POLYGON_CLIPPING_MAX_QUEUE_SIZE) {\n          // prevents an infinite loop, an otherwise common manifestation of bugs\n          throw new Error(\"Infinite loop when putting segment endpoints in a priority queue \" + \"(queue size too big).\");\n        }\n      }\n    }\n\n    /* Pass the sweep line over those endpoints */\n    const sweepLine = new SweepLine(queue);\n    let prevQueueSize = queue.size;\n    let node = queue.pop();\n    while (node) {\n      const evt = node.key;\n      if (queue.size === prevQueueSize) {\n        // prevents an infinite loop, an otherwise common manifestation of bugs\n        const seg = evt.segment;\n        throw new Error(`Unable to pop() ${evt.isLeft ? \"left\" : \"right\"} SweepEvent ` + `[${evt.point.x}, ${evt.point.y}] from segment #${seg.id} ` + `[${seg.leftSE.point.x}, ${seg.leftSE.point.y}] -> ` + `[${seg.rightSE.point.x}, ${seg.rightSE.point.y}] from queue.`);\n      }\n      if (queue.size > POLYGON_CLIPPING_MAX_QUEUE_SIZE) {\n        // prevents an infinite loop, an otherwise common manifestation of bugs\n        throw new Error(\"Infinite loop when passing sweep line over endpoints \" + \"(queue size too big).\");\n      }\n      if (sweepLine.segments.length > POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS) {\n        // prevents an infinite loop, an otherwise common manifestation of bugs\n        throw new Error(\"Infinite loop when passing sweep line over endpoints \" + \"(too many sweep line segments).\");\n      }\n      const newEvents = sweepLine.process(evt);\n      for (let i = 0, iMax = newEvents.length; i < iMax; i++) {\n        const evt = newEvents[i];\n        if (evt.consumedBy === undefined) queue.insert(evt);\n      }\n      prevQueueSize = queue.size;\n      node = queue.pop();\n    }\n\n    // free some memory we don't need anymore\n    rounder.reset();\n\n    /* Collect and compile segments we're keeping into a multipolygon */\n    const ringsOut = RingOut.factory(sweepLine.segments);\n    const result = new MultiPolyOut(ringsOut);\n    return result.getGeom();\n  }\n}\n\n// singleton available by import\nconst operation = new Operation();\n\nconst union = function (geom) {\n  for (var _len = arguments.length, moreGeoms = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    moreGeoms[_key - 1] = arguments[_key];\n  }\n  return operation.run(\"union\", geom, moreGeoms);\n};\nconst intersection = function (geom) {\n  for (var _len2 = arguments.length, moreGeoms = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n    moreGeoms[_key2 - 1] = arguments[_key2];\n  }\n  return operation.run(\"intersection\", geom, moreGeoms);\n};\nconst xor = function (geom) {\n  for (var _len3 = arguments.length, moreGeoms = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n    moreGeoms[_key3 - 1] = arguments[_key3];\n  }\n  return operation.run(\"xor\", geom, moreGeoms);\n};\nconst difference = function (subjectGeom) {\n  for (var _len4 = arguments.length, clippingGeoms = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n    clippingGeoms[_key4 - 1] = arguments[_key4];\n  }\n  return operation.run(\"difference\", subjectGeom, clippingGeoms);\n};\nvar index = {\n  union: union,\n  intersection: intersection,\n  xor: xor,\n  difference: difference\n};\n\nexport { index as default };\n","// index.js\nimport { feature, point, lineString, isObject } from \"@turf/helpers\";\nfunction coordEach(geojson, callback, excludeWrapCoord) {\n  if (geojson === null)\n    return;\n  var j, k, l, geometry, stopG, coords, geometryMaybeCollection, wrapShrink = 0, coordIndex = 0, isGeometryCollection, type = geojson.type, isFeatureCollection = type === \"FeatureCollection\", isFeature = type === \"Feature\", stop = isFeatureCollection ? geojson.features.length : 1;\n  for (var featureIndex = 0; featureIndex < stop; featureIndex++) {\n    geometryMaybeCollection = isFeatureCollection ? geojson.features[featureIndex].geometry : isFeature ? geojson.geometry : geojson;\n    isGeometryCollection = geometryMaybeCollection ? geometryMaybeCollection.type === \"GeometryCollection\" : false;\n    stopG = isGeometryCollection ? geometryMaybeCollection.geometries.length : 1;\n    for (var geomIndex = 0; geomIndex < stopG; geomIndex++) {\n      var multiFeatureIndex = 0;\n      var geometryIndex = 0;\n      geometry = isGeometryCollection ? geometryMaybeCollection.geometries[geomIndex] : geometryMaybeCollection;\n      if (geometry === null)\n        continue;\n      coords = geometry.coordinates;\n      var geomType = geometry.type;\n      wrapShrink = excludeWrapCoord && (geomType === \"Polygon\" || geomType === \"MultiPolygon\") ? 1 : 0;\n      switch (geomType) {\n        case null:\n          break;\n        case \"Point\":\n          if (callback(\n            coords,\n            coordIndex,\n            featureIndex,\n            multiFeatureIndex,\n            geometryIndex\n          ) === false)\n            return false;\n          coordIndex++;\n          multiFeatureIndex++;\n          break;\n        case \"LineString\":\n        case \"MultiPoint\":\n          for (j = 0; j < coords.length; j++) {\n            if (callback(\n              coords[j],\n              coordIndex,\n              featureIndex,\n              multiFeatureIndex,\n              geometryIndex\n            ) === false)\n              return false;\n            coordIndex++;\n            if (geomType === \"MultiPoint\")\n              multiFeatureIndex++;\n          }\n          if (geomType === \"LineString\")\n            multiFeatureIndex++;\n          break;\n        case \"Polygon\":\n        case \"MultiLineString\":\n          for (j = 0; j < coords.length; j++) {\n            for (k = 0; k < coords[j].length - wrapShrink; k++) {\n              if (callback(\n                coords[j][k],\n                coordIndex,\n                featureIndex,\n                multiFeatureIndex,\n                geometryIndex\n              ) === false)\n                return false;\n              coordIndex++;\n            }\n            if (geomType === \"MultiLineString\")\n              multiFeatureIndex++;\n            if (geomType === \"Polygon\")\n              geometryIndex++;\n          }\n          if (geomType === \"Polygon\")\n            multiFeatureIndex++;\n          break;\n        case \"MultiPolygon\":\n          for (j = 0; j < coords.length; j++) {\n            geometryIndex = 0;\n            for (k = 0; k < coords[j].length; k++) {\n              for (l = 0; l < coords[j][k].length - wrapShrink; l++) {\n                if (callback(\n                  coords[j][k][l],\n                  coordIndex,\n                  featureIndex,\n                  multiFeatureIndex,\n                  geometryIndex\n                ) === false)\n                  return false;\n                coordIndex++;\n              }\n              geometryIndex++;\n            }\n            multiFeatureIndex++;\n          }\n          break;\n        case \"GeometryCollection\":\n          for (j = 0; j < geometry.geometries.length; j++)\n            if (coordEach(geometry.geometries[j], callback, excludeWrapCoord) === false)\n              return false;\n          break;\n        default:\n          throw new Error(\"Unknown Geometry Type\");\n      }\n    }\n  }\n}\nfunction coordReduce(geojson, callback, initialValue, excludeWrapCoord) {\n  var previousValue = initialValue;\n  coordEach(\n    geojson,\n    function(currentCoord, coordIndex, featureIndex, multiFeatureIndex, geometryIndex) {\n      if (coordIndex === 0 && initialValue === void 0)\n        previousValue = currentCoord;\n      else\n        previousValue = callback(\n          previousValue,\n          currentCoord,\n          coordIndex,\n          featureIndex,\n          multiFeatureIndex,\n          geometryIndex\n        );\n    },\n    excludeWrapCoord\n  );\n  return previousValue;\n}\nfunction propEach(geojson, callback) {\n  var i;\n  switch (geojson.type) {\n    case \"FeatureCollection\":\n      for (i = 0; i < geojson.features.length; i++) {\n        if (callback(geojson.features[i].properties, i) === false)\n          break;\n      }\n      break;\n    case \"Feature\":\n      callback(geojson.properties, 0);\n      break;\n  }\n}\nfunction propReduce(geojson, callback, initialValue) {\n  var previousValue = initialValue;\n  propEach(geojson, function(currentProperties, featureIndex) {\n    if (featureIndex === 0 && initialValue === void 0)\n      previousValue = currentProperties;\n    else\n      previousValue = callback(previousValue, currentProperties, featureIndex);\n  });\n  return previousValue;\n}\nfunction featureEach(geojson, callback) {\n  if (geojson.type === \"Feature\") {\n    callback(geojson, 0);\n  } else if (geojson.type === \"FeatureCollection\") {\n    for (var i = 0; i < geojson.features.length; i++) {\n      if (callback(geojson.features[i], i) === false)\n        break;\n    }\n  }\n}\nfunction featureReduce(geojson, callback, initialValue) {\n  var previousValue = initialValue;\n  featureEach(geojson, function(currentFeature, featureIndex) {\n    if (featureIndex === 0 && initialValue === void 0)\n      previousValue = currentFeature;\n    else\n      previousValue = callback(previousValue, currentFeature, featureIndex);\n  });\n  return previousValue;\n}\nfunction coordAll(geojson) {\n  var coords = [];\n  coordEach(geojson, function(coord) {\n    coords.push(coord);\n  });\n  return coords;\n}\nfunction geomEach(geojson, callback) {\n  var i, j, g, geometry, stopG, geometryMaybeCollection, isGeometryCollection, featureProperties, featureBBox, featureId, featureIndex = 0, isFeatureCollection = geojson.type === \"FeatureCollection\", isFeature = geojson.type === \"Feature\", stop = isFeatureCollection ? geojson.features.length : 1;\n  for (i = 0; i < stop; i++) {\n    geometryMaybeCollection = isFeatureCollection ? geojson.features[i].geometry : isFeature ? geojson.geometry : geojson;\n    featureProperties = isFeatureCollection ? geojson.features[i].properties : isFeature ? geojson.properties : {};\n    featureBBox = isFeatureCollection ? geojson.features[i].bbox : isFeature ? geojson.bbox : void 0;\n    featureId = isFeatureCollection ? geojson.features[i].id : isFeature ? geojson.id : void 0;\n    isGeometryCollection = geometryMaybeCollection ? geometryMaybeCollection.type === \"GeometryCollection\" : false;\n    stopG = isGeometryCollection ? geometryMaybeCollection.geometries.length : 1;\n    for (g = 0; g < stopG; g++) {\n      geometry = isGeometryCollection ? geometryMaybeCollection.geometries[g] : geometryMaybeCollection;\n      if (geometry === null) {\n        if (callback(\n          null,\n          featureIndex,\n          featureProperties,\n          featureBBox,\n          featureId\n        ) === false)\n          return false;\n        continue;\n      }\n      switch (geometry.type) {\n        case \"Point\":\n        case \"LineString\":\n        case \"MultiPoint\":\n        case \"Polygon\":\n        case \"MultiLineString\":\n        case \"MultiPolygon\": {\n          if (callback(\n            geometry,\n            featureIndex,\n            featureProperties,\n            featureBBox,\n            featureId\n          ) === false)\n            return false;\n          break;\n        }\n        case \"GeometryCollection\": {\n          for (j = 0; j < geometry.geometries.length; j++) {\n            if (callback(\n              geometry.geometries[j],\n              featureIndex,\n              featureProperties,\n              featureBBox,\n              featureId\n            ) === false)\n              return false;\n          }\n          break;\n        }\n        default:\n          throw new Error(\"Unknown Geometry Type\");\n      }\n    }\n    featureIndex++;\n  }\n}\nfunction geomReduce(geojson, callback, initialValue) {\n  var previousValue = initialValue;\n  geomEach(\n    geojson,\n    function(currentGeometry, featureIndex, featureProperties, featureBBox, featureId) {\n      if (featureIndex === 0 && initialValue === void 0)\n        previousValue = currentGeometry;\n      else\n        previousValue = callback(\n          previousValue,\n          currentGeometry,\n          featureIndex,\n          featureProperties,\n          featureBBox,\n          featureId\n        );\n    }\n  );\n  return previousValue;\n}\nfunction flattenEach(geojson, callback) {\n  geomEach(geojson, function(geometry, featureIndex, properties, bbox, id) {\n    var type = geometry === null ? null : geometry.type;\n    switch (type) {\n      case null:\n      case \"Point\":\n      case \"LineString\":\n      case \"Polygon\":\n        if (callback(\n          feature(geometry, properties, { bbox, id }),\n          featureIndex,\n          0\n        ) === false)\n          return false;\n        return;\n    }\n    var geomType;\n    switch (type) {\n      case \"MultiPoint\":\n        geomType = \"Point\";\n        break;\n      case \"MultiLineString\":\n        geomType = \"LineString\";\n        break;\n      case \"MultiPolygon\":\n        geomType = \"Polygon\";\n        break;\n    }\n    for (var multiFeatureIndex = 0; multiFeatureIndex < geometry.coordinates.length; multiFeatureIndex++) {\n      var coordinate = geometry.coordinates[multiFeatureIndex];\n      var geom = {\n        type: geomType,\n        coordinates: coordinate\n      };\n      if (callback(feature(geom, properties), featureIndex, multiFeatureIndex) === false)\n        return false;\n    }\n  });\n}\nfunction flattenReduce(geojson, callback, initialValue) {\n  var previousValue = initialValue;\n  flattenEach(\n    geojson,\n    function(currentFeature, featureIndex, multiFeatureIndex) {\n      if (featureIndex === 0 && multiFeatureIndex === 0 && initialValue === void 0)\n        previousValue = currentFeature;\n      else\n        previousValue = callback(\n          previousValue,\n          currentFeature,\n          featureIndex,\n          multiFeatureIndex\n        );\n    }\n  );\n  return previousValue;\n}\nfunction segmentEach(geojson, callback) {\n  flattenEach(geojson, function(feature2, featureIndex, multiFeatureIndex) {\n    var segmentIndex = 0;\n    if (!feature2.geometry)\n      return;\n    var type = feature2.geometry.type;\n    if (type === \"Point\" || type === \"MultiPoint\")\n      return;\n    var previousCoords;\n    var previousFeatureIndex = 0;\n    var previousMultiIndex = 0;\n    var prevGeomIndex = 0;\n    if (coordEach(\n      feature2,\n      function(currentCoord, coordIndex, featureIndexCoord, multiPartIndexCoord, geometryIndex) {\n        if (previousCoords === void 0 || featureIndex > previousFeatureIndex || multiPartIndexCoord > previousMultiIndex || geometryIndex > prevGeomIndex) {\n          previousCoords = currentCoord;\n          previousFeatureIndex = featureIndex;\n          previousMultiIndex = multiPartIndexCoord;\n          prevGeomIndex = geometryIndex;\n          segmentIndex = 0;\n          return;\n        }\n        var currentSegment = lineString(\n          [previousCoords, currentCoord],\n          feature2.properties\n        );\n        if (callback(\n          currentSegment,\n          featureIndex,\n          multiFeatureIndex,\n          geometryIndex,\n          segmentIndex\n        ) === false)\n          return false;\n        segmentIndex++;\n        previousCoords = currentCoord;\n      }\n    ) === false)\n      return false;\n  });\n}\nfunction segmentReduce(geojson, callback, initialValue) {\n  var previousValue = initialValue;\n  var started = false;\n  segmentEach(\n    geojson,\n    function(currentSegment, featureIndex, multiFeatureIndex, geometryIndex, segmentIndex) {\n      if (started === false && initialValue === void 0)\n        previousValue = currentSegment;\n      else\n        previousValue = callback(\n          previousValue,\n          currentSegment,\n          featureIndex,\n          multiFeatureIndex,\n          geometryIndex,\n          segmentIndex\n        );\n      started = true;\n    }\n  );\n  return previousValue;\n}\nfunction lineEach(geojson, callback) {\n  if (!geojson)\n    throw new Error(\"geojson is required\");\n  flattenEach(geojson, function(feature2, featureIndex, multiFeatureIndex) {\n    if (feature2.geometry === null)\n      return;\n    var type = feature2.geometry.type;\n    var coords = feature2.geometry.coordinates;\n    switch (type) {\n      case \"LineString\":\n        if (callback(feature2, featureIndex, multiFeatureIndex, 0, 0) === false)\n          return false;\n        break;\n      case \"Polygon\":\n        for (var geometryIndex = 0; geometryIndex < coords.length; geometryIndex++) {\n          if (callback(\n            lineString(coords[geometryIndex], feature2.properties),\n            featureIndex,\n            multiFeatureIndex,\n            geometryIndex\n          ) === false)\n            return false;\n        }\n        break;\n    }\n  });\n}\nfunction lineReduce(geojson, callback, initialValue) {\n  var previousValue = initialValue;\n  lineEach(\n    geojson,\n    function(currentLine, featureIndex, multiFeatureIndex, geometryIndex) {\n      if (featureIndex === 0 && initialValue === void 0)\n        previousValue = currentLine;\n      else\n        previousValue = callback(\n          previousValue,\n          currentLine,\n          featureIndex,\n          multiFeatureIndex,\n          geometryIndex\n        );\n    }\n  );\n  return previousValue;\n}\nfunction findSegment(geojson, options) {\n  options = options || {};\n  if (!isObject(options))\n    throw new Error(\"options is invalid\");\n  var featureIndex = options.featureIndex || 0;\n  var multiFeatureIndex = options.multiFeatureIndex || 0;\n  var geometryIndex = options.geometryIndex || 0;\n  var segmentIndex = options.segmentIndex || 0;\n  var properties = options.properties;\n  var geometry;\n  switch (geojson.type) {\n    case \"FeatureCollection\":\n      if (featureIndex < 0)\n        featureIndex = geojson.features.length + featureIndex;\n      properties = properties || geojson.features[featureIndex].properties;\n      geometry = geojson.features[featureIndex].geometry;\n      break;\n    case \"Feature\":\n      properties = properties || geojson.properties;\n      geometry = geojson.geometry;\n      break;\n    case \"Point\":\n    case \"MultiPoint\":\n      return null;\n    case \"LineString\":\n    case \"Polygon\":\n    case \"MultiLineString\":\n    case \"MultiPolygon\":\n      geometry = geojson;\n      break;\n    default:\n      throw new Error(\"geojson is invalid\");\n  }\n  if (geometry === null)\n    return null;\n  var coords = geometry.coordinates;\n  switch (geometry.type) {\n    case \"Point\":\n    case \"MultiPoint\":\n      return null;\n    case \"LineString\":\n      if (segmentIndex < 0)\n        segmentIndex = coords.length + segmentIndex - 1;\n      return lineString(\n        [coords[segmentIndex], coords[segmentIndex + 1]],\n        properties,\n        options\n      );\n    case \"Polygon\":\n      if (geometryIndex < 0)\n        geometryIndex = coords.length + geometryIndex;\n      if (segmentIndex < 0)\n        segmentIndex = coords[geometryIndex].length + segmentIndex - 1;\n      return lineString(\n        [\n          coords[geometryIndex][segmentIndex],\n          coords[geometryIndex][segmentIndex + 1]\n        ],\n        properties,\n        options\n      );\n    case \"MultiLineString\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      if (segmentIndex < 0)\n        segmentIndex = coords[multiFeatureIndex].length + segmentIndex - 1;\n      return lineString(\n        [\n          coords[multiFeatureIndex][segmentIndex],\n          coords[multiFeatureIndex][segmentIndex + 1]\n        ],\n        properties,\n        options\n      );\n    case \"MultiPolygon\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      if (geometryIndex < 0)\n        geometryIndex = coords[multiFeatureIndex].length + geometryIndex;\n      if (segmentIndex < 0)\n        segmentIndex = coords[multiFeatureIndex][geometryIndex].length - segmentIndex - 1;\n      return lineString(\n        [\n          coords[multiFeatureIndex][geometryIndex][segmentIndex],\n          coords[multiFeatureIndex][geometryIndex][segmentIndex + 1]\n        ],\n        properties,\n        options\n      );\n  }\n  throw new Error(\"geojson is invalid\");\n}\nfunction findPoint(geojson, options) {\n  options = options || {};\n  if (!isObject(options))\n    throw new Error(\"options is invalid\");\n  var featureIndex = options.featureIndex || 0;\n  var multiFeatureIndex = options.multiFeatureIndex || 0;\n  var geometryIndex = options.geometryIndex || 0;\n  var coordIndex = options.coordIndex || 0;\n  var properties = options.properties;\n  var geometry;\n  switch (geojson.type) {\n    case \"FeatureCollection\":\n      if (featureIndex < 0)\n        featureIndex = geojson.features.length + featureIndex;\n      properties = properties || geojson.features[featureIndex].properties;\n      geometry = geojson.features[featureIndex].geometry;\n      break;\n    case \"Feature\":\n      properties = properties || geojson.properties;\n      geometry = geojson.geometry;\n      break;\n    case \"Point\":\n    case \"MultiPoint\":\n      return null;\n    case \"LineString\":\n    case \"Polygon\":\n    case \"MultiLineString\":\n    case \"MultiPolygon\":\n      geometry = geojson;\n      break;\n    default:\n      throw new Error(\"geojson is invalid\");\n  }\n  if (geometry === null)\n    return null;\n  var coords = geometry.coordinates;\n  switch (geometry.type) {\n    case \"Point\":\n      return point(coords, properties, options);\n    case \"MultiPoint\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      return point(coords[multiFeatureIndex], properties, options);\n    case \"LineString\":\n      if (coordIndex < 0)\n        coordIndex = coords.length + coordIndex;\n      return point(coords[coordIndex], properties, options);\n    case \"Polygon\":\n      if (geometryIndex < 0)\n        geometryIndex = coords.length + geometryIndex;\n      if (coordIndex < 0)\n        coordIndex = coords[geometryIndex].length + coordIndex;\n      return point(coords[geometryIndex][coordIndex], properties, options);\n    case \"MultiLineString\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      if (coordIndex < 0)\n        coordIndex = coords[multiFeatureIndex].length + coordIndex;\n      return point(coords[multiFeatureIndex][coordIndex], properties, options);\n    case \"MultiPolygon\":\n      if (multiFeatureIndex < 0)\n        multiFeatureIndex = coords.length + multiFeatureIndex;\n      if (geometryIndex < 0)\n        geometryIndex = coords[multiFeatureIndex].length + geometryIndex;\n      if (coordIndex < 0)\n        coordIndex = coords[multiFeatureIndex][geometryIndex].length - coordIndex;\n      return point(\n        coords[multiFeatureIndex][geometryIndex][coordIndex],\n        properties,\n        options\n      );\n  }\n  throw new Error(\"geojson is invalid\");\n}\nexport {\n  coordAll,\n  coordEach,\n  coordReduce,\n  featureEach,\n  featureReduce,\n  findPoint,\n  findSegment,\n  flattenEach,\n  flattenReduce,\n  geomEach,\n  geomReduce,\n  lineEach,\n  lineReduce,\n  propEach,\n  propReduce,\n  segmentEach,\n  segmentReduce\n};\n//# sourceMappingURL=index.js.map","// index.ts\nimport polygonClipping from \"polygon-clipping\";\nimport { multiPolygon, polygon } from \"@turf/helpers\";\nimport { geomEach } from \"@turf/meta\";\nfunction union(features, options = {}) {\n  const geoms = [];\n  geomEach(features, (geom) => {\n    geoms.push(geom.coordinates);\n  });\n  if (geoms.length < 2) {\n    throw new Error(\"Must have at least 2 geometries\");\n  }\n  const unioned = polygonClipping.union(geoms[0], ...geoms.slice(1));\n  if (unioned.length === 0)\n    return null;\n  if (unioned.length === 1)\n    return polygon(unioned[0], options.properties);\n  else\n    return multiPolygon(unioned, options.properties);\n}\nvar turf_union_default = union;\nexport {\n  turf_union_default as default,\n  union\n};\n//# sourceMappingURL=index.js.map","// index.ts\nimport { coordEach } from \"@turf/meta\";\nfunction bbox(geojson, options = {}) {\n  if (geojson.bbox != null && true !== options.recompute) {\n    return geojson.bbox;\n  }\n  const result = [Infinity, Infinity, -Infinity, -Infinity];\n  coordEach(geojson, (coord) => {\n    if (result[0] > coord[0]) {\n      result[0] = coord[0];\n    }\n    if (result[1] > coord[1]) {\n      result[1] = coord[1];\n    }\n    if (result[2] < coord[0]) {\n      result[2] = coord[0];\n    }\n    if (result[3] < coord[1]) {\n      result[3] = coord[1];\n    }\n  });\n  return result;\n}\nvar turf_bbox_default = bbox;\nexport {\n  bbox,\n  turf_bbox_default as default\n};\n//# sourceMappingURL=index.js.map","// index.ts\nimport polygonClipping from \"polygon-clipping\";\nimport { polygon, multiPolygon } from \"@turf/helpers\";\nimport { geomEach } from \"@turf/meta\";\nfunction difference(features) {\n  const geoms = [];\n  geomEach(features, (geom) => {\n    geoms.push(geom.coordinates);\n  });\n  if (geoms.length < 2) {\n    throw new Error(\"Must have at least two features\");\n  }\n  const properties = features.features[0].properties || {};\n  const differenced = polygonClipping.difference(geoms[0], ...geoms.slice(1));\n  if (differenced.length === 0)\n    return null;\n  if (differenced.length === 1)\n    return polygon(differenced[0], properties);\n  return multiPolygon(differenced, properties);\n}\nvar turf_difference_default = difference;\nexport {\n  turf_difference_default as default,\n  difference\n};\n//# sourceMappingURL=index.js.map","// index.ts\nimport { flattenEach } from \"@turf/meta\";\nimport { featureCollection } from \"@turf/helpers\";\nfunction flatten(geojson) {\n  if (!geojson)\n    throw new Error(\"geojson is required\");\n  var results = [];\n  flattenEach(geojson, function(feature) {\n    results.push(feature);\n  });\n  return featureCollection(results);\n}\nvar turf_flatten_default = flatten;\nexport {\n  turf_flatten_default as default,\n  flatten\n};\n//# sourceMappingURL=index.js.map","import bbox from \"@turf/bbox\";\nimport difference from \"@turf/difference\";\nimport flatten from \"@turf/flatten\";\nimport { featureCollection, polygon } from \"@turf/helpers\";\nimport union from \"@turf/union\";\nimport type {\n  Feature,\n  FeatureCollection,\n  MultiPolygon,\n  Polygon,\n} from \"geojson\";\nimport { unwrapBbox } from \"./geoUtils\";\nimport type { BBox } from \"./types\";\n\nexport function setMask(\n  picked: Feature<Polygon | MultiPolygon>,\n  setData: (data?: FeatureCollection<Polygon | MultiPolygon>) => void,\n): void {\n  const diff = difference(\n    featureCollection([\n      polygon([\n        [\n          [180, 90],\n          [-180, 90],\n          [-180, -90],\n          [180, -90],\n          [180, 90],\n        ],\n      ]),\n      picked,\n    ]),\n  );\n\n  if (!diff) {\n    return;\n  }\n\n  diff.properties = { isMask: true };\n\n  const bb = unwrapBbox(bbox(picked) as BBox);\n\n  // bigger features (continents, oceans) have bigger tolerance\n  // because of the used source data simplification\n  const tolerance = (bb[2] - bb[0]) / 360 / 1_000;\n\n  const leaksLeft = bb[0] < -180;\n  const leaksRight = bb[2] > 180;\n\n  const flattened = flatten(picked);\n\n  if (flattened.features.length > 1 && (leaksLeft || leaksRight)) {\n    for (const poly of flattened.features) {\n      const bb = unwrapBbox(bbox(poly) as BBox);\n\n      if (leaksRight && bb[0] < -180 + tolerance) {\n        for (const ring of poly.geometry.coordinates) {\n          for (const position of ring) {\n            position[0] += 360 - tolerance;\n          }\n        }\n      }\n\n      if (leaksLeft && bb[2] > 180 - tolerance) {\n        for (const ring of poly.geometry.coordinates) {\n          for (const position of ring) {\n            position[0] -= 360 - tolerance;\n          }\n        }\n      }\n    }\n  }\n\n  setData(\n    featureCollection([\n      flattened.features.length < 2 ? picked : (union(flattened) ?? picked),\n      diff,\n    ]),\n  );\n}\n","import { feature, featureCollection } from \"@turf/helpers\";\nimport union from \"@turf/union\";\nimport type {\n  GeoJSON,\n  LineString,\n  MultiLineString,\n  MultiPolygon,\n  Polygon,\n} from \"geojson\";\nimport type * as maplibregl from \"maplibre-gl\";\nimport type {\n  FillLayerSpecification,\n  FitBoundsOptions,\n  FlyToOptions,\n  GeoJSONSource,\n  LineLayerSpecification,\n  Map,\n  MapMouseEvent,\n  Marker,\n  MarkerOptions,\n} from \"maplibre-gl\";\nimport MarkerIcon from \"./MarkerIcon.svelte\";\nimport { setMask } from \"./mask\";\nimport type { BBox, Position } from \"./types\";\nimport type { Feature, MapController, MapEvent } from \"./types.js\";\n\nexport type MapLibreGL = Pick<typeof maplibregl, \"Marker\" | \"Popup\">;\n\nexport type FullGeometryStyle = {\n  fill: Pick<FillLayerSpecification, \"layout\" | \"paint\" | \"filter\">;\n  line: Pick<LineLayerSpecification, \"layout\" | \"paint\" | \"filter\">;\n};\n\nconst defaultGeometryStyle: FullGeometryStyle = {\n  fill: {\n    paint: {\n      \"fill-color\": \"#000\",\n      \"fill-opacity\": 0.1,\n    },\n    filter: [\"all\", [\"==\", [\"geometry-type\"], \"Polygon\"], [\"has\", \"isMask\"]],\n  },\n  line: {\n    layout: {\n      \"line-cap\": \"square\",\n    },\n    paint: {\n      \"line-width\": [\"case\", [\"==\", [\"geometry-type\"], \"Polygon\"], 2, 3],\n      \"line-dasharray\": [1, 1],\n      \"line-color\": \"#3170fe\",\n    },\n    filter: [\"!\", [\"has\", \"isMask\"]],\n  },\n};\n\nconst RESULT_SOURCE = \"mtlr-gc-full-geom\";\n\nconst RESULT_LAYER_FILL = \"mtlr-gc-full-geom-fill\";\n\nconst RESULT_LAYER_LINE = \"mtlr-gc-full-geom-line\";\n\nexport function createMapLibreGlMapController(\n  map: Map,\n  maplibregl?: MapLibreGL | undefined,\n  marker:\n    | boolean\n    | null\n    | MarkerOptions\n    | ((map: Map, feature?: Feature) => Marker | undefined | null) = true,\n  showResultMarkers:\n    | boolean\n    | null\n    | MarkerOptions\n    | ((map: Map, feature: Feature) => Marker | undefined | null) = true,\n  flyToOptions: FlyToOptions | null = {},\n  fitBoundsOptions: FitBoundsOptions | null = {},\n  fullGeometryStyle: boolean | null | FullGeometryStyle = defaultGeometryStyle,\n) {\n  let eventHandler: ((e: MapEvent) => void) | undefined;\n\n  const markers: Marker[] = [];\n\n  let selectedMarker: maplibregl.Marker | undefined;\n\n  let reverseMarker: maplibregl.Marker | undefined;\n\n  let savedData: GeoJSON | undefined; // used to restore features on style switch\n\n  function syncFullGeometryLayer() {\n    if (!map.loaded) {\n      map.once(\"load\", syncFullGeometryLayer);\n\n      return;\n    }\n\n    const effFullGeometryStyle = !fullGeometryStyle\n      ? undefined\n      : fullGeometryStyle === true\n        ? defaultGeometryStyle\n        : fullGeometryStyle;\n\n    if (!effFullGeometryStyle?.fill && !effFullGeometryStyle?.line) {\n      return;\n    }\n\n    const source = map.getSource<GeoJSONSource>(RESULT_SOURCE);\n\n    if (source) {\n      source.setData(savedData ?? featureCollection([]));\n    } else if (savedData) {\n      map.addSource(RESULT_SOURCE, {\n        type: \"geojson\",\n        data: savedData,\n      });\n    } else {\n      return;\n    }\n\n    if (!map.getLayer(RESULT_LAYER_FILL) && effFullGeometryStyle?.fill) {\n      map.addLayer({\n        ...effFullGeometryStyle?.fill,\n        id: RESULT_LAYER_FILL,\n        type: \"fill\",\n        source: RESULT_SOURCE,\n      });\n    }\n\n    if (!map.getLayer(RESULT_LAYER_LINE) && effFullGeometryStyle?.line) {\n      map.addLayer({\n        ...effFullGeometryStyle?.line,\n        id: RESULT_LAYER_LINE,\n        type: \"line\",\n        source: RESULT_SOURCE,\n      });\n    }\n  }\n\n  function setAndSaveData(data?: GeoJSON) {\n    savedData = data;\n\n    syncFullGeometryLayer();\n  }\n\n  map.on(\"styledata\", () => {\n    // timeout prevents collision with svelte-maplibre library\n    setTimeout(() => {\n      if (savedData) {\n        syncFullGeometryLayer();\n      }\n    });\n  });\n\n  const handleMapClick = (e: MapMouseEvent) => {\n    eventHandler?.({\n      type: \"mapClick\",\n      coordinates: [e.lngLat.lng, e.lngLat.lat],\n    });\n  };\n\n  function createMarker(interactive = false) {\n    if (!maplibregl) {\n      throw new Error();\n    }\n\n    const element = document.createElement(\"div\");\n\n    if (interactive) {\n      element.classList.add(\"marker-interactive\");\n    }\n\n    new MarkerIcon({\n      props: { displayIn: \"maplibre\" },\n      target: element,\n    });\n\n    return new maplibregl.Marker({ element, offset: [1, -13] });\n  }\n\n  return {\n    setEventHandler(handler: undefined | ((e: MapEvent) => void)): void {\n      if (handler) {\n        eventHandler = handler;\n\n        map.on(\"click\", handleMapClick);\n      } else {\n        eventHandler = undefined;\n\n        map.off(\"click\", handleMapClick);\n      }\n    },\n\n    flyTo(center: Position, zoom?: number): void {\n      map.flyTo({ center, ...(zoom ? { zoom } : {}), ...flyToOptions });\n    },\n\n    fitBounds(bbox: BBox, padding: number, maxZoom?: number): void {\n      map.fitBounds(\n        [\n          [bbox[0], bbox[1]],\n          [bbox[2], bbox[3]],\n        ],\n        { padding, ...(maxZoom ? { maxZoom } : {}), ...fitBoundsOptions },\n      );\n    },\n\n    indicateReverse(reverse: boolean): void {\n      map.getCanvasContainer().style.cursor = reverse ? \"crosshair\" : \"\";\n    },\n\n    setReverseMarker(coordinates?: Position) {\n      if (!maplibregl || !marker) {\n        return;\n      }\n\n      if (reverseMarker) {\n        if (!coordinates) {\n          reverseMarker.remove();\n\n          reverseMarker = undefined;\n        } else {\n          reverseMarker.setLngLat(coordinates);\n        }\n      } else if (coordinates) {\n        if (marker instanceof Function) {\n          reverseMarker = marker(map) ?? undefined;\n        } else {\n          reverseMarker = (\n            typeof marker === \"object\"\n              ? new maplibregl.Marker(marker)\n              : createMarker()\n          )\n            .setLngLat(coordinates)\n            .addTo(map);\n\n          reverseMarker.getElement().classList.add(\"marker-reverse\");\n        }\n      }\n    },\n\n    setFeatures(\n      markedFeatures: Feature[] | undefined,\n      picked: Feature | undefined,\n      showPolygonMarker: boolean,\n    ): void {\n      for (const marker of markers) {\n        marker.remove();\n      }\n\n      markers.length = 0;\n\n      setAndSaveData(undefined);\n\n      if (!maplibregl) {\n        return;\n      }\n\n      if (picked) {\n        let handled = false;\n\n        if (picked.geometry.type === \"GeometryCollection\") {\n          const geoms = picked.geometry.geometries.filter(\n            (geometry): geometry is Polygon | MultiPolygon =>\n              geometry.type === \"Polygon\" || geometry.type === \"MultiPolygon\",\n          );\n\n          ok: if (geoms.length > 0) {\n            const unioned = union(\n              featureCollection(geoms.map((geom) => feature(geom))),\n            );\n\n            if (!unioned) {\n              break ok;\n            }\n\n            setMask(\n              {\n                ...picked,\n                geometry: unioned.geometry,\n              },\n              setAndSaveData,\n            );\n\n            handled = true;\n          } else {\n            const geometries = picked.geometry.geometries.filter(\n              (geometry): geometry is LineString | MultiLineString =>\n                geometry.type === \"LineString\" ||\n                geometry.type === \"MultiLineString\",\n            );\n\n            if (geometries.length > 0) {\n              setAndSaveData({\n                ...picked,\n                geometry: { type: \"GeometryCollection\", geometries },\n              });\n\n              handled = true;\n            }\n          }\n        }\n\n        if (handled) {\n          // nothing\n        } else if (\n          picked.geometry.type === \"Polygon\" ||\n          picked.geometry.type === \"MultiPolygon\"\n        ) {\n          setMask(picked as Feature<Polygon | MultiPolygon>, setAndSaveData);\n        } else if (\n          picked.geometry.type === \"LineString\" ||\n          picked.geometry.type === \"MultiLineString\"\n        ) {\n          setAndSaveData(picked);\n\n          return; // no pin for (multi)linestrings\n        }\n\n        if (!showPolygonMarker && picked.geometry.type !== \"Point\") {\n          return;\n        }\n\n        if (marker instanceof Function) {\n          const m = marker(map, picked);\n\n          if (m) {\n            markers.push(m);\n          }\n        } else if (marker) {\n          markers.push(\n            typeof marker === \"object\"\n              ? new maplibregl.Marker(marker)\n              : createMarker().setLngLat(picked.center).addTo(map),\n          );\n        }\n      }\n\n      if (showResultMarkers) {\n        for (const feature of markedFeatures ?? []) {\n          if (feature === picked) {\n            continue;\n          }\n\n          let marker;\n\n          if (showResultMarkers instanceof Function) {\n            marker = showResultMarkers(map, feature);\n\n            if (!marker) {\n              continue;\n            }\n          } else {\n            marker = (\n              typeof showResultMarkers === \"object\"\n                ? new maplibregl.Marker(showResultMarkers)\n                : createMarker(true)\n            )\n              .setLngLat(feature.center)\n              .setPopup(\n                new maplibregl.Popup({\n                  offset: [1, -27],\n                  closeButton: false,\n                  closeOnMove: true,\n                  className: \"maptiler-gc-popup\",\n                }).setText(\n                  feature.place_type[0] === \"reverse\"\n                    ? feature.place_name\n                    : feature.place_name.replace(/,.*/, \"\"),\n                ),\n              )\n              .addTo(map);\n          }\n\n          const element = marker.getElement();\n\n          element.addEventListener(\"click\", (e) => {\n            e.stopPropagation();\n\n            eventHandler?.({ type: \"markerClick\", id: feature.id });\n          });\n\n          element.addEventListener(\"mouseenter\", () => {\n            eventHandler?.({ type: \"markerMouseEnter\", id: feature.id });\n\n            marker.togglePopup();\n          });\n\n          element.addEventListener(\"mouseleave\", () => {\n            eventHandler?.({ type: \"markerMouseLeave\", id: feature.id });\n\n            marker.togglePopup();\n          });\n\n          // element.classList.toggle(\"marker-fuzzy\", !!feature.matching_text);\n\n          markers.push(marker);\n        }\n      }\n    },\n\n    setSelectedMarker(index: number): void {\n      if (selectedMarker) {\n        selectedMarker.getElement().classList.toggle(\"marker-selected\", false);\n      }\n\n      selectedMarker = index > -1 ? markers[index] : undefined;\n\n      selectedMarker?.getElement().classList.toggle(\"marker-selected\", true);\n    },\n\n    getCenterAndZoom() {\n      const c = map.getCenter();\n\n      return [map.getZoom(), c.lng, c.lat];\n    },\n  } satisfies MapController;\n}\n","import type {\n  Evented,\n  FitBoundsOptions,\n  FlyToOptions,\n  Listener,\n  Map,\n  Marker,\n  MarkerOptions,\n} from \"maplibre-gl\";\nimport type { SvelteComponent } from \"svelte\";\nimport GeocodingControlComponent from \"./GeocodingControl.svelte\";\nimport {\n  createMapLibreGlMapController,\n  type FullGeometryStyle,\n  type MapLibreGL,\n} from \"./maplibregl-controller\";\nimport type {\n  ControlOptions,\n  DispatcherType,\n  DispatcherTypeCC,\n  Feature,\n  FeatureCollection,\n  RedefineType,\n} from \"./types\";\nexport {\n  createMapLibreGlMapController,\n  type MapLibreGL,\n} from \"./maplibregl-controller\";\n\nexport type MapLibreBaseControlOptions = Omit<ControlOptions, \"apiKey\"> & {\n  /**\n   * Marker to be added to the map at the location of the user-selected result using a default set of Marker options.\n   *\n   * - If `true` or `undefined` then a default marker will be used.\n   * - If the value is a [MarkerOptions](https://maplibre.org/maplibre-gl-js/docs/API/type-aliases/MarkerOptions/) then the marker will be constructed using these options.\n   * - If the value is a function then it can return instance of the [Marker](https://maplibre.org/maplibre-gl-js/docs/API/classes/Marker/).\n   *   Function can accept `Feature` as a parameter which is `undefined` for the reverse location marker.\n   * - If `false` or `null` then no marker will be added to the map.\n   *\n   * Requires that `options.maplibregl` also be set.\n   *\n   * Default value is `true`.\n   */\n  marker?:\n    | null\n    | boolean\n    | MarkerOptions\n    | ((map: Map, feature?: Feature) => undefined | null | Marker);\n\n  /**\n   * Marker be added to the map at the location the geocoding results.\n   *\n   * - If `true` or `undefined` then a default marker will be used.\n   * - If the value is a [MarkerOptions](https://maplibre.org/maplibre-gl-js/docs/API/type-aliases/MarkerOptions/) then the marker will be constructed using these options.\n   * - If the value is a function then it can return instance of the [Marker](https://maplibre.org/maplibre-gl-js/docs/API/classes/Marker/).\n   *   In this case the default pop-up won't be added to the marker.\n   *   Function can accept `Feature` as a parameter.\n   * - If `false` or `null` then no marker will be added to the map.\n   *\n   * Requires that `options.maplibregl` also be set.\n   *\n   * Default value is `true`.\n   */\n  showResultMarkers?:\n    | null\n    | boolean\n    | MarkerOptions\n    | ((map: Map, feature: Feature) => undefined | null | Marker);\n\n  /**\n   * Animation to selected feature on the map.\n   *\n   * - If `false` or `null` then animating the map to a selected result is disabled.\n   * - If `true` or `undefined` then animating the map will use the default animation parameters.\n   * - If an [FlyToOptions](https://maplibre.org/maplibre-gl-js/docs/API/type-aliases/FlyToOptions/)\n   *     ` & `[FitBoundsOptions](https://maplibre.org/maplibre-gl-js/docs/API/type-aliases/FitBoundsOptions/)\n   *     then it will be passed as options to the map [flyTo](https://maplibre.org/maplibre-gl-js/docs/API/classes/Map/#flyto)\n   *     or [fitBounds](https://maplibre.org/maplibre-gl-js/docs/API/classes/Map/#fitbounds) method providing control over the animation of the transition.\n   *\n   * Default value is `true`.\n   */\n  flyTo?: null | boolean | (FlyToOptions & FitBoundsOptions);\n\n  /**\n   * Style for full feature geometry GeoJSON.\n   *\n   * - If `false` or `null` then no full geometry is drawn.\n   * - If `true` or `undefined` then default-styled full geometry is drawn.\n   * - If an T then it must represent the style and will be used to style the full geometry.\n   *\n   * Default is the default style.\n   */\n  fullGeometryStyle?: null | boolean | FullGeometryStyle;\n};\n\nexport type Props<T> = T extends SvelteComponent<infer P> ? P : never;\n\ntype RemoveString<T> = T extends string ? never : T;\n\ntype Event$1 = RemoveString<Parameters<Evented[\"fire\"]>[0]>;\n\ntype EventedConstructor = new (\n  ...args: ConstructorParameters<typeof Evented>\n) => Evented;\n\nexport function crateClasses<OPTS extends MapLibreBaseControlOptions>(\n  Evented: EventedConstructor,\n  maplibreGl: MapLibreGL,\n  getExtraProps?: (\n    map: Map,\n    div: HTMLElement,\n  ) => Partial<Props<GeocodingControlComponent>>,\n) {\n  type EventTypes = RedefineType<\n    DispatcherType,\n    {\n      select: SelectEvent;\n      featureslisted: FeaturesListedEvent;\n      featuresmarked: FeaturesMarkedEvent;\n      optionsvisibilitychange: OptionsVisibilityChangeEvent;\n      pick: PickEvent;\n      querychange: QueryChangeEvent;\n      response: ResponseEvent;\n      reversetoggle: ReverseToggleEvent;\n    }\n  >;\n\n  // NOTE We can't use Maplibre `Event` - see https://github.com/maplibre/maplibre-gl-js/issues/5015\n  class Event<TYPE extends string> implements Event$1 {\n    readonly type: TYPE;\n    readonly target: MapLibreBasedGeocodingControl;\n\n    constructor(target: MapLibreBasedGeocodingControl, type: TYPE) {\n      this.type = type;\n      this.target = target;\n    }\n  }\n\n  class SelectEvent extends Event<\"select\"> {\n    feature: Feature | undefined;\n\n    constructor(\n      target: MapLibreBasedGeocodingControl,\n      details: { feature: Feature | undefined },\n    ) {\n      super(target, \"select\");\n\n      Object.assign(this, details);\n    }\n  }\n\n  class FeaturesListedEvent extends Event<\"featureslisted\"> {\n    features: Feature[] | undefined;\n\n    constructor(\n      target: MapLibreBasedGeocodingControl,\n      features: Feature[] | undefined,\n    ) {\n      super(target, \"featureslisted\");\n\n      this.features = features;\n    }\n  }\n\n  class FeaturesMarkedEvent extends Event<\"featuresmarked\"> {\n    features: Feature[] | undefined;\n\n    constructor(\n      target: MapLibreBasedGeocodingControl,\n      features: Feature[] | undefined,\n    ) {\n      super(target, \"featuresmarked\");\n\n      this.features = features;\n    }\n  }\n\n  class OptionsVisibilityChangeEvent extends Event<\"optionsvisibilitychange\"> {\n    optionsVisible: boolean;\n\n    constructor(\n      target: MapLibreBasedGeocodingControl,\n      optionsVisible: boolean,\n    ) {\n      super(target, \"optionsvisibilitychange\");\n\n      this.optionsVisible = optionsVisible;\n    }\n  }\n\n  class PickEvent extends Event<\"pick\"> {\n    feature: Feature | undefined;\n\n    constructor(\n      target: MapLibreBasedGeocodingControl,\n      feature: Feature | undefined,\n    ) {\n      super(target, \"pick\");\n\n      this.feature = feature;\n    }\n  }\n\n  class QueryChangeEvent extends Event<\"querychange\"> {\n    query: string;\n\n    constructor(target: MapLibreBasedGeocodingControl, query: string) {\n      super(target, \"querychange\");\n\n      this.query = query;\n    }\n  }\n\n  class ResponseEvent extends Event<\"response\"> {\n    url: string;\n\n    featureCollection: FeatureCollection;\n\n    constructor(\n      target: MapLibreBasedGeocodingControl,\n      url: string,\n      featureCollection: FeatureCollection,\n    ) {\n      super(target, \"response\");\n\n      this.url = url;\n\n      this.featureCollection = featureCollection;\n    }\n  }\n\n  class ReverseToggleEvent extends Event<\"reversetoggle\"> {\n    reverse: boolean;\n\n    constructor(target: MapLibreBasedGeocodingControl, reverse: boolean) {\n      super(target, \"reversetoggle\");\n\n      this.reverse = reverse;\n    }\n  }\n\n  class MapLibreBasedGeocodingControl extends Evented {\n    #gc?: GeocodingControlComponent;\n\n    #options: OPTS;\n\n    constructor(options: OPTS = {} as OPTS) {\n      super();\n\n      this.#options = options;\n    }\n\n    onAddInt(map: Map): HTMLElement {\n      const div = document.createElement(\"div\");\n\n      div.className =\n        \"mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl mapboxgl-ctrl-group\";\n\n      const {\n        marker,\n        showResultMarkers,\n        flyTo,\n        fullGeometryStyle,\n        ...restOptions\n      } = this.#options;\n\n      const flyToOptions = typeof flyTo === \"boolean\" ? {} : flyTo;\n\n      const mapController = createMapLibreGlMapController(\n        map,\n        maplibreGl,\n        marker,\n        showResultMarkers,\n        flyToOptions,\n        flyToOptions,\n        fullGeometryStyle,\n      );\n\n      const props = {\n        mapController,\n        flyTo: flyTo === undefined ? true : !!flyTo,\n        apiKey: \"\", // just to satisfy apiKey; TODO find a better solution\n        ...getExtraProps?.(map, div),\n        ...restOptions,\n      };\n\n      if (!props.apiKey) {\n        throw new Error(\"no apiKey provided\");\n      }\n\n      this.#gc = new GeocodingControlComponent({ target: div, props });\n\n      this.#gc.$on(\"select\", (event) => {\n        this.fire(new SelectEvent(this, event.detail));\n      });\n\n      this.#gc.$on(\"pick\", (event) => {\n        this.fire(new PickEvent(this, event.detail.feature));\n      });\n\n      this.#gc.$on(\"featureslisted\", (event) => {\n        this.fire(new FeaturesListedEvent(this, event.detail.features));\n      });\n\n      this.#gc.$on(\"featuresmarked\", (event) => {\n        this.fire(new FeaturesMarkedEvent(this, event.detail.features));\n      });\n\n      this.#gc.$on(\"response\", (event) => {\n        this.fire(\n          new ResponseEvent(\n            this,\n            event.detail.url,\n            event.detail.featureCollection,\n          ),\n        );\n      });\n\n      this.#gc.$on(\"optionsvisibilitychange\", (event) => {\n        this.fire(\n          new OptionsVisibilityChangeEvent(this, event.detail.optionsVisible),\n        );\n      });\n\n      this.#gc.$on(\"reversetoggle\", (event) => {\n        this.fire(new ReverseToggleEvent(this, event.detail.reverse));\n      });\n\n      this.#gc.$on(\"querychange\", (event) => {\n        this.fire(new QueryChangeEvent(this, event.detail.query));\n      });\n\n      return div;\n    }\n\n    on<T extends keyof EventTypes>(\n      type: T,\n      listener: (ev: EventTypes[T]) => void,\n    ): this;\n\n    on(type: keyof EventTypes, listener: Listener): this {\n      return super.on(type, listener);\n    }\n\n    once<T extends keyof EventTypes>(\n      type: T,\n      listener: (ev: EventTypes[T]) => void,\n    ): this;\n\n    once(type: keyof EventTypes, listener: Listener): this | Promise<unknown> {\n      return super.once(type, listener);\n    }\n\n    off<T extends keyof EventTypes>(\n      type: T,\n      listener: (ev: EventTypes[T]) => void,\n    ): this;\n\n    off(type: keyof EventTypes, listener: Listener): this {\n      return super.off(type, listener);\n    }\n\n    listens(type: keyof EventTypes): boolean;\n\n    listens(type: keyof EventTypes): boolean {\n      return super.listens(type);\n    }\n\n    setOptions(options: OPTS) {\n      Object.assign(this.#options, options);\n\n      const {\n        marker,\n        showResultMarkers,\n        flyTo,\n        fullGeometryStyle,\n        ...restOptions\n      } = this.#options;\n\n      this.#gc?.$set(restOptions);\n    }\n\n    setQuery(value: string, submit = true) {\n      this.#gc?.setQuery(value, submit);\n    }\n\n    clearMap() {\n      this.#gc?.clearMap();\n    }\n\n    clearList() {\n      this.#gc?.clearList();\n    }\n\n    setReverseMode(value: boolean) {\n      this.#gc?.$set({ reverseActive: value });\n    }\n\n    focus() {\n      this.#gc?.focus();\n    }\n\n    blur() {\n      this.#gc?.blur();\n    }\n\n    onRemove() {\n      this.#gc?.$destroy();\n    }\n  }\n\n  const events = {\n    SelectEvent,\n    FeaturesListedEvent,\n    FeaturesMarkedEvent,\n    OptionsVisibilityChangeEvent,\n    PickEvent,\n    QueryChangeEvent,\n    ResponseEvent,\n    ReverseToggleEvent,\n  } satisfies {\n    [T in keyof DispatcherTypeCC as `${Capitalize<T>}Event`]: unknown;\n  };\n\n  return {\n    MapLibreBasedGeocodingControl,\n\n    events,\n  };\n}\n","import type { Map } from \"maplibre-gl\";\nimport * as maplibregl from \"maplibre-gl\";\nimport {\n  crateClasses,\n  type MapLibreBaseControlOptions,\n} from \"./MapLibreBasedGeocodingControl\";\nexport { createMapLibreGlMapController } from \"./maplibregl-controller\";\n\ntype Options = MapLibreBaseControlOptions & {\n  /**\n   * Maptiler API key. Optional if used with MapTiler SDK.\n   */\n  apiKey: string;\n};\n\nconst { MapLibreBasedGeocodingControl, events } = crateClasses<Options>(\n  maplibregl.Evented,\n  maplibregl,\n);\n\nexport class GeocodingControl\n  extends MapLibreBasedGeocodingControl\n  implements maplibregl.IControl\n{\n  onAdd(map: Map): HTMLElement {\n    return super.onAddInt(map);\n  }\n}\n\nexport const SelectEvent = events.SelectEvent;\n\nexport const FeaturesListedEvent = events.FeaturesListedEvent;\n\nexport const FeaturesMarkedEvent = events.FeaturesMarkedEvent;\n\nexport const OptionsVisibilityChangeEvent = events.OptionsVisibilityChangeEvent;\n\nexport const PickEvent = events.PickEvent;\n\nexport const QueryChangeEvent = events.QueryChangeEvent;\n\nexport const ResponseEvent = events.ResponseEvent;\n\nexport const ReverseToggleEvent = events.ReverseToggleEvent;\n"],"names":["noop","assign","tar","src","k","run","fn","blank_object","run_all","fns","is_function","thing","safe_not_equal","a","b","src_url_equal_anchor","src_url_equal","element_src","url","is_empty","obj","create_slot","definition","ctx","$$scope","slot_ctx","get_slot_context","get_slot_changes","dirty","lets","merged","len","i","update_slot_base","slot","slot_definition","slot_changes","get_slot_context_fn","slot_context","get_all_dirty_from_scope","length","null_to_empty","value","append","target","node","insert","anchor","detach","element","name","svg_element","text","data","space","empty","listen","event","handler","options","prevent_default","attr","attribute","children","set_data","set_input_value","input","toggle_class","toggle","custom_event","type","detail","bubbles","cancelable","current_component","set_current_component","component","get_current_component","onDestroy","createEventDispatcher","callbacks","bubble","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","update_scheduled","schedule_update","flush","add_render_callback","seen_callbacks","flushidx","saved_component","update","callback","$$","flush_render_callbacks","filtered","targets","c","outroing","outros","group_outros","check_outros","transition_in","block","local","transition_out","ensure_array_like","array_like_or_iterator","outro_and_destroy_block","lookup","update_keyed_each","old_blocks","get_key","dynamic","list","destroy","create_each_block","next","get_context","o","n","old_indexes","new_blocks","new_lookup","deltas","updates","child_ctx","key","will_move","did_move","new_block","old_block","new_key","old_key","create_component","mount_component","fragment","after_update","new_on_destroy","destroy_component","detaching","make_dirty","init","instance","create_fragment","not_equal","props","append_styles","parent_component","ready","ret","rest","nodes","SvelteComponent","__publicField","index","PUBLIC_VERSION","svg","path","img","img_src_value","span","create_if_block_1","create_if_block_2","show_if_1","show_if_2","show_if_3","show_if_4","create_if_block_7","li","span3","span1","span0","span2","t1","t1_value","t4","t4_value","feature","$$props","selected","showPlaceType","missingIconsCache","iconsBaseUrl","categories","_a","category","imageUrl","loadIconAttempt","isReverse","handleImgError","$$invalidate","placeType","_b","_d","_c","div","svg_width_value","displayIn","circle","wrapNum","x","range","includeMax","max","min","d","unwrapBbox","bbox0","bbox","cachedLocation","getProximity","mapController","proximity","ac","centerAndZoom","rule","cg","coords","resolve","reject","pos","err","dm_invalid","dm_numbers","dd_re","dms_periods","dms_abbr","coords_other","toCoordinateFormat","format","parts","decimalLatitude","decimalLongitude","absoluteLatitude","absoluteLongitude","latDir","longDir","result","degreesLatitude","degreesLongitude","minutesLatitudeNotTruncated","minutesLongitudeNotTruncated","dmMinsLatitude","round","dmMinsLongitude","latMinutes","longMinutes","latSeconds","longSeconds","latMinutesString","longMinutesString","num","places","converter","coordsString","decimalPlaces","ddLat","ddLng","latdir","lngdir","originalFormat","match","matchSuccess","checkMatch","patt","verbatimCoordinates","verbatimLat","verbatimLng","sepChars","seps","middle","splitIndex","currSepIndex","startSearchIndex","splitLat","splitLon","coordsCloseEnough","filteredMatch","numerictest","stringtest","halflen","leftside","rightside","bothAreNumbers","bothAreStrings","valuesAreEqual","decimalsCloseEnough","dec1","dec2","originaldiff","coordsToTest","to","coordsParserFormats","coordsParserDecimals","coordsRegexFormats","otherFormats","getAllTestFormats","arr1","item","testFormats","convert","button","ul","div1","div0","featureitem_changes","create_if_block_5","if_block2","create_if_block_4","form","button0","input_1","button1","ZOOM_DEFAULTS","className","apiKey","clearButtonTitle","clearOnBlur","collapsed","country","debounceSearch","enableReverse","errorMessage","filter","flyTo","fuzzyMatch","language","limit","minLength","noResultsMessage","placeholder","reverseActive","reverseButtonTitle","searchValue","pickedResultStyle","showResultsWhileTyping","selectFirst","flyToSelected","markerOnSelected","types","exhaustiveReverseGeocoding","excludeTypes","zoom","apiUrl","fetchParameters","adjustUrlQuery","focus","blur","setQuery","submit","reverse","selectedItemIndex","handleOnSubmit","handleInput","clearList","listFeatures","picked","clearMap","markedFeatures","focused","lastSearchUrl","error","cachedFeatures","abortController","searchTimeoutRef","focusedDelayed","prevIdToFly","dispatch","zoomTo","isQueryReverse","search","zoomToResults","byId","exact","sp","res","featureCollection","e","fuzzyOnly","allZoom","featZoom","computeZoom","handleReverse","coordinates","handleKeyDown","dir","debounce","sv","pick","click_handler","$$value","focus_handler","blur_handler","click_handler_2","click_handler_3","mouseenter_handler","focus_handler_1","showPolygonMarker","geom","properties","feat","polygon","ring","j","features","fc","multiPolygon","__generator","thisArg","body","_","t","f","y","g","verb","v","step","op","Node","DEFAULT_COMPARE","splay","comparator","N","l","r","cmp","split","left","right","merge","printRow","root","prefix","isTail","out","printNode","indent","Tree","current","compare","visitor","Q","done","low","high","keys","values","successor","predecessor","toList","presort","size","sort","loadRecursive","mergedList","mergeLists","createList","sortedListToBST","newKey","newData","start","end","head","p","l1","l2","p1","p2","pivot","tmp","epsilon","splitter","resulterrbound","sum","elen","flen","h","Qnew","hh","bvirt","enow","fnow","eindex","findex","hindex","estimate","vec","ccwerrboundA","ccwerrboundB","ccwerrboundC","B","C1","C2","D","u","orient2dadapt","ax","ay","bx","by","cx","cy","detsum","acxtail","acytail","bcxtail","bcytail","ahi","alo","bhi","blo","_i","_j","_0","s1","s0","t0","u3","acx","bcx","acy","bcy","det","errbound","C1len","C2len","Dlen","orient2d","detleft","detright","isInBbox","point","getBboxOverlap","b1","b2","lowerX","upperX","lowerY","upperY","EPSILON_SQ","ab","PtRounder","CoordRounder","SplayTree","coord","prevNode","nextNode","rounder","crossProduct","dotProduct","compareVectorAngles","basePt","endPt1","endPt2","sineOfAngle","pShared","pBase","pAngle","vBase","vAngle","cosineOfAngle","horizontalIntersection","pt","verticalIntersection","intersection$1","pt1","v1","pt2","v2","kross","ve","d1","d2","x1","x2","y1","y2","SweepEvent","ptCmp","Segment","aPt","bPt","isLeft","other","otherEvents","iMax","evt","numEvents","evt1","evt2","events","baseEvent","cache","fillCache","linkedEvent","nextEvent","asine","acosine","bsine","bcosine","segmentId","alx","blx","arx","brx","aly","bly","ary","bry","aCmpBLeft","bCmpARight","bCmpALeft","aCmpBRight","leftSE","rightSE","rings","windings","leftPt","rightPt","winding","cmpPts","newRightSE","lPt","rPt","yDist","xFromYDist","xDist","yFromXDist","tBbox","oBbox","bboxOverlap","tlp","trp","olp","orp","touchesOtherLSE","touchesThisLSE","touchesOtherRSE","touchesThisRSE","newEvents","alreadyLinked","newLeftSE","oldRightSE","newSeg","tmpEvt","consumer","consumee","seg","beforeState","ringsAfter","windingsAfter","mpsAfter","polysAfter","polysExclude","poly","mp","mpsBefore","operation","noBefores","noAfters","least","most","diff","isJustSubject","mps","RingIn","geomRing","isExterior","firstPoint","prevPoint","sweepEvents","segment","PolyIn","geomPoly","multiPoly","ringSweepEvents","jMax","MultiPolyIn","isSubject","polySweepEvents","RingOut","allSegments","ringsOut","prevEvent","startingPoint","intersectionLEs","availableLEs","firstPt","lastPt","indexLE","intersectionLE","ringEvents","prevPt","points","nextPt","iStart","iEnd","orderedPoints","enclosing","leftMostEvt","prevSeg","prevPrevSeg","PolyOut","exteriorRing","ringGeom","MultiPolyOut","polyGeom","polys","enclosingRing","SweepLine","queue","nextSeg","prevMySplitter","prevInter","newEventsFromSplit","nextMySplitter","nextInter","mySplitter","inter","POLYGON_CLIPPING_MAX_QUEUE_SIZE","POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS","Operation","moreGeoms","multipolys","subject","mpA","sweepLine","prevQueueSize","_len","_key","_len2","_key2","_len3","_key3","subjectGeom","_len4","clippingGeoms","_key4","coordEach","geojson","excludeWrapCoord","geometry","stopG","geometryMaybeCollection","wrapShrink","coordIndex","isGeometryCollection","isFeatureCollection","isFeature","stop","featureIndex","geomIndex","multiFeatureIndex","geometryIndex","geomType","geomEach","featureProperties","featureBBox","featureId","flattenEach","id","coordinate","union","geoms","unioned","polygonClipping","turf_union_default","turf_bbox_default","difference","differenced","turf_difference_default","flatten","results","turf_flatten_default","setMask","setData","bb","tolerance","leaksLeft","leaksRight","flattened","position","defaultGeometryStyle","RESULT_SOURCE","RESULT_LAYER_FILL","RESULT_LAYER_LINE","createMapLibreGlMapController","map","maplibregl","marker","showResultMarkers","flyToOptions","fitBoundsOptions","fullGeometryStyle","eventHandler","markers","selectedMarker","reverseMarker","savedData","syncFullGeometryLayer","effFullGeometryStyle","source","setAndSaveData","handleMapClick","createMarker","interactive","MarkerIcon","center","padding","maxZoom","handled","ok","geometries","m","crateClasses","Evented","maplibreGl","getExtraProps","Event","SelectEvent","details","FeaturesListedEvent","FeaturesMarkedEvent","OptionsVisibilityChangeEvent","optionsVisible","PickEvent","QueryChangeEvent","query","ResponseEvent","ReverseToggleEvent","MapLibreBasedGeocodingControl","__privateAdd","_gc","_options","__privateSet","restOptions","__privateGet","GeocodingControlComponent","listener","GeocodingControl"],"mappings":"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GCzYf,MAAMC,GAAsB,CACxB,CACI,oBAAqB,kBACrB,iBAAkB,SAClB,kBAAmB,SACtB,EACD,CACI,oBAAqB,sBACrB,iBAAkB,YAClB,kBAAmB,WACtB,EACD,CACI,oBAAqB,sBACrB,iBAAkB,YAClB,kBAAmB,WACtB,EACD,CACI,oBAAqB,gCACrB,iBAAkB,iBAClB,kBAAmB,gBACtB,EACD,CACI,oBAAqB,yBACrB,iBAAkB,YAClB,kBAAmB,YACtB,EACD,CACI,oBAAqB,6BACrB,iBAAkB,eAClB,kBAAmB,cACtB,EACD,CACI,oBAAqB,2BACrB,iBAAkB,cAClB,kBAAmB,aACtB,EACD,CACI,oBAAqB,2BACrB,iBAAkB,cAClB,kBAAmB,aACtB,EACD,CACI,oBAAqB,wBACrB,iBAAkB,YAClB,kBAAmB,YACtB,EACD,CACI,oBAAqB,iBACrB,iBAAkB,SAClB,kBAAmB,SACtB,EACD,CACI,oBAAqB,mBACrB,iBAAkB,UAClB,kBAAmB,UACtB,EACD,CACI,oBAAqB,iBACrB,iBAAkB,UAClB,kBAAmB,SACtB,EACD,CACI,oBAAqB,mBACrB,iBAAkB,WAClB,kBAAmB,UACtB,EACD,CACI,oBAAqB,2BACrB,iBAAkB,cAClB,kBAAmB,aACtB,EACD,CACI,oBAAqB,qBACrB,iBAAkB,YAClB,kBAAmB,WACtB,EACD,CACI,oBAAqB,sBACrB,iBAAkB,YAClB,kBAAmB,WACtB,EACD,CACI,oBAAqB,wBACrB,iBAAkB,aAClB,kBAAmB,YACtB,EACD,CACI,oBAAqB,oBACrB,iBAAkB,WAClB,kBAAmB,WACnB,gBAAiB,cACjB,iBAAkB,cACrB,EACD,CACI,oBAAqB,sBACrB,iBAAkB,YAClB,kBAAmB,YACnB,gBAAiB,cACjB,iBAAkB,kBACrB,EACD,CACI,oBAAqB,sBACrB,iBAAkB,YAClB,kBAAmB,YACnB,gBAAiB,eACjB,iBAAkB,iBACrB,EACD,CACI,oBAAqB,qBACrB,iBAAkB,WAClB,kBAAmB,YACnB,gBAAiB,cACjB,iBAAkB,aACrB,EACD,CACI,oBAAqB,4BACrB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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,18,19,20,21,22,24,25,26,27,28,29,30,31,32,33]}