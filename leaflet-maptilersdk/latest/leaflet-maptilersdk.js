(function(n,p){typeof exports=="object"&&typeof module<"u"?p(exports,require("@maptiler/sdk"),require("leaflet")):typeof define=="function"&&define.amd?define(["exports","@maptiler/sdk","leaflet"],p):(n=typeof globalThis<"u"?globalThis:n||self,p(n.leafletmaptilersdk={},n.maptilersdk,n.L))})(this,function(n,p,e){"use strict";function c(t){const i=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const a in t)if(a!=="default"){const o=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(i,a,o.get?o:{enumerable:!0,get:()=>t[a]})}}return i.default=t,Object.freeze(i)}const r=c(p);n.MaptilerLayer=null,n.maptilerLayer=null,n.MaptilerStyle=null,n.maptilerStyle=null,n.MaptilerLanguage=null,n.maptilerLanguage=null;function h(){e.MaptilerLayer=e.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},map:null,initialize:function(t){e.setOptions(this,t),this._throttledUpdate=e.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(t){this._container||this._initContainer();const i=document.createElement("a");i.href="https://www.maptiler.com",i.style="position:absolute; left:10px; bottom:2px; z-index:999;";const a=document.createElement("img");a.src="https://api.maptiler.com/resources/logo.svg",a.alt="MapTiler logo",a.width="100",a.height="30",i.appendChild(a),t.getContainer().appendChild(i);const o=this.getPaneName();t.getPane(o).appendChild(this._container),this._initMaptilerSDK(),this._offset=this._map.containerPointToLayerPoint([0,0]),t.options.zoomAnimation&&e.DomEvent.on(t._proxy,e.DomUtil.TRANSITION_END,this._transitionEnd,this),t.attributionControl.addAttribution('<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>')},onRemove:function(t){this._map._proxy&&this._map.options.zoomAnimation&&e.DomEvent.off(this._map._proxy,e.DomUtil.TRANSITION_END,this._transitionEnd,this);const i=this.getPaneName();t.getPane(i).removeChild(this._container),this._maptilerMap.remove(),this._maptilerMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaptilerSDKMap:function(){return this._maptilerMap},getCanvas:function(){return this._maptilerMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){const t=this.getSize().multiplyBy(.5),i=this._map.latLngToContainerPoint(this._map.getCenter());return e.latLngBounds(this._map.containerPointToLatLng(i.subtract(t)),this._map.containerPointToLatLng(i.add(t)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},setStyle:function(t){this._maptilerMap.setStyle(t)},setLanguage:function(t){this._maptilerMap.setLanguage(t)},_roundPoint:function(t){return{x:Math.round(t.x),y:Math.round(t.y)}},_initContainer:function(){const t=this._container=e.DomUtil.create("div","leaflet-gl-layer"),i=this.getSize(),a=this._map.getSize().multiplyBy(this.options.padding);t.style.width=i.x+"px",t.style.height=i.y+"px";const o=this._map.containerPointToLayerPoint([0,0]).subtract(a);e.DomUtil.setPosition(t,this._roundPoint(o))},_initMaptilerSDK:function(){const t=this._map.getCenter();let i=this.options.style,a=this.options.apiKey;if((typeof this.options.style=="string"||this.options.style instanceof String)&&this.options.style.startsWith("https://api.maptiler.com/maps/"))try{const s=new URL(this.options.style),m=s.searchParams.get("key");m&&(a=m,s.searchParams.delete("key"),i=s.href)}catch(s){console.error(s)}const o={...this.options,style:i,apiKey:a,container:this._container,center:[t.lng,t.lat],zoom:this._map.getZoom()-1,attributionControl:!1};this.options.geolocate&&(delete o.center,delete o.zoom),this._maptilerMap=new r.Map(o),this._maptilerMap.once("load",()=>{this.fire("ready")}),this._maptilerMap.transform.freezeElevation=!0,this.options.geolocate&&this._maptilerMap.on("load",()=>{this._map.setView(this._maptilerMap.getCenter(),this._maptilerMap.getZoom()+1)}),this._maptilerMap.transform.latRange=null,this._maptilerMap.transform.maxValidLatitude=1/0,this._transformGL(),this._maptilerMap._actualCanvas=this._maptilerMap._canvas;const l=this._maptilerMap._actualCanvas;e.DomUtil.addClass(l,"leaflet-image-layer"),e.DomUtil.addClass(l,"leaflet-zoom-animated"),this.options.interactive&&e.DomUtil.addClass(l,"leaflet-interactive"),this.options.className&&e.DomUtil.addClass(l,this.options.className),Object.keys(r.helpers).forEach(s=>{this[s]=m=>r.helpers[s].apply(null,[this._maptilerMap,m])})},_update:function(){if(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming)return;const t=this.getSize(),i=this._map.getSize().multiplyBy(this.options.padding),a=this._map.containerPointToLayerPoint([0,0]).subtract(i);e.DomUtil.setPosition(this._container,this._roundPoint(a)),this._transformGL(),this._maptilerMap.transform.width!==t.x||this._maptilerMap.transform.height!==t.y?(this._container.style.width=t.x+"px",this._container.style.height=t.y+"px",this._maptilerMap._resize!==null&&this._maptilerMap._resize!==void 0?this._maptilerMap._resize():this._maptilerMap.resize()):this._maptilerMap._update!==null&&this._maptilerMap._update!==void 0?this._maptilerMap._update():this._maptilerMap.update()},_transformGL:function(){const t=this._map.getCenter(),i=this._maptilerMap.transform;i.center=r.LngLat.convert([t.lng,t.lat]),i.zoom=this._map.getZoom()-1},_pinchZoom:function(){this._maptilerMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(t){const i=this._map.getZoomScale(t.zoom),a=this._map.getSize().multiplyBy(this.options.padding*i),o=this.getSize()._divideBy(2),l=this._map.project(t.center,t.zoom)._subtract(o)._add(this._map._getMapPanePos().add(a))._round(),s=this._map.project(this._map.getBounds().getNorthWest(),t.zoom)._subtract(l);e.DomUtil.setTransform(this._maptilerMap._actualCanvas,s.subtract(this._offset),i)},_zoomStart:function(){this._zooming=!0},_zoomEnd:function(){const t=this._map.getZoomScale(this._map.getZoom());e.DomUtil.setTransform(this._maptilerMap._actualCanvas,null,t),this._zooming=!1,this._update()},_transitionEnd:function(){e.Util.requestAnimFrame(function(){const t=this._map.getZoom(),i=this._map.getCenter(),a=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());e.DomUtil.setTransform(this._maptilerMap._actualCanvas,a,1),this._maptilerMap.once("moveend",e.Util.bind(function(){this._zoomEnd()},this)),this._maptilerMap.jumpTo({center:i,zoom:t-1})},this)},_resize:function(t){this._transitionEnd(t)}}),n.MaptilerLayer=e.MaptilerLayer,e.maptilerLayer=function(t){return new e.MaptilerLayer(t)},n.maptilerLayer=e.maptilerLayer,e.MaptilerStyle={},Object.keys(r.MapStyle).forEach(t=>{e.MaptilerStyle[t]=r.MapStyle[t]}),n.MaptilerStyle=e.MaptilerStyle,n.maptilerStyle=e.MaptilerStyle,e.maptilerStyle=e.MaptilerStyle,e.MaptilerLanguage={},Object.keys(r.Language).forEach(t=>{e.MaptilerLanguage[t]=r.Language[t]}),n.MaptilerLanguage=e.MaptilerLanguage,n.maptilerLanguage=e.MaptilerLanguage,e.maptilerLanguage=e.MaptilerLanguage}(()=>{try{h()}catch(t){console.error(t)}})(),n.init=h,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});
